/**
 * almond 0.2.6 Copyright (c) 2011-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

/**
 * @license RequireJS text 2.0.10 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

//     Underscore.js 1.6.0
//     http://underscorejs.org
//     (c) 2009-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Underscore may be freely distributed under the MIT license.

/* Zepto v1.1.2-15-g59d3fe5 - zepto deferred callbacks ajax event - zeptojs.com/license */

//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
//     Backbone may be freely distributed under the MIT license.
//     For all details and documentation:
//     http://backbonejs.org

/*! Raven.js 1.1.16 (463f68f) | github.com/getsentry/raven-js */

/*
 * Includes TraceKit
 * https://github.com/getsentry/TraceKit
 *
 * Copyright 2014 Matt Robenolt and other contributors
 * Released under the BSD license
 * https://github.com/getsentry/raven-js/blob/master/LICENSE
 *
 */

/*
 TraceKit - Cross brower stack traces - github.com/occ/TraceKit
 MIT license
*/

//! moment.js
//! version : 2.4.0
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com

/*
 Copyright 2011 Abdulla Abdurakhmanov
 Original sources are available at https://code.google.com/p/x2js/

 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
 */

/*
 *  jssha256 version 0.1  -  Copyright 2006 B. Poettering
 *
 *  This program is free software; you can redistribute it and/or
 *  modify it under the terms of the GNU General Public License as
 *  published by the Free Software Foundation; either version 2 of the
 *  License, or (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 *  General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program; if not, write to the Free Software
 *  Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
 *  02111-1307 USA
 */

/*
 * RequireJS underscore-tpl
 * Loads and precompile underscore templates
 * https://github.com/dciccale/requirejs-underscore-tpl
 *
 * Dependencies:
 * Underscore.js: https://underscorejs.org
 * RequireJS text plugin: https://github.com/requirejs/text
 *
 * Copyright (c) 2013 Denis Ciccale (@tdecs)
 * Licensed under the MIT license.
 * https://github.com/dciccale/requirejs-underscore-tpl/blob/master/LICENSE-MIT
 */

// Copyright 2013 Google Inc. All Rights Reserved.

/**
 * @fileoverview Manages the DRM license requests.
 */

// perform a single license call. This may be important if the server

// is tracking license requests, for example.

/*!

 handlebars v1.1.2

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

function X2JS(e,t,i){function n(e){var t=e.localName;return null==t&&(t=e.baseName),(null==t||""==t)&&(t=e.nodeName),t}function r(s){var a,l,u;if(s.nodeType==o.DOCUMENT_NODE){var c,d;for(l=s.firstChild,c=0,d=s.childNodes.length;d>c;c+=1)if(s.childNodes[c].nodeType!==o.COMMENT_NODE){l=s.childNodes[c];break}return i?a=r(l):(a={},u=n(l),a[u]=r(l)),a}if(s.nodeType==o.ELEMENT_NODE){var h=0,p=s.childNodes;a=new Object;for(var f=0;f<p.length;f++)if(l=p.item(f),u=n(l),h++,null==a[u])a[u]=r(l);else{if(null!=a[u]&&!(a[u]instanceof Array)){var m=a[u];
a[u]=[],a[u].push(m)}for(var g=0;null!=a[u][g];)g++;a[u][g]=r(l)}for(var v=0;v<s.attributes.length;v++){var y=s.attributes.item(v);h++;for(var b=y.value,x=0,w=e.length;w>x;x++){var S=e[x];S.test.call(this,y.value)&&(b=S.converter.call(this,y.value))}a[t+y.name]=b}if(null!=a["#text"]){var _=a["#text"];"string"==typeof _?(_=_.replace(/[\r\n]/g,""),a["#text"]=_,1==h&&(a=_)):delete a["#text"]}return a}return s.nodeType==o.TEXT_NODE||s.nodeType==o.CDATA_SECTION_NODE?s.nodeValue:s.nodeType==o.COMMENT_NODE?null:void 0
}(null===t||void 0===t)&&(t="_"),(null===i||void 0===i)&&(i=!1);var s="1.0.11",a=!1,o={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(e){var t;if(window.DOMParser){var i=new window.DOMParser;t=i.parseFromString(e,"text/xml")}else 0==e.indexOf("<?")&&(e=e.substr(e.indexOf("?>")+2)),t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e);return t},this.xml2json=function(e){return r(e)},this.xml_str2json=function(e){var t=this.parseXmlString(e);
return this.xml2json(t)},this.getVersion=function(){return s},this.escapeMode=function(e){a=e}}function string_to_array(e){for(var t=e.length,i=new Array(t),n=0;t>n;n++)i[n]=e.charCodeAt(n);return i}function array_to_hex_string(e){for(var t="",i=0;i<e.length;i++)t+=SHA256_hexchars[e[i]>>4]+SHA256_hexchars[15&e[i]];return t}function array_to_string(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}function SHA256_init(){SHA256_H=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),SHA256_buf=new Array,SHA256_len=0
}function SHA256_write(e){SHA256_buf=SHA256_buf.concat("string"==typeof e?string_to_array(e):e);for(var t=0;t+64<=SHA256_buf.length;t+=64)SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf.slice(t,t+64));SHA256_buf=SHA256_buf.slice(t),SHA256_len+=e.length}function SHA256_finalize(){if(SHA256_buf[SHA256_buf.length]=128,SHA256_buf.length>56){for(var e=SHA256_buf.length;64>e;e++)SHA256_buf[e]=0;SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf),SHA256_buf.length=0}for(var e=SHA256_buf.length;59>e;e++)SHA256_buf[e]=0;
SHA256_buf[59]=SHA256_len>>>29&255,SHA256_buf[60]=SHA256_len>>>21&255,SHA256_buf[61]=SHA256_len>>>13&255,SHA256_buf[62]=SHA256_len>>>5&255,SHA256_buf[63]=SHA256_len<<3&255,SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf);for(var t=new Array(32),e=0;8>e;e++)t[4*e+0]=SHA256_H[e]>>>24,t[4*e+1]=SHA256_H[e]>>16&255,t[4*e+2]=SHA256_H[e]>>8&255,t[4*e+3]=255&SHA256_H[e];return delete SHA256_H,delete SHA256_buf,delete SHA256_len,t}function SHA256_hash(e){var t;return SHA256_init(),SHA256_write(e),t=SHA256_finalize(),array_to_hex_string(t)
}function HMAC_SHA256_init(e){HMAC_SHA256_key="string"==typeof e?string_to_array(e):(new Array).concat(e),HMAC_SHA256_key.length>64&&(SHA256_init(),SHA256_write(HMAC_SHA256_key),HMAC_SHA256_key=SHA256_finalize());for(var t=HMAC_SHA256_key.length;64>t;t++)HMAC_SHA256_key[t]=0;for(var t=0;64>t;t++)HMAC_SHA256_key[t]^=54;SHA256_init(),SHA256_write(HMAC_SHA256_key)}function HMAC_SHA256_write(e){SHA256_write(e)}function HMAC_SHA256_finalize(){for(var e=SHA256_finalize(),t=0;64>t;t++)HMAC_SHA256_key[t]^=106;
SHA256_init(),SHA256_write(HMAC_SHA256_key),SHA256_write(e);for(var t=0;64>t;t++)HMAC_SHA256_key[t]=0;return delete HMAC_SHA256_key,SHA256_finalize()}function HMAC_SHA256_MAC(e,t){var i;return HMAC_SHA256_init(e),HMAC_SHA256_write(t),i=HMAC_SHA256_finalize(),array_to_hex_string(i)}function SHA256_sigma0(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}function SHA256_sigma1(e){return(e>>>17|e<<15)^(e>>>19|e<<13)^e>>>10}function SHA256_Sigma0(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function SHA256_Sigma1(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)
}function SHA256_Ch(e,t,i){return i^e&(t^i)}function SHA256_Maj(e,t,i){return e&t^i&(e^t)}function SHA256_Hash_Word_Block(e,t){for(var i=16;64>i;i++)t[i]=SHA256_sigma1(t[i-2])+t[i-7]+SHA256_sigma0(t[i-15])+t[i-16]&4294967295;for(var n=(new Array).concat(e),i=0;64>i;i++){var r=n[7]+SHA256_Sigma1(n[4])+SHA256_Ch(n[4],n[5],n[6])+SHA256_K[i]+t[i],s=SHA256_Sigma0(n[0])+SHA256_Maj(n[0],n[1],n[2]);n.pop(),n.unshift(r+s&4294967295),n[4]=n[4]+r&4294967295}for(var i=0;8>i;i++)e[i]=e[i]+n[i]&4294967295}function SHA256_Hash_Byte_Block(e,t){for(var i=new Array(16),n=0;16>n;n++)i[n]=t[4*n+0]<<24|t[4*n+1]<<16|t[4*n+2]<<8|t[4*n+3];
SHA256_Hash_Word_Block(e,i)}var requirejs,require,define;!function(e){function t(e,t){return v.call(e,t)}function i(e,t){var i,n,r,s,a,o,l,u,c,d,h=t&&t.split("/"),p=m.map,f=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(h=h.slice(0,h.length-1),e=h.concat(e.split("/")),u=0;u<e.length;u+=1)if(d=e[u],"."===d)e.splice(u,1),u-=1;else if(".."===d){if(1===u&&(".."===e[2]||".."===e[0]))break;u>0&&(e.splice(u-1,2),u-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((h||f)&&p){for(i=e.split("/"),u=i.length;u>0;u-=1){if(n=i.slice(0,u).join("/"),h)for(c=h.length;c>0;c-=1)if(r=p[h.slice(0,c).join("/")],r&&(r=r[n])){s=r,a=u;
break}if(s)break;!o&&f&&f[n]&&(o=f[n],l=u)}!s&&o&&(s=o,a=l),s&&(i.splice(0,a,s),e=i.join("/"))}return e}function n(t,i){return function(){return c.apply(e,y.call(arguments,0).concat([t,i]))}}function r(e){return function(t){return i(t,e)}}function s(e){return function(t){p[e]=t}}function a(i){if(t(f,i)){var n=f[i];delete f[i],g[i]=!0,u.apply(e,n)}if(!t(p,i)&&!t(g,i))throw new Error("No "+i);return p[i]}function o(e){var t,i=e?e.indexOf("!"):-1;return i>-1&&(t=e.substring(0,i),e=e.substring(i+1,e.length)),[t,e]
}function l(e){return function(){return m&&m.config&&m.config[e]||{}}}var u,c,d,h,p={},f={},m={},g={},v=Object.prototype.hasOwnProperty,y=[].slice;d=function(e,t){var n,s=o(e),l=s[0];return e=s[1],l&&(l=i(l,t),n=a(l)),l?e=n&&n.normalize?n.normalize(e,r(t)):i(e,t):(e=i(e,t),s=o(e),l=s[0],e=s[1],l&&(n=a(l))),{f:l?l+"!"+e:e,n:e,pr:l,p:n}},h={require:function(e){return n(e)},exports:function(e){var t=p[e];return"undefined"!=typeof t?t:p[e]={}},module:function(e){return{id:e,uri:"",exports:p[e],config:l(e)}
}},u=function(i,r,o,l){var u,c,m,v,y,b,x=[];if(l=l||i,"function"==typeof o){for(r=!r.length&&o.length?["require","exports","module"]:r,y=0;y<r.length;y+=1)if(v=d(r[y],l),c=v.f,"require"===c)x[y]=h.require(i);else if("exports"===c)x[y]=h.exports(i),b=!0;else if("module"===c)u=x[y]=h.module(i);else if(t(p,c)||t(f,c)||t(g,c))x[y]=a(c);else{if(!v.p)throw new Error(i+" missing "+c);v.p.load(v.n,n(l,!0),s(c),{}),x[y]=p[c]}m=o.apply(p[i],x),i&&(u&&u.exports!==e&&u.exports!==p[i]?p[i]=u.exports:m===e&&b||(p[i]=m))
}else i&&(p[i]=o)},requirejs=require=c=function(t,i,n,r,s){return"string"==typeof t?h[t]?h[t](i):a(d(t,i).f):(t.splice||(m=t,i.splice?(t=i,i=n,n=null):t=e),i=i||function(){},"function"==typeof n&&(n=r,r=s),r?u(e,t,i,n):setTimeout(function(){u(e,t,i,n)},4),c)},c.config=function(e){return m=e,m.deps&&c(m.deps,m.callback),c},requirejs._defined=p,define=function(e,i,n){i.splice||(n=i,i=[]),t(p,e)||t(f,e)||(f[e]=[e,i,n])},define.amd={jQuery:!0}}(),define("libs/require/almond-0.2.6",function(){}),require.config({templatePathPrefixs:["app/","app/js/"],paths:{templates:"../templates",text:"libs/require/text-2.0.10",hb:"libs/require/handlebars.precompile-0.1",tpl:"libs/require/underscore-tpl-0.1.0","jquery-lib":"libs/jquery-1.10.2",underscore:"libs/backbone/underscore-1.6.0","backbone-lib":"libs/backbone/backbone-1.1.2","marionette-lib":"libs/backbone/backbone.marionette-1.6.4","backbone.wreqr":"libs/backbone/backbone.wreqr-1.1.0","backbone.babysitter":"libs/backbone/backbone.babysitter-0.1.0","backbone.obscura":"libs/backbone/backbone.obscura-0.1.7","handlebars-lib":"libs/backbone/handlebars-1.1.2","soundmanager-lib":"libs/soundmanager/soundmanager2-custom",googledash:"libs/googledash",jwplayer:"libs/jwplayer/jwplayer-6.8",swfobject:"libs/jwplayer/swfobject-2.2",fastclick:"libs/fastclick-0.6.11",x2js:"libs/x2js-1.0.11",moment:"libs/moment-2.4.0","chrome-analytics":"libs/analytics/chrome-analytics","google-analytics":"libs/analytics/google-analytics",bugsense:"libs/analytics/bugsense-f0c8aa6e10",raven:"libs/analytics/raven-1.1.16",selectize:"libs/selectize-0.11.2","jquery.freefocus":"libs/jquery.freefocus-0.8.7","jquery.translate":"libs/jquery.translate-0.1.0","jquery.mousewheel":"libs/jquery.mousewheel-3.1.11",sortable:"libs/sortable-0.3.0",mousetrap:"libs/mousetrap-1.4.6",jssha256:"libs/jssha256-0.1",requestanimframe:"libs/requestanimframe-0.1",jquery:"plex/base/initializers/configs/JQueryConfig",backbone:"plex/base/initializers/configs/BackboneConfig",marionette:"plex/base/initializers/configs/MarionetteConfig",handlebars:"plex/base/initializers/configs/HandlebarsConfig",soundmanager:"plex/base/initializers/configs/SoundManagerConfig",affix:"libs/bootstrap/affix",alert:"libs/bootstrap/alert",button:"libs/bootstrap/button",carousel:"libs/bootstrap/carousel",collapse:"libs/bootstrap/collapse",dropdown:"libs/bootstrap/dropdown",modal:"libs/bootstrap/modal",popover:"libs/bootstrap/popover",scrollspy:"libs/bootstrap/scrollspy",tab:"libs/bootstrap/tab",tooltip:"libs/bootstrap/tooltip",transition:"libs/bootstrap/transition",qwebchannel:"libs/qwebchannel"},shim:{hb:["handlebars"],"handlebars-lib":{exports:"Handlebars"},googledash:{exports:"googledash"},jwplayer:{exports:"jwplayer"},swfobject:{exports:"swfobject"},x2js:{exports:"X2JS"},moment:{exports:"moment"},"chrome-analytics":{exports:"analytics"},"google-analytics":{exports:"ga"},bugsense:{exports:"Bugsense"},"jquery.freefocus":["jquery"],"jquery.translate":["jquery"],"jquery.mousewheel":["jquery"],sortable:{exports:"Sortable"},qwebchannel:{exports:"QWebChannel"},affix:["jquery"],alert:["jquery"],button:["jquery"],carousel:["jquery"],collapse:["jquery"],dropdown:["jquery"],modal:["jquery"],scrollspy:["jquery"],tab:["jquery"],tooltip:["jquery"],popover:["jquery","tooltip"],transition:["jquery"]}}),define("config/require.conf",function(){}),define("text",["module"],function(e){var t,i,n,r,s,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],o=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,c=u&&location.protocol&&location.protocol.replace(/\:/,""),d=u&&location.hostname,h=u&&(location.port||void 0),p={},f=e.config&&e.config()||{};
return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(o,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,i;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){i=a[t];
try{e=new ActiveXObject(i)}catch(n){}if(e){a=[i];break}}return e},parseName:function(e){var t,i,n,r=!1,s=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==s&&(!a||s>1)?(t=e.substring(0,s),i=e.substring(s+1,e.length)):t=e,n=i||t,s=n.indexOf("!"),-1!==s&&(r="strip"===n.substring(s+1),n=n.substring(0,s),i?i=n:t=n),{moduleName:t,ext:i,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,i,n,r){var s,a,o,l=t.xdRegExp.exec(e);return l?(s=l[2],a=l[3],a=a.split(":"),o=a[1],a=a[0],!(s&&s!==i||a&&a.toLowerCase()!==n.toLowerCase()||(o||a)&&o!==r)):!0
},finishLoad:function(e,i,n,r){n=i?t.strip(n):n,f.isBuild&&(p[e]=n),r(n)},load:function(e,i,n,r){if(r.isBuild&&!r.inlineText)return void n();f.isBuild=r.isBuild;var s=t.parseName(e),a=s.moduleName+(s.ext?"."+s.ext:""),o=i.toUrl(a),l=f.useXhr||t.useXhr;return 0===o.indexOf("empty:")?void n():void(!u||l(o,c,d,h)?t.get(o,function(i){t.finishLoad(e,s.strip,i,n)},function(e){n.error&&n.error(e)}):i([a],function(e){t.finishLoad(s.moduleName+"."+s.ext,s.strip,e,n)}))},write:function(e,i,n){if(p.hasOwnProperty(i)){var r=t.jsEscape(p[i]);
n.asModule(e+"!"+i,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,i,n,r,s){var a=t.parseName(i),o=a.ext?"."+a.ext:"",l=a.moduleName+o,u=n.toUrl(a.moduleName+o)+".js";t.load(l,n,function(){var i=function(e){return r(u,e)};i.asModule=function(e,t){return r.asModule(e,u,t)},t.write(e,l,i,s)},s)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(i=require.nodeRequire("fs"),t.get=function(e,t,n){try{var r=i.readFileSync(e,"utf8");
0===r.indexOf("\ufeff")&&(r=r.substring(1)),t(r)}catch(s){n(s)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,i,n,r){var s,a=t.createXhr();if(a.open("GET",e,!0),r)for(s in r)r.hasOwnProperty(s)&&a.setRequestHeader(s.toLowerCase(),r[s]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(){var t,r;4===a.readyState&&(t=a.status,t>399&&600>t?(r=new Error(e+" HTTP status: "+t),r.xhr=a,n(r)):i(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,e))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var i,n,r="utf-8",s=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),o=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s),r)),l="";
try{for(i=new java.lang.StringBuffer,n=o.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),null!==n&&i.append(n);null!==(n=o.readLine());)i.append(a),i.append(n);l=String(i.toString())}finally{o.close()}t(l)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(n=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in n,t.get=function(e,t){var i,a,o,l={};
s&&(e=e.replace(/\//g,"\\")),o=new FileUtils.File(e);try{i=n["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),i.init(o,1,0,!1),a=n["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(i,"utf-8",i.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(i.available(),l),a.close(),i.close(),t(l.value)}catch(u){throw new Error((o&&o.path||"")+": "+u)}}),t}),define("text!config/chromecast.conf.json",[],function(){return'{\n  "paths": {\n    "jquery": "libs/zepto-1.1.2"\n  },\n\n  "shim": {\n    "jquery": { "exports": "$" }\n  }\n}\n'
}),function(){var e=this,t=e._,i={},n=Array.prototype,r=Object.prototype,s=Function.prototype,a=n.push,o=n.slice,l=n.concat,u=r.toString,c=r.hasOwnProperty,d=n.forEach,h=n.map,p=n.reduce,f=n.reduceRight,m=n.filter,g=n.every,v=n.some,y=n.indexOf,b=n.lastIndexOf,x=Array.isArray,w=Object.keys,S=s.bind,_=function(e){return e instanceof _?e:this instanceof _?void(this._wrapped=e):new _(e)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=_),exports._=_):e._=_,_.VERSION="1.6.0";
var k=_.each=_.forEach=function(e,t,n){if(null==e)return e;if(d&&e.forEach===d)e.forEach(t,n);else if(e.length===+e.length){for(var r=0,s=e.length;s>r;r++)if(t.call(n,e[r],r,e)===i)return}else for(var a=_.keys(e),r=0,s=a.length;s>r;r++)if(t.call(n,e[a[r]],a[r],e)===i)return;return e};_.map=_.collect=function(e,t,i){var n=[];return null==e?n:h&&e.map===h?e.map(t,i):(k(e,function(e,r,s){n.push(t.call(i,e,r,s))}),n)};var P="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(e,t,i,n){var r=arguments.length>2;
if(null==e&&(e=[]),p&&e.reduce===p)return n&&(t=_.bind(t,n)),r?e.reduce(t,i):e.reduce(t);if(k(e,function(e,s,a){r?i=t.call(n,i,e,s,a):(i=e,r=!0)}),!r)throw new TypeError(P);return i},_.reduceRight=_.foldr=function(e,t,i,n){var r=arguments.length>2;if(null==e&&(e=[]),f&&e.reduceRight===f)return n&&(t=_.bind(t,n)),r?e.reduceRight(t,i):e.reduceRight(t);var s=e.length;if(s!==+s){var a=_.keys(e);s=a.length}if(k(e,function(o,l,u){l=a?a[--s]:--s,r?i=t.call(n,i,e[l],l,u):(i=e[l],r=!0)}),!r)throw new TypeError(P);
return i},_.find=_.detect=function(e,t,i){var n;return M(e,function(e,r,s){return t.call(i,e,r,s)?(n=e,!0):void 0}),n},_.filter=_.select=function(e,t,i){var n=[];return null==e?n:m&&e.filter===m?e.filter(t,i):(k(e,function(e,r,s){t.call(i,e,r,s)&&n.push(e)}),n)},_.reject=function(e,t,i){return _.filter(e,function(e,n,r){return!t.call(i,e,n,r)},i)},_.every=_.all=function(e,t,n){t||(t=_.identity);var r=!0;return null==e?r:g&&e.every===g?e.every(t,n):(k(e,function(e,s,a){return(r=r&&t.call(n,e,s,a))?void 0:i
}),!!r)};var M=_.some=_.any=function(e,t,n){t||(t=_.identity);var r=!1;return null==e?r:v&&e.some===v?e.some(t,n):(k(e,function(e,s,a){return r||(r=t.call(n,e,s,a))?i:void 0}),!!r)};_.contains=_.include=function(e,t){return null==e?!1:y&&e.indexOf===y?-1!=e.indexOf(t):M(e,function(e){return e===t})},_.invoke=function(e,t){var i=o.call(arguments,2),n=_.isFunction(t);return _.map(e,function(e){return(n?t:e[t]).apply(e,i)})},_.pluck=function(e,t){return _.map(e,_.property(t))},_.where=function(e,t){return _.filter(e,_.matches(t))
},_.findWhere=function(e,t){return _.find(e,_.matches(t))},_.max=function(e,t,i){if(!t&&_.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var n=-1/0,r=-1/0;return k(e,function(e,s,a){var o=t?t.call(i,e,s,a):e;o>r&&(n=e,r=o)}),n},_.min=function(e,t,i){if(!t&&_.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var n=1/0,r=1/0;return k(e,function(e,s,a){var o=t?t.call(i,e,s,a):e;r>o&&(n=e,r=o)}),n},_.shuffle=function(e){var t,i=0,n=[];return k(e,function(e){t=_.random(i++),n[i-1]=n[t],n[t]=e
}),n},_.sample=function(e,t,i){return null==t||i?(e.length!==+e.length&&(e=_.values(e)),e[_.random(e.length-1)]):_.shuffle(e).slice(0,Math.max(0,t))};var C=function(e){return null==e?_.identity:_.isFunction(e)?e:_.property(e)};_.sortBy=function(e,t,i){return t=C(t),_.pluck(_.map(e,function(e,n,r){return{value:e,index:n,criteria:t.call(i,e,n,r)}}).sort(function(e,t){var i=e.criteria,n=t.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return e.index-t.index}),"value")};var T=function(e){return function(t,i,n){var r={};
return i=C(i),k(t,function(s,a){var o=i.call(n,s,a,t);e(r,o,s)}),r}};_.groupBy=T(function(e,t,i){_.has(e,t)?e[t].push(i):e[t]=[i]}),_.indexBy=T(function(e,t,i){e[t]=i}),_.countBy=T(function(e,t){_.has(e,t)?e[t]++:e[t]=1}),_.sortedIndex=function(e,t,i,n){i=C(i);for(var r=i.call(n,t),s=0,a=e.length;a>s;){var o=s+a>>>1;i.call(n,e[o])<r?s=o+1:a=o}return s},_.toArray=function(e){return e?_.isArray(e)?o.call(e):e.length===+e.length?_.map(e,_.identity):_.values(e):[]},_.size=function(e){return null==e?0:e.length===+e.length?e.length:_.keys(e).length
},_.first=_.head=_.take=function(e,t,i){return null==e?void 0:null==t||i?e[0]:0>t?[]:o.call(e,0,t)},_.initial=function(e,t,i){return o.call(e,0,e.length-(null==t||i?1:t))},_.last=function(e,t,i){return null==e?void 0:null==t||i?e[e.length-1]:o.call(e,Math.max(e.length-t,0))},_.rest=_.tail=_.drop=function(e,t,i){return o.call(e,null==t||i?1:t)},_.compact=function(e){return _.filter(e,_.identity)};var A=function(e,t,i){return t&&_.every(e,_.isArray)?l.apply(i,e):(k(e,function(e){_.isArray(e)||_.isArguments(e)?t?a.apply(i,e):A(e,t,i):i.push(e)
}),i)};_.flatten=function(e,t){return A(e,t,[])},_.without=function(e){return _.difference(e,o.call(arguments,1))},_.partition=function(e,t,i){t=C(t);var n=[],r=[];return k(e,function(e){(t.call(i,e)?n:r).push(e)}),[n,r]},_.uniq=_.unique=function(e,t,i,n){_.isFunction(t)&&(n=i,i=t,t=!1);var r=i?_.map(e,i,n):e,s=[],a=[];return k(r,function(i,n){(t?n&&a[a.length-1]===i:_.contains(a,i))||(a.push(i),s.push(e[n]))}),s},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(e){var t=o.call(arguments,1);
return _.filter(_.uniq(e),function(e){return _.every(t,function(t){return _.contains(t,e)})})},_.difference=function(e){var t=l.apply(n,o.call(arguments,1));return _.filter(e,function(e){return!_.contains(t,e)})},_.zip=function(){for(var e=_.max(_.pluck(arguments,"length").concat(0)),t=new Array(e),i=0;e>i;i++)t[i]=_.pluck(arguments,""+i);return t},_.object=function(e,t){if(null==e)return{};for(var i={},n=0,r=e.length;r>n;n++)t?i[e[n]]=t[n]:i[e[n][0]]=e[n][1];return i},_.indexOf=function(e,t,i){if(null==e)return-1;
var n=0,r=e.length;if(i){if("number"!=typeof i)return n=_.sortedIndex(e,t),e[n]===t?n:-1;n=0>i?Math.max(0,r+i):i}if(y&&e.indexOf===y)return e.indexOf(t,i);for(;r>n;n++)if(e[n]===t)return n;return-1},_.lastIndexOf=function(e,t,i){if(null==e)return-1;var n=null!=i;if(b&&e.lastIndexOf===b)return n?e.lastIndexOf(t,i):e.lastIndexOf(t);for(var r=n?i:e.length;r--;)if(e[r]===t)return r;return-1},_.range=function(e,t,i){arguments.length<=1&&(t=e||0,e=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((t-e)/i),0),r=0,s=new Array(n);n>r;)s[r++]=e,e+=i;
return s};var I=function(){};_.bind=function(e,t){var i,n;if(S&&e.bind===S)return S.apply(e,o.call(arguments,1));if(!_.isFunction(e))throw new TypeError;return i=o.call(arguments,2),n=function(){if(!(this instanceof n))return e.apply(t,i.concat(o.call(arguments)));I.prototype=e.prototype;var r=new I;I.prototype=null;var s=e.apply(r,i.concat(o.call(arguments)));return Object(s)===s?s:r}},_.partial=function(e){var t=o.call(arguments,1);return function(){for(var i=0,n=t.slice(),r=0,s=n.length;s>r;r++)n[r]===_&&(n[r]=arguments[i++]);
for(;i<arguments.length;)n.push(arguments[i++]);return e.apply(this,n)}},_.bindAll=function(e){var t=o.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return k(t,function(t){e[t]=_.bind(e[t],e)}),e},_.memoize=function(e,t){var i={};return t||(t=_.identity),function(){var n=t.apply(this,arguments);return _.has(i,n)?i[n]:i[n]=e.apply(this,arguments)}},_.delay=function(e,t){var i=o.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)},_.defer=function(e){return _.delay.apply(_,[e,1].concat(o.call(arguments,1)))
},_.throttle=function(e,t,i){var n,r,s,a=null,o=0;i||(i={});var l=function(){o=i.leading===!1?0:_.now(),a=null,s=e.apply(n,r),n=r=null};return function(){var u=_.now();o||i.leading!==!1||(o=u);var c=t-(u-o);return n=this,r=arguments,0>=c?(clearTimeout(a),a=null,o=u,s=e.apply(n,r),n=r=null):a||i.trailing===!1||(a=setTimeout(l,c)),s}},_.debounce=function(e,t,i){var n,r,s,a,o,l=function(){var u=_.now()-a;t>u?n=setTimeout(l,t-u):(n=null,i||(o=e.apply(s,r),s=r=null))};return function(){s=this,r=arguments,a=_.now();
var u=i&&!n;return n||(n=setTimeout(l,t)),u&&(o=e.apply(s,r),s=r=null),o}},_.once=function(e){var t,i=!1;return function(){return i?t:(i=!0,t=e.apply(this,arguments),e=null,t)}},_.wrap=function(e,t){return _.partial(t,e)},_.compose=function(){var e=arguments;return function(){for(var t=arguments,i=e.length-1;i>=0;i--)t=[e[i].apply(this,t)];return t[0]}},_.after=function(e,t){return function(){return--e<1?t.apply(this,arguments):void 0}},_.keys=function(e){if(!_.isObject(e))return[];if(w)return w(e);
var t=[];for(var i in e)_.has(e,i)&&t.push(i);return t},_.values=function(e){for(var t=_.keys(e),i=t.length,n=new Array(i),r=0;i>r;r++)n[r]=e[t[r]];return n},_.pairs=function(e){for(var t=_.keys(e),i=t.length,n=new Array(i),r=0;i>r;r++)n[r]=[t[r],e[t[r]]];return n},_.invert=function(e){for(var t={},i=_.keys(e),n=0,r=i.length;r>n;n++)t[e[i[n]]]=i[n];return t},_.functions=_.methods=function(e){var t=[];for(var i in e)_.isFunction(e[i])&&t.push(i);return t.sort()},_.extend=function(e){return k(o.call(arguments,1),function(t){if(t)for(var i in t)e[i]=t[i]
}),e},_.pick=function(e){var t={},i=l.apply(n,o.call(arguments,1));return k(i,function(i){i in e&&(t[i]=e[i])}),t},_.omit=function(e){var t={},i=l.apply(n,o.call(arguments,1));for(var r in e)_.contains(i,r)||(t[r]=e[r]);return t},_.defaults=function(e){return k(o.call(arguments,1),function(t){if(t)for(var i in t)void 0===e[i]&&(e[i]=t[i])}),e},_.clone=function(e){return _.isObject(e)?_.isArray(e)?e.slice():_.extend({},e):e},_.tap=function(e,t){return t(e),e};var E=function(e,t,i,n){if(e===t)return 0!==e||1/e==1/t;
if(null==e||null==t)return e===t;e instanceof _&&(e=e._wrapped),t instanceof _&&(t=t._wrapped);var r=u.call(e);if(r!=u.call(t))return!1;switch(r){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if("object"!=typeof e||"object"!=typeof t)return!1;for(var s=i.length;s--;)if(i[s]==e)return n[s]==t;
var a=e.constructor,o=t.constructor;if(a!==o&&!(_.isFunction(a)&&a instanceof a&&_.isFunction(o)&&o instanceof o)&&"constructor"in e&&"constructor"in t)return!1;i.push(e),n.push(t);var l=0,c=!0;if("[object Array]"==r){if(l=e.length,c=l==t.length)for(;l--&&(c=E(e[l],t[l],i,n)););}else{for(var d in e)if(_.has(e,d)&&(l++,!(c=_.has(t,d)&&E(e[d],t[d],i,n))))break;if(c){for(d in t)if(_.has(t,d)&&!l--)break;c=!l}}return i.pop(),n.pop(),c};_.isEqual=function(e,t){return E(e,t,[],[])},_.isEmpty=function(e){if(null==e)return!0;
if(_.isArray(e)||_.isString(e))return 0===e.length;for(var t in e)if(_.has(e,t))return!1;return!0},_.isElement=function(e){return!(!e||1!==e.nodeType)},_.isArray=x||function(e){return"[object Array]"==u.call(e)},_.isObject=function(e){return e===Object(e)},k(["Arguments","Function","String","Number","Date","RegExp"],function(e){_["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),_.isArguments(arguments)||(_.isArguments=function(e){return!(!e||!_.has(e,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(e){return"function"==typeof e
}),_.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},_.isNaN=function(e){return _.isNumber(e)&&e!=+e},_.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},_.isNull=function(e){return null===e},_.isUndefined=function(e){return void 0===e},_.has=function(e,t){return c.call(e,t)},_.noConflict=function(){return e._=t,this},_.identity=function(e){return e},_.constant=function(e){return function(){return e}},_.property=function(e){return function(t){return t[e]}
},_.matches=function(e){return function(t){if(t===e)return!0;for(var i in e)if(e[i]!==t[i])return!1;return!0}},_.times=function(e,t,i){for(var n=Array(Math.max(0,e)),r=0;e>r;r++)n[r]=t.call(i,r);return n},_.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},_.now=Date.now||function(){return(new Date).getTime()};var D={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};D.unescape=_.invert(D.escape);var L={escape:new RegExp("["+_.keys(D.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(D.unescape).join("|")+")","g")};
_.each(["escape","unescape"],function(e){_[e]=function(t){return null==t?"":(""+t).replace(L[e],function(t){return D[e][t]})}}),_.result=function(e,t){if(null==e)return void 0;var i=e[t];return _.isFunction(i)?i.call(e):i},_.mixin=function(e){k(_.functions(e),function(t){var i=_[t]=e[t];_.prototype[t]=function(){var e=[this._wrapped];return a.apply(e,arguments),U.call(this,i.apply(_,e))}})};var R=0;_.uniqueId=function(e){var t=++R+"";return e?e+t:t},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};
var O=/(.)^/,j={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},B=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(e,t,i){var n;i=_.defaults({},i,_.templateSettings);var r=new RegExp([(i.escape||O).source,(i.interpolate||O).source,(i.evaluate||O).source].join("|")+"|$","g"),s=0,a="__p+='";e.replace(r,function(t,i,n,r,o){return a+=e.slice(s,o).replace(B,function(e){return"\\"+j[e]}),i&&(a+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(a+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),r&&(a+="';\n"+r+"\n__p+='"),s=o+t.length,t
}),a+="';\n",i.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{n=new Function(i.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t)return n(t,_);var l=function(e){return n.call(this,e,_)};return l.source="function("+(i.variable||"obj")+"){\n"+a+"}",l},_.chain=function(e){return _(e).chain()};var U=function(e){return this._chain?_(e).chain():e};_.mixin(_),k(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=n[e];
_.prototype[e]=function(){var i=this._wrapped;return t.apply(i,arguments),"shift"!=e&&"splice"!=e||0!==i.length||delete i[0],U.call(this,i)}}),k(["concat","join","slice"],function(e){var t=n[e];_.prototype[e]=function(){return U.call(this,t.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this),define("plex/base/utils/BaseClass",["underscore"],function(e){function t(){e.isFunction(this.initialize)&&this.initialize.apply(this,arguments)
}var i=function(t,i){var n,r=this;n=t&&e.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)||null},e.extend(n,r,i);var s=function(){this.constructor=n};if(s.prototype=r.prototype,n.prototype=new s,t&&t.hasOwnProperty("mixins")){var a=t.mixins;delete t.mixins,e.isArray(a)||(a=[a]),e.each(a,function(t){e.extend(n.prototype,t)})}return t&&e.extend(n.prototype,t),n.__super__=r.prototype,n};return t.extend=i,t}),define("plex/base/mixins/eventMixin",["underscore"],function(e){var t=/\s+/,i=function(e,i,n,r){if(!n)return!0;
if("object"==typeof n){for(var s in n)e[i].apply(e,[s,n[s]].concat(r));return!1}if(t.test(n)){for(var a=n.split(t),o=0,l=a.length;l>o;o++)e[i].apply(e,[a[o]].concat(r));return!1}return!0},n=function(e,t){var i,n=-1,r=e.length,s=t[0],a=t[1],o=t[2];switch(t.length){case 0:for(;++n<r;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s);return;case 2:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s,a);return;case 3:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s,a,o);return;default:for(;++n<r;)(i=e[n]).callback.apply(i.ctx,t)
}},r={on:function(e,t,n){if(!i(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var r=this._events[e]||(this._events[e]=[]);return r.push({callback:t,context:n,ctx:n||this}),this},once:function(t,n,r){if(!i(this,"once",t,[n,r])||!n)return this;var s=this,a=e.once(function(){s.off(t,a),n.apply(this,arguments)});return a._callback=n,this.on(t,a,r)},off:function(t,n,r){var s,a,o,l,u,c,d,h;if(!this._events||!i(this,"off",t,[n,r]))return this;if(!t&&!n&&!r)return this._events=void 0,this;
for(l=t?[t]:e.keys(this._events),u=0,c=l.length;c>u;u++)if(t=l[u],o=this._events[t]){if(this._events[t]=s=[],n||r)for(d=0,h=o.length;h>d;d++)a=o[d],(n&&n!==a.callback&&n!==a.callback._callback||r&&r!==a.context)&&s.push(a);s.length||delete this._events[t]}return this},trigger:function(e){if(!this._events)return this;var t=[].slice.call(arguments,1);if(!i(this,"trigger",e,t))return this;var r=this._events[e],s=this._events.all;return r&&n(r,t),s&&n(s,arguments),this},stopListening:function(t,i,n){var r=this._listeningTo;
if(!r)return this;var s=!i&&!n;n||"object"!=typeof i||(n=this),t&&((r={})[t._listenId]=t);for(var a in r)t=r[a],t.off(i,n,this),(s||e.isEmpty(t._events))&&delete this._listeningTo[a];return this},hasListener:function(t){var i=this._events&&this._events[t];return e.isArray(i)&&i.length>0}},s={listenTo:"on",listenToOnce:"once"};return e.each(s,function(t,i){r[i]=function(i,n,r){var s=this._listeningTo||(this._listeningTo={}),a=i._listenId||(i._listenId=e.uniqueId("l"));return s[a]=i,r||"object"!=typeof n||(r=this),i[t](n,r,this),this
}}),r.bind=r.on,r.unbind=r.off,r}),define("plex/base/utils/dispatcher",["plex/base/utils/BaseClass","plex/base/mixins/eventMixin"],function(e,t){var i=e.extend({mixins:t});return new i}),define("plex/base/adapters/Adapter",["underscore","plex/base/utils/BaseClass","plex/base/mixins/eventMixin"],function(e,t,i){var n=t.extend({mixins:i,initialize:function(t){t||(t={}),t["interface"]&&(this["interface"]=t["interface"]),t.props&&(this.props=t.props),e.each(this["interface"],function(t){this[t]=e.bind(this._proxy,this,t)
},this)},_proxy:function(t){var i=this.getInstance();return i[t].apply(i,e.rest(arguments))},register:function(e){this._instance=e,this.trigger("change:instance",e)},getInstance:function(){if(this.hasInstance())return this._instance;throw new Error("Nothing has been registered to this adapter.")},hasInstance:function(){return null!=this._instance},prop:function(t){if(e.contains(this.props,t))return this.getInstance()[t];throw new Error("The "+t+" property has not been defined for this adapter")}});
return n}),define("plex/base/adapters/loggerAdapter",["plex/base/adapters/Adapter"],function(e){var t=new e({"interface":["log","success","info","warn","error","debug","group"]});return t}),define("plex/base/utils/cache/Cache",["underscore","plex/base/utils/BaseClass","plex/base/utils/dispatcher","plex/base/adapters/loggerAdapter","plex/base/mixins/eventMixin"],function(e,t,i,n,r){var s=t.extend({mixins:r,maxCycles:3,maxSize:50,isListening:!1,initialize:function(){this._cache={},this.size=0,this.cycle()
},startListening:function(){this.isListening||(this.isListening=!0,this.listenTo(i,{"cycle:cache":this.cycle,"invalidate:cache":this.removeWhere,"clear:cache":this.removeAll}))},get:function(t){var i=this._cache[t];return i&&i._cacheCycle&&this.setItemCycle(i,t,e.first(this.cycles)),i},store:function(t,i){i||(i=this.getItemCacheKey(t)),this.remove(t),i&&(this.startListening(),t._cacheKey=i,this._cache[i]=t,this.size++,t.persistInCache||this.setItemCycle(t,i,e.first(this.cycles)))},getItemCacheKey:function(t){return e.result(t,"cacheKey")
},setItemCycle:function(e,t,i){var n=e._cacheCycle;n&&n.hasOwnProperty(t)&&delete n[t],e._cacheCycle=i,i[t]=e},cycle:function(){this.cycles||(this.cycles=[]),this.size>this.maxSize&&(n.warn("Cache overflow, size: "+this.size),e.each(this.cycles.slice(1),this.removeCycle,this)),this.cycles.unshift({}),this.cycles.length>Math.max(this.maxCycles,1)&&this.removeCycle(e.last(this.cycles))},remove:function(e){if(e&&e._cacheKey){var t=e._cacheKey;this._cache.hasOwnProperty(t)&&(delete this._cache[t],this.size--),e._cacheCycle&&(e._cacheCycle.hasOwnProperty(t)&&delete e._cacheCycle[t],delete e._cacheCycle),delete e._cacheKey
}},removeCycle:function(t){e.each(e.values(t),this.remove,this);var i=e.indexOf(this.cycles,t);this.cycles.splice(i,1)},removeWhere:function(t){var i=e.where(e.values(this._cache),t);e.each(i,this.remove,this)},removeAll:function(){e.each(e.values(this._cache),this.remove,this),this.cycles.length=0,this.cycle(),this.stopListening(),this.isListening=!1}});return s}),define("plex/base/utils/cache/ModelCache",["underscore","plex/base/utils/cache/Cache"],function(e,t){var i=t.extend({maxCycles:5,maxSize:100,getItemCacheKey:function(t,i){return e.isFunction(t.cacheKey)?(i||(i=t.toJSON()),t.cacheKey(i)):void 0
}});return i}),define("plex/base/utils/cache/CollectionCache",["underscore","plex/base/utils/cache/Cache"],function(e,t){var i=t.extend({maxCycles:3,maxSize:20,get:function(){var e=t.prototype.get.apply(this,arguments);return e&&e.every(function(e){return e.cache&&e.cache.isListening?(e.cache.store(e),!0):!1}),e},getItemCacheKey:function(t){var i=e.result(t,"url");return t.server?t.server.getScopedKey(i):i}});return i}),define("plex/base/adapters/localizerAdapter",["plex/base/adapters/Adapter"],function(e){var t=new e({"interface":["getLanguages","load","t"]});
return t});var Zepto=function(){function e(e){return null==e?String(e):$[X.call(e)]||"object"}function t(t){return"function"==e(t)}function i(e){return null!=e&&e==e.window}function n(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function r(t){return"object"==e(t)}function s(e){return r(e)&&!i(e)&&Object.getPrototypeOf(e)==Object.prototype}function a(e){return"number"==typeof e.length}function o(e){return A.call(e,function(e){return null!=e})}function l(e){return e.length>0?_.fn.concat.apply([],e):e
}function u(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function c(e){return e in D?D[e]:D[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function d(e,t){return"number"!=typeof t||L[u(e)]?t:t+"px"}function h(e){var t,i;return E[e]||(t=I.createElement(e),I.body.appendChild(t),i=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==i&&(i="block"),E[e]=i),E[e]}function p(e){return"children"in e?T.call(e.children):_.map(e.childNodes,function(e){return 1==e.nodeType?e:void 0
})}function f(e,t,i){for(S in t)i&&(s(t[S])||G(t[S]))?(s(t[S])&&!s(e[S])&&(e[S]={}),G(t[S])&&!G(e[S])&&(e[S]=[]),f(e[S],t[S],i)):t[S]!==w&&(e[S]=t[S])}function m(e,t){return null==t?_(e):_(e).filter(t)}function g(e,i,n,r){return t(i)?i.call(e,n,r):i}function v(e,t,i){null==i?e.removeAttribute(t):e.setAttribute(t,i)}function y(e,t){var i=e.className,n=i&&i.baseVal!==w;return t===w?n?i.baseVal:i:void(n?i.baseVal=t:e.className=t)}function b(e){var t;try{return e?"true"==e||("false"==e?!1:"null"==e?null:/^0/.test(e)||isNaN(t=Number(e))?/^[\[\{]/.test(e)?_.parseJSON(e):e:t):e
}catch(i){return e}}function x(e,t){t(e);for(var i in e.childNodes)x(e.childNodes[i],t)}var w,S,_,k,P,M,C=[],T=C.slice,A=C.filter,I=window.document,E={},D={},L={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},R=/^\s*<(\w+|!)[^>]*>/,O=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,j=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,B=/^(?:body|html)$/i,U=/([A-Z])/g,N=["val","css","html","text","data","width","height","offset"],H=["after","prepend","before","append"],F=I.createElement("table"),V=I.createElement("tr"),z={tr:I.createElement("tbody"),tbody:F,thead:F,tfoot:F,td:V,th:V,"*":I.createElement("div")},q=/complete|loaded|interactive/,Q=/^[\w-]*$/,$={},X=$.toString,W={},Y=I.createElement("div"),K={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},G=Array.isArray||function(e){return e instanceof Array
};return W.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var i=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(i)return i.call(e,t);var n,r=e.parentNode,s=!r;return s&&(r=Y).appendChild(e),n=~W.qsa(r,t).indexOf(e),s&&Y.removeChild(e),n},P=function(e){return e.replace(/-+(.)?/g,function(e,t){return t?t.toUpperCase():""})},M=function(e){return A.call(e,function(t,i){return e.indexOf(t)==i})},W.fragment=function(e,t,i){var n,r,a;return O.test(e)&&(n=_(I.createElement(RegExp.$1))),n||(e.replace&&(e=e.replace(j,"<$1></$2>")),t===w&&(t=R.test(e)&&RegExp.$1),t in z||(t="*"),a=z[t],a.innerHTML=""+e,n=_.each(T.call(a.childNodes),function(){a.removeChild(this)
})),s(i)&&(r=_(n),_.each(i,function(e,t){N.indexOf(e)>-1?r[e](t):r.attr(e,t)})),n},W.Z=function(e,t){return e=e||[],e.__proto__=_.fn,e.selector=t||"",e},W.isZ=function(e){return e instanceof W.Z},W.init=function(e,i){var n;if(!e)return W.Z();if("string"==typeof e)if(e=e.trim(),"<"==e[0]&&R.test(e))n=W.fragment(e,RegExp.$1,i),e=null;else{if(i!==w)return _(i).find(e);n=W.qsa(I,e)}else{if(t(e))return _(I).ready(e);if(W.isZ(e))return e;if(G(e))n=o(e);else if(r(e))n=[e],e=null;else if(R.test(e))n=W.fragment(e.trim(),RegExp.$1,i),e=null;
else{if(i!==w)return _(i).find(e);n=W.qsa(I,e)}}return W.Z(n,e)},_=function(e,t){return W.init(e,t)},_.extend=function(e){var t,i=T.call(arguments,1);return"boolean"==typeof e&&(t=e,e=i.shift()),i.forEach(function(i){f(e,i,t)}),e},W.qsa=function(e,t){var i,r="#"==t[0],s=!r&&"."==t[0],a=r||s?t.slice(1):t,o=Q.test(a);return n(e)&&o&&r?(i=e.getElementById(a))?[i]:[]:1!==e.nodeType&&9!==e.nodeType?[]:T.call(o&&!r?s?e.getElementsByClassName(a):e.getElementsByTagName(t):e.querySelectorAll(t))},_.contains=function(e,t){return e!==t&&e.contains(t)
},_.type=e,_.isFunction=t,_.isWindow=i,_.isArray=G,_.isPlainObject=s,_.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},_.inArray=function(e,t,i){return C.indexOf.call(t,e,i)},_.camelCase=P,_.trim=function(e){return null==e?"":String.prototype.trim.call(e)},_.uuid=0,_.support={},_.expr={},_.map=function(e,t){var i,n,r,s=[];if(a(e))for(n=0;n<e.length;n++)i=t(e[n],n),null!=i&&s.push(i);else for(r in e)i=t(e[r],r),null!=i&&s.push(i);return l(s)},_.each=function(e,t){var i,n;if(a(e)){for(i=0;i<e.length;i++)if(t.call(e[i],i,e[i])===!1)return e
}else for(n in e)if(t.call(e[n],n,e[n])===!1)return e;return e},_.grep=function(e,t){return A.call(e,t)},window.JSON&&(_.parseJSON=JSON.parse),_.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){$["[object "+t+"]"]=t.toLowerCase()}),_.fn={forEach:C.forEach,reduce:C.reduce,push:C.push,sort:C.sort,indexOf:C.indexOf,concat:C.concat,map:function(e){return _(_.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return _(T.apply(this,arguments))},ready:function(e){return q.test(I.readyState)&&I.body?e(_):I.addEventListener("DOMContentLoaded",function(){e(_)
},!1),this},get:function(e){return e===w?T.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(e){return C.every.call(this,function(t,i){return e.call(t,i,t)!==!1}),this},filter:function(e){return t(e)?this.not(this.not(e)):_(A.call(this,function(t){return W.matches(t,e)}))},add:function(e,t){return _(M(this.concat(_(e,t))))
},is:function(e){return this.length>0&&W.matches(this[0],e)},not:function(e){var i=[];if(t(e)&&e.call!==w)this.each(function(t){e.call(this,t)||i.push(this)});else{var n="string"==typeof e?this.filter(e):a(e)&&t(e.item)?T.call(e):_(e);this.forEach(function(e){n.indexOf(e)<0&&i.push(e)})}return _(i)},has:function(e){return this.filter(function(){return r(e)?_.contains(this,e):_(this).find(e).size()})},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!r(e)?e:_(e)
},last:function(){var e=this[this.length-1];return e&&!r(e)?e:_(e)},find:function(e){var t,i=this;return t="object"==typeof e?_(e).filter(function(){var e=this;return C.some.call(i,function(t){return _.contains(t,e)})}):1==this.length?_(W.qsa(this[0],e)):this.map(function(){return W.qsa(this,e)})},closest:function(e,t){var i=this[0],r=!1;for("object"==typeof e&&(r=_(e));i&&!(r?r.indexOf(i)>=0:W.matches(i,e));)i=i!==t&&!n(i)&&i.parentNode;return _(i)},parents:function(e){for(var t=[],i=this;i.length>0;)i=_.map(i,function(e){return(e=e.parentNode)&&!n(e)&&t.indexOf(e)<0?(t.push(e),e):void 0
});return m(t,e)},parent:function(e){return m(M(this.pluck("parentNode")),e)},children:function(e){return m(this.map(function(){return p(this)}),e)},contents:function(){return this.map(function(){return T.call(this.childNodes)})},siblings:function(e){return m(this.map(function(e,t){return A.call(p(t.parentNode),function(e){return e!==t})}),e)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(e){return _.map(this,function(t){return t[e]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=h(this.nodeName))
})},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var i=t(e);if(this[0]&&!i)var n=_(e).get(0),r=n.parentNode||this.length>1;return this.each(function(t){_(this).wrapAll(i?e.call(this,t):r?n.cloneNode(!0):n)})},wrapAll:function(e){if(this[0]){_(this[0]).before(e=_(e));for(var t;(t=e.children()).length;)e=t.first();_(e).append(this)}return this},wrapInner:function(e){var i=t(e);return this.each(function(t){var n=_(this),r=n.contents(),s=i?e.call(this,t):e;r.length?r.wrapAll(s):n.append(s)
})},unwrap:function(){return this.parent().each(function(){_(this).replaceWith(_(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(e){return this.each(function(){var t=_(this);(e===w?"none"==t.css("display"):e)?t.show():t.hide()})},prev:function(e){return _(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return _(this.pluck("nextElementSibling")).filter(e||"*")
},html:function(e){return 0===arguments.length?this.length>0?this[0].innerHTML:null:this.each(function(t){var i=this.innerHTML;_(this).empty().append(g(this,e,t,i))})},text:function(e){return 0===arguments.length?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=e===w?"":""+e})},attr:function(e,t){var i;return"string"==typeof e&&t===w?0==this.length||1!==this[0].nodeType?w:"value"==e&&"INPUT"==this[0].nodeName?this.val():!(i=this[0].getAttribute(e))&&e in this[0]?this[0][e]:i:this.each(function(i){if(1===this.nodeType)if(r(e))for(S in e)v(this,S,e[S]);
else v(this,e,g(this,t,i,this.getAttribute(e)))})},removeAttr:function(e){return this.each(function(){1===this.nodeType&&v(this,e)})},prop:function(e,t){return e=K[e]||e,t===w?this[0]&&this[0][e]:this.each(function(i){this[e]=g(this,t,i,this[e])})},data:function(e,t){var i=this.attr("data-"+e.replace(U,"-$1").toLowerCase(),t);return null!==i?b(i):w},val:function(e){return 0===arguments.length?this[0]&&(this[0].multiple?_(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value):this.each(function(t){this.value=g(this,e,t,this.value)
})},offset:function(e){if(e)return this.each(function(t){var i=_(this),n=g(this,e,t,i.offset()),r=i.offsetParent().offset(),s={top:n.top-r.top,left:n.left-r.left};"static"==i.css("position")&&(s.position="relative"),i.css(s)});if(0==this.length)return null;var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,i){if(arguments.length<2){var n=this[0],r=getComputedStyle(n,"");if(!n)return;
if("string"==typeof t)return n.style[P(t)]||r.getPropertyValue(t);if(G(t)){var s={};return _.each(G(t)?t:[t],function(e,t){s[t]=n.style[P(t)]||r.getPropertyValue(t)}),s}}var a="";if("string"==e(t))i||0===i?a=u(t)+":"+d(t,i):this.each(function(){this.style.removeProperty(u(t))});else for(S in t)t[S]||0===t[S]?a+=u(S)+":"+d(S,t[S])+";":this.each(function(){this.style.removeProperty(u(S))});return this.each(function(){this.style.cssText+=";"+a})},index:function(e){return e?this.indexOf(_(e)[0]):this.parent().children().indexOf(this[0])
},hasClass:function(e){return e?C.some.call(this,function(e){return this.test(y(e))},c(e)):!1},addClass:function(e){return e?this.each(function(t){k=[];var i=y(this),n=g(this,e,t,i);n.split(/\s+/g).forEach(function(e){_(this).hasClass(e)||k.push(e)},this),k.length&&y(this,i+(i?" ":"")+k.join(" "))}):this},removeClass:function(e){return this.each(function(t){return e===w?y(this,""):(k=y(this),g(this,e,t,k).split(/\s+/g).forEach(function(e){k=k.replace(c(e)," ")}),void y(this,k.trim()))})},toggleClass:function(e,t){return e?this.each(function(i){var n=_(this),r=g(this,e,i,y(this));
r.split(/\s+/g).forEach(function(e){(t===w?!n.hasClass(e):t)?n.addClass(e):n.removeClass(e)})}):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===w?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===w?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)
})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),i=this.offset(),n=B.test(t[0].nodeName)?{top:0,left:0}:t.offset();return i.top-=parseFloat(_(e).css("margin-top"))||0,i.left-=parseFloat(_(e).css("margin-left"))||0,n.top+=parseFloat(_(t[0]).css("border-top-width"))||0,n.left+=parseFloat(_(t[0]).css("border-left-width"))||0,{top:i.top-n.top,left:i.left-n.left}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||I.body;e&&!B.test(e.nodeName)&&"static"==_(e).css("position");)e=e.offsetParent;
return e})}},_.fn.detach=_.fn.remove,["width","height"].forEach(function(e){var t=e.replace(/./,function(e){return e[0].toUpperCase()});_.fn[e]=function(r){var s,a=this[0];return r===w?i(a)?a["inner"+t]:n(a)?a.documentElement["scroll"+t]:(s=this.offset())&&s[e]:this.each(function(t){a=_(this),a.css(e,g(this,r,t,a[e]()))})}}),H.forEach(function(t,i){var n=i%2;_.fn[t]=function(){var t,r,s=_.map(arguments,function(i){return t=e(i),"object"==t||"array"==t||null==i?i:W.fragment(i)}),a=this.length>1;return s.length<1?this:this.each(function(e,t){r=n?t:t.parentNode,t=0==i?t.nextSibling:1==i?t.firstChild:2==i?t:null,s.forEach(function(e){if(a)e=e.cloneNode(!0);
else if(!r)return _(e).remove();x(r.insertBefore(e,t),function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)})})})},_.fn[n?t+"To":"insert"+(i?"Before":"After")]=function(e){return _(e)[t](this),this}}),W.Z.prototype=_.fn,W.uniq=M,W.deserializeValue=b,_.zepto=W,_}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(e){function t(i){var n=[["resolve","done",e.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",e.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",e.Callbacks({memory:1})]],r="pending",s={state:function(){return r
},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var i=arguments;return t(function(t){e.each(n,function(n,r){var o=e.isFunction(i[n])&&i[n];a[r[1]](function(){var i=o&&o.apply(this,arguments);if(i&&e.isFunction(i.promise))i.promise().done(t.resolve).fail(t.reject).progress(t.notify);else{var n=this===s?t.promise():this,a=o?[i]:arguments;t[r[0]+"With"](n,a)}})}),i=null}).promise()},promise:function(t){return null!=t?e.extend(t,s):s}},a={};return e.each(n,function(e,t){var i=t[2],o=t[3];
s[t[1]]=i.add,o&&i.add(function(){r=o},n[1^e][2].disable,n[2][2].lock),a[t[0]]=function(){return a[t[0]+"With"](this===a?s:this,arguments),this},a[t[0]+"With"]=i.fireWith}),s.promise(a),i&&i.call(a,a),a}var i=Array.prototype.slice;e.when=function(n){var r,s,a,o=i.call(arguments),l=o.length,u=0,c=1!==l||n&&e.isFunction(n.promise)?l:0,d=1===c?n:t(),h=function(e,t,n){return function(s){t[e]=this,n[e]=arguments.length>1?i.call(arguments):s,n===r?d.notifyWith(t,n):--c||d.resolveWith(t,n)}};if(l>1)for(r=new Array(l),s=new Array(l),a=new Array(l);l>u;++u)o[u]&&e.isFunction(o[u].promise)?o[u].promise().done(h(u,a,o)).fail(d.reject).progress(h(u,s,r)):--c;
return c||d.resolveWith(a,o),d.promise()},e.Deferred=t}(Zepto),function(e){e.Callbacks=function(t){t=e.extend({},t);var i,n,r,s,a,o,l=[],u=!t.once&&[],c=function(e){for(i=t.memory&&e,n=!0,o=s||0,s=0,a=l.length,r=!0;l&&a>o;++o)if(l[o].apply(e[0],e[1])===!1&&t.stopOnFalse){i=!1;break}r=!1,l&&(u?u.length&&c(u.shift()):i?l.length=0:d.disable())},d={add:function(){if(l){var n=l.length,o=function(i){e.each(i,function(e,i){"function"==typeof i?t.unique&&d.has(i)||l.push(i):i&&i.length&&"string"!=typeof i&&o(i)
})};o(arguments),r?a=l.length:i&&(s=n,c(i))}return this},remove:function(){return l&&e.each(arguments,function(t,i){for(var n;(n=e.inArray(i,l,n))>-1;)l.splice(n,1),r&&(a>=n&&--a,o>=n&&--o)}),this},has:function(t){return!(!l||!(t?e.inArray(t,l)>-1:l.length))},empty:function(){return a=l.length=0,this},disable:function(){return l=u=i=void 0,this},disabled:function(){return!l},lock:function(){return u=void 0,i||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],r?u.push(t):c(t)),this
},fire:function(){return d.fireWith(this,arguments)},fired:function(){return!!n}};return d}}(Zepto),function(e){function t(t,i,n){var r=e.Event(i);return e(t).trigger(r,n),!r.isDefaultPrevented()}function i(e,i,n,r){return e.global?t(i||y,n,r):void 0}function n(t){t.global&&0===e.active++&&i(t,null,"ajaxStart")}function r(t){t.global&&!--e.active&&i(t,null,"ajaxStop")}function s(e,t){var n=t.context;return t.beforeSend.call(n,e,t)===!1||i(t,n,"ajaxBeforeSend",[e,t])===!1?!1:void i(t,n,"ajaxSend",[e,t])
}function a(e,t,n,r){var s=n.context,a="success";n.success.call(s,e,a,t),r&&r.resolveWith(s,[e,a,t]),i(n,s,"ajaxSuccess",[t,n,e]),l(a,t,n)}function o(e,t,n,r,s){var a=r.context;r.error.call(a,n,t,e),s&&s.rejectWith(a,[n,t,e]),i(r,a,"ajaxError",[n,r,e||t]),l(t,n,r)}function l(e,t,n){var s=n.context;n.complete.call(s,t,e),i(n,s,"ajaxComplete",[t,n]),r(n)}function u(){}function c(e){return e&&(e=e.split(";",2)[0]),e&&(e==_?"html":e==S?"json":x.test(e)?"script":w.test(e)&&"xml")||"text"}function d(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")
}function h(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=d(t.url,t.data),t.data=void 0)}function p(t,i,n,r){var s=!e.isFunction(i);return{url:t,data:s?i:void 0,success:s?e.isFunction(n)?n:void 0:i,dataType:s?r||n:n}}function f(t,i,n,r){var s,a=e.isArray(i),o=e.isPlainObject(i);e.each(i,function(i,l){s=e.type(l),r&&(i=n?r:r+"["+(o||"object"==s||"array"==s?i:"")+"]"),!r&&a?t.add(l.name,l.value):"array"==s||!n&&"object"==s?f(t,l,n,i):t.add(i,l)
})}var m,g,v=0,y=window.document,b=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,x=/^(?:text|application)\/javascript/i,w=/^(?:text|application)\/xml/i,S="application/json",_="text/html",k=/^\s*$/;e.active=0,e.ajaxJSONP=function(t,i){if(!("type"in t))return e.ajax(t);var n,r,l=t.jsonpCallback,u=(e.isFunction(l)?l():l)||"jsonp"+ ++v,c=y.createElement("script"),d=window[u],h=function(t){e(c).triggerHandler("error",t||"abort")},p={abort:h};return i&&i.promise(p),e(c).on("load error",function(s,l){clearTimeout(r),e(c).off().remove(),"error"!=s.type&&n?a(n[0],p,t,i):o(null,l||"error",p,t,i),window[u]=d,n&&e.isFunction(d)&&d(n[0]),d=n=void 0
}),s(p,t)===!1?(h("abort"),p):(window[u]=function(){n=arguments},c.src=t.url.replace(/\?(.+)=\?/,"?$1="+u),y.head.appendChild(c),t.timeout>0&&(r=setTimeout(function(){h("timeout")},t.timeout)),p)},e.ajaxSettings={type:"GET",beforeSend:u,success:u,error:u,complete:u,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:S,xml:"application/xml, text/xml",html:_,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(t){var i=e.extend({},t||{}),r=e.Deferred&&e.Deferred();
for(m in e.ajaxSettings)void 0===i[m]&&(i[m]=e.ajaxSettings[m]);n(i),i.crossDomain||(i.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(i.url)&&RegExp.$2!=window.location.host),i.url||(i.url=window.location.toString()),h(i),i.cache===!1&&(i.url=d(i.url,"_="+Date.now()));var l=i.dataType,p=/\?.+=\?/.test(i.url);if("jsonp"==l||p)return p||(i.url=d(i.url,i.jsonp?i.jsonp+"=?":i.jsonp===!1?"":"callback=?")),e.ajaxJSONP(i,r);var f,v=i.accepts[l],y={},b=function(e,t){y[e.toLowerCase()]=[e,t]},x=/^([\w-]+:)\/\//.test(i.url)?RegExp.$1:window.location.protocol,w=i.xhr(),S=w.setRequestHeader;
if(r&&r.promise(w),i.crossDomain||b("X-Requested-With","XMLHttpRequest"),b("Accept",v||"*/*"),(v=i.mimeType||v)&&(v.indexOf(",")>-1&&(v=v.split(",",2)[0]),w.overrideMimeType&&w.overrideMimeType(v)),(i.contentType||i.contentType!==!1&&i.data&&"GET"!=i.type.toUpperCase())&&b("Content-Type",i.contentType||"application/x-www-form-urlencoded"),i.headers)for(g in i.headers)b(g,i.headers[g]);if(w.setRequestHeader=b,w.onreadystatechange=function(){if(4==w.readyState){w.onreadystatechange=u,clearTimeout(f);
var t,n=!1;if(w.status>=200&&w.status<300||304==w.status||0==w.status&&"file:"==x){l=l||c(i.mimeType||w.getResponseHeader("content-type")),t=w.responseText;try{"script"==l?(1,eval)(t):"xml"==l?t=w.responseXML:"json"==l&&(t=k.test(t)?null:e.parseJSON(t))}catch(s){n=s}n?o(n,"parsererror",w,i,r):a(t,w,i,r)}else o(w.statusText||null,w.status?"error":"abort",w,i,r)}},s(w,i)===!1)return w.abort(),o(null,"abort",w,i,r),w;if(i.xhrFields)for(g in i.xhrFields)w[g]=i.xhrFields[g];var _="async"in i?i.async:!0;
w.open(i.type,i.url,_,i.username,i.password);for(g in y)S.apply(w,y[g]);return i.timeout>0&&(f=setTimeout(function(){w.onreadystatechange=u,w.abort(),o(null,"timeout",w,i,r)},i.timeout)),w.send(i.data?i.data:null),w},e.get=function(){return e.ajax(p.apply(null,arguments))},e.post=function(){var t=p.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=p.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,i,n){if(!this.length)return this;var r,s=this,a=t.split(/\s/),o=p(t,i,n),l=o.success;
return a.length>1&&(o.url=a[0],r=a[1]),o.success=function(t){s.html(r?e("<div>").html(t.replace(b,"")).find(r):t),l&&l.apply(s,arguments)},e.ajax(o),this};var P=encodeURIComponent;e.param=function(e,t){var i=[];return i.add=function(e,t){this.push(P(e)+"="+P(t))},f(i,e,t),i.join("&").replace(/%20/g,"+")}}(Zepto),function(e){function t(e){return e._zid||(e._zid=h++)}function i(e,i,s,a){if(i=n(i),i.ns)var o=r(i.ns);return(g[t(e)]||[]).filter(function(e){return!(!e||i.e&&e.e!=i.e||i.ns&&!o.test(e.ns)||s&&t(e.fn)!==t(s)||a&&e.sel!=a)
})}function n(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function r(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}function s(e,t){return e.del&&!y&&e.e in b||!!t}function a(e){return x[e]||y&&b[e]||e}function o(i,r,o,l,c,h,p){var f=t(i),m=g[f]||(g[f]=[]);r.split(/\s/).forEach(function(t){if("ready"==t)return e(document).ready(o);var r=n(t);r.fn=o,r.sel=c,r.e in x&&(o=function(t){var i=t.relatedTarget;return!i||i!==this&&!e.contains(this,i)?r.fn.apply(this,arguments):void 0
}),r.del=h;var f=h||o;r.proxy=function(e){if(e=u(e),!e.isImmediatePropagationStopped()){e.data=l;var t=f.apply(i,e._args==d?[e]:[e].concat(e._args));return t===!1&&(e.preventDefault(),e.stopPropagation()),t}},r.i=m.length,m.push(r),"addEventListener"in i&&i.addEventListener(a(r.e),r.proxy,s(r,p))})}function l(e,n,r,o,l){var u=t(e);(n||"").split(/\s/).forEach(function(t){i(e,t,r,o).forEach(function(t){delete g[u][t.i],"removeEventListener"in e&&e.removeEventListener(a(t.e),t.proxy,s(t,l))})})}function u(t,i){return(i||!t.isDefaultPrevented)&&(i||(i=t),e.each(k,function(e,n){var r=i[e];
t[e]=function(){return this[n]=w,r&&r.apply(i,arguments)},t[n]=S}),(i.defaultPrevented!==d?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(t.isDefaultPrevented=w)),t}function c(e){var t,i={originalEvent:e};for(t in e)_.test(t)||e[t]===d||(i[t]=e[t]);return u(i,e)}var d,h=(e.zepto.qsa,1),p=Array.prototype.slice,f=e.isFunction,m=function(e){return"string"==typeof e},g={},v={},y="onfocusin"in window,b={focus:"focusin",blur:"focusout"},x={mouseenter:"mouseover",mouseleave:"mouseout"};
v.click=v.mousedown=v.mouseup=v.mousemove="MouseEvents",e.event={add:o,remove:l},e.proxy=function(i,n){if(f(i)){var r=function(){return i.apply(n,arguments)};return r._zid=t(i),r}if(m(n))return e.proxy(i[n],i);throw new TypeError("expected function")},e.fn.bind=function(e,t,i){return this.on(e,t,i)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,i,n){return this.on(e,t,i,n,1)};var w=function(){return!0},S=function(){return!1},_=/^([A-Z]|returnValue$|layer[XY]$)/,k={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};
e.fn.delegate=function(e,t,i){return this.on(t,e,i)},e.fn.undelegate=function(e,t,i){return this.off(t,e,i)},e.fn.live=function(t,i){return e(document.body).delegate(this.selector,t,i),this},e.fn.die=function(t,i){return e(document.body).undelegate(this.selector,t,i),this},e.fn.on=function(t,i,n,r,s){var a,u,h=this;return t&&!m(t)?(e.each(t,function(e,t){h.on(e,i,n,t,s)}),h):(m(i)||f(r)||r===!1||(r=n,n=i,i=d),(f(n)||n===!1)&&(r=n,n=d),r===!1&&(r=S),h.each(function(d,h){s&&(a=function(e){return l(h,e.type,r),r.apply(this,arguments)
}),i&&(u=function(t){var n,s=e(t.target).closest(i,h).get(0);return s&&s!==h?(n=e.extend(c(t),{currentTarget:s,liveFired:h}),(a||r).apply(s,[n].concat(p.call(arguments,1)))):void 0}),o(h,t,r,n,i,u||a)}))},e.fn.off=function(t,i,n){var r=this;return t&&!m(t)?(e.each(t,function(e,t){r.off(e,i,t)}),r):(m(i)||f(n)||n===!1||(n=i,i=d),n===!1&&(n=S),r.each(function(){l(this,t,n,i)}))},e.fn.trigger=function(t,i){return t=m(t)||e.isPlainObject(t)?e.Event(t):u(t),t._args=i,this.each(function(){"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,i)
})},e.fn.triggerHandler=function(t,n){var r,s;return this.each(function(a,o){r=c(m(t)?e.Event(t):t),r._args=n,r.target=o,e.each(i(o,t.type||t),function(e,t){return s=t.proxy(r),r.isImmediatePropagationStopped()?!1:void 0})}),s},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.trigger(t)}}),["focus","blur"].forEach(function(t){e.fn[t]=function(e){return e?this.bind(t,e):this.each(function(){try{this[t]()
}catch(e){}}),this}}),e.Event=function(e,t){m(e)||(t=e,e=t.type);var i=document.createEvent(v[e]||"Events"),n=!0;if(t)for(var r in t)"bubbles"==r?n=!!t[r]:i[r]=t[r];return i.initEvent(e,n,!0),u(i)}}(Zepto),define("jquery",function(e){return function(){var t;return t||e.$}}(this)),define("plex/base/mixins/localizerMixin",["underscore","jquery","plex/base/utils/dispatcher"],function(e,t,i){var n={languages:{en:"en.json","en-GB":"en-GB.json",af:"af.json",my:"my.json",ca:"ca.json",cs:"cs.json",sr:"sr.json",da:"da.json",de:"de.json",et:"et.json",es:"es.json","es-419":"es-419.json",el:"el.json",fr:"fr.json",hr:"hr.json",is:"is.json",it:"it.json",lt:"lt.json",hu:"hu.json",nl:"nl.json",no:"no.json",pl:"pl.json",pt:"pt.json","pt-BR":"pt-BR.json",ru:"ru.json",ro:"ro.json",sk:"sk.json",sl:"sl.json",fi:"fi.json",sv:"sv.json",vi:"vi.json",tr:"tr.json",uk:"uk.json",bg:"bg.json",zh:"zh.json","zh-TW":"zh-TW.json",ja:"ja.json",ko:"ko.json",th:"th.json",fa:"fa.json",ar:"ar.json",he:"he.json"},getLanguages:function(){return this.languages
},load:function(n){if(this.language===n)return t.Deferred().resolve();if(!e.has(this.languages,n))return t.Deferred().reject();var r=this.language;if(this.language=n,e.has(this.translations,n))return i.trigger("change:language",n),t.Deferred().resolve();var s={dataType:"json",url:this.basePath+this.languages[this.language]},a=e.bind(function(e){this.translations[this.language]=e,i.trigger("change:language",this.language)},this),o=e.bind(function(){this.language=r},this);return t.ajax(s).done(a).fail(o)
},t:function(t){if(!t)return"";var i,n=1,r=arguments.length;e.isObject(arguments[r-1])&&(i=arguments[r-1],r-=1);var s=this.getTranslation(t)||t;for(i&&i.escape&&(s=e.escape(s));r>n;)s=s.replace("{"+n+"}",arguments[n]),n++;return s},getTranslation:function(e){return this.translations[this.language]?this.translations[this.language][e]:void 0}};return n}),define("plex/chromecast/adapters/castLocalizer",["plex/base/utils/BaseClass","plex/base/mixins/localizerMixin"],function(e,t){var i=e.extend({mixins:t,constructor:function(){this.translations={},this.language="en"
}});return new i}),define("plex/base/adapters/storageAdapter",["plex/base/adapters/Adapter"],function(e){var t=new e({"interface":["get","set","remove","clear"]});return t}),define("plex/base/adapters/webStorage",["jquery","plex/base/adapters/loggerAdapter"],function(e,t){function i(e){return e?window.sessionStorage:window.localStorage}function n(n,r){var s=i(r.session),a=e.Deferred();try{a.resolve(n(s))}catch(o){t.warn(o.message),a.reject(o)}return a.promise()}try{"string"==typeof localStorage.getItem&&delete localStorage.getItem,"string"==typeof localStorage.setItem&&delete localStorage.setItem,"string"==typeof localStorage.removeItem&&delete localStorage.removeItem,"string"==typeof localStorage.clear&&delete localStorage.clear
}catch(r){}var s={get:function(e){return n(function(t){var i=window.PLEXWEB,n=e.key,r=i&&n in i?i[n]:t.getItem(n);if(null==r){var s=e.session?"session":"local";throw new Error(n+" is not in "+s+" storage")}return r},e)},set:function(e){return n(function(t){return t.setItem(e.key,e.value)},e)},remove:function(e){return n(function(t){return t.removeItem(e.key)},e)},clear:function(e){return n(function(e){return e.clear()},e||{})}};return s}),define("plex/base/adapters/dimensionsAdapter",["plex/base/adapters/Adapter"],function(e){var t=new e({props:["X-Plex-Product","X-Plex-Version","X-Plex-Client-Identifier","X-Plex-Platform","X-Plex-Platform-Version","X-Plex-Device","X-Plex-Device-Name"]});
return t}),function(e,t){if("function"==typeof define&&define.amd)define("backbone-lib",["underscore","jquery","exports"],function(i,n,r){e.Backbone=t(e,r,i,n)});else if("undefined"!=typeof exports){var i=require("underscore");t(e,exports,i)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,i,n){{var r=e.Backbone,s=[],a=(s.push,s.slice);s.splice}t.VERSION="1.1.2",t.$=n,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var o=t.Events={on:function(e,t,i){if(!u(this,"on",e,[t,i])||!t)return this;
this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n.push({callback:t,context:i,ctx:i||this}),this},once:function(e,t,n){if(!u(this,"once",e,[t,n])||!t)return this;var r=this,s=i.once(function(){r.off(e,s),t.apply(this,arguments)});return s._callback=t,this.on(e,s,n)},off:function(e,t,n){var r,s,a,o,l,c,d,h;if(!this._events||!u(this,"off",e,[t,n]))return this;if(!e&&!t&&!n)return this._events=void 0,this;for(o=e?[e]:i.keys(this._events),l=0,c=o.length;c>l;l++)if(e=o[l],a=this._events[e]){if(this._events[e]=r=[],t||n)for(d=0,h=a.length;h>d;d++)s=a[d],(t&&t!==s.callback&&t!==s.callback._callback||n&&n!==s.context)&&r.push(s);
r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=a.call(arguments,1);if(!u(this,"trigger",e,t))return this;var i=this._events[e],n=this._events.all;return i&&c(i,t),n&&c(n,arguments),this},stopListening:function(e,t,n){var r=this._listeningTo;if(!r)return this;var s=!t&&!n;n||"object"!=typeof t||(n=this),e&&((r={})[e._listenId]=e);for(var a in r)e=r[a],e.off(t,n,this),(s||i.isEmpty(e._events))&&delete this._listeningTo[a];return this}},l=/\s+/,u=function(e,t,i,n){if(!i)return!0;
if("object"==typeof i){for(var r in i)e[t].apply(e,[r,i[r]].concat(n));return!1}if(l.test(i)){for(var s=i.split(l),a=0,o=s.length;o>a;a++)e[t].apply(e,[s[a]].concat(n));return!1}return!0},c=function(e,t){var i,n=-1,r=e.length,s=t[0],a=t[1],o=t[2];switch(t.length){case 0:for(;++n<r;)(i=e[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s);return;case 2:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s,a);return;case 3:for(;++n<r;)(i=e[n]).callback.call(i.ctx,s,a,o);return;default:for(;++n<r;)(i=e[n]).callback.apply(i.ctx,t);
return}},d={listenTo:"on",listenToOnce:"once"};i.each(d,function(e,t){o[t]=function(t,n,r){var s=this._listeningTo||(this._listeningTo={}),a=t._listenId||(t._listenId=i.uniqueId("l"));return s[a]=t,r||"object"!=typeof n||(r=this),t[e](n,r,this),this}}),o.bind=o.on,o.unbind=o.off,i.extend(t,o);var h=t.Model=function(e,t){var n=e||{};t||(t={}),this.cid=i.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(n=this.parse(n,t)||{}),n=i.defaults({},n,i.result(this,"defaults")),this.set(n,t),this.changed={},this.initialize.apply(this,arguments)
};i.extend(h.prototype,o,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return i.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,n){var r,s,a,o,l,u,c,d;if(null==e)return this;if("object"==typeof e?(s=e,n=t):(s={})[e]=t,n||(n={}),!this._validate(s,n))return!1;a=n.unset,l=n.silent,o=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=i.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);
for(r in s)t=s[r],i.isEqual(d[r],t)||o.push(r),i.isEqual(c[r],t)?delete this.changed[r]:this.changed[r]=t,a?delete d[r]:d[r]=t;if(!l){o.length&&(this._pending=n);for(var h=0,p=o.length;p>h;h++)this.trigger("change:"+o[h],this,d[o[h]],n)}if(u)return this;if(!l)for(;this._pending;)n=this._pending,this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,i.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var n in this.attributes)t[n]=void 0;
return this.set(t,i.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!i.isEmpty(this.changed):i.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?i.clone(this.changed):!1;var t,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var s in e)i.isEqual(r[s],t=e[s])||((n||(n={}))[s]=t);return n},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return i.clone(this._previousAttributes)
},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,n=e.success;return e.success=function(i){return t.set(t.parse(i,e),e)?(n&&n(t,i,e),void t.trigger("sync",t,i,e)):!1},B(this,e),this.sync("read",this,e)},save:function(e,t,n){var r,s,a,o=this.attributes;if(null==e||"object"==typeof e?(r=e,n=t):(r={})[e]=t,n=i.extend({validate:!0},n),r&&!n.wait){if(!this.set(r,n))return!1}else if(!this._validate(r,n))return!1;r&&n.wait&&(this.attributes=i.extend({},o,r)),void 0===n.parse&&(n.parse=!0);
var l=this,u=n.success;return n.success=function(e){l.attributes=o;var t=l.parse(e,n);return n.wait&&(t=i.extend(r||{},t)),i.isObject(t)&&!l.set(t,n)?!1:(u&&u(l,e,n),void l.trigger("sync",l,e,n))},B(this,n),s=this.isNew()?"create":n.patch?"patch":"update","patch"===s&&(n.attrs=r),a=this.sync(s,this,n),r&&n.wait&&(this.attributes=o),a},destroy:function(e){e=e?i.clone(e):{};var t=this,n=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(i){(e.wait||t.isNew())&&r(),n&&n(t,i,e),t.isNew()||t.trigger("sync",t,i,e)
},this.isNew())return e.success(),!1;B(this,e);var s=this.sync("delete",this,e);return e.wait||r(),s},url:function(){var e=i.result(this,"urlRoot")||i.result(this.collection,"url")||j();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},i.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;
e=i.extend({},this.attributes,e);var n=this.validationError=this.validate(e,t)||null;return n?(this.trigger("invalid",this,n,i.extend(t,{validationError:n})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];i.each(p,function(e){h.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.attributes),i[e].apply(i,t)}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,i.extend({silent:!0},t))
},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};i.extend(f.prototype,o,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,i.extend({merge:!1},t,g))},remove:function(e,t){var n=!i.isArray(e);e=n?[e]:i.clone(e),t||(t={});var r,s,a,o;for(r=0,s=e.length;s>r;r++)o=e[r]=this.get(e[r]),o&&(delete this._byId[o.id],delete this._byId[o.cid],a=this.indexOf(o),this.models.splice(a,1),this.length--,t.silent||(t.index=a,o.trigger("remove",o,this,t)),this._removeReference(o,t));
return n?e[0]:e},set:function(e,t){t=i.defaults({},t,m),t.parse&&(e=this.parse(e,t));var n=!i.isArray(e);e=n?e?[e]:[]:i.clone(e);var r,s,a,o,l,u,c,d=t.at,p=this.model,f=this.comparator&&null==d&&t.sort!==!1,g=i.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},x=t.add,w=t.merge,S=t.remove,_=!f&&x&&S?[]:!1;for(r=0,s=e.length;s>r;r++){if(l=e[r]||{},a=l instanceof h?o=l:l[p.prototype.idAttribute||"id"],u=this.get(a))S&&(b[u.cid]=!0),w&&(l=l===o?o.attributes:l,t.parse&&(l=u.parse(l,t)),u.set(l,t),f&&!c&&u.hasChanged(g)&&(c=!0)),e[r]=u;
else if(x){if(o=e[r]=this._prepareModel(l,t),!o)continue;v.push(o),this._addReference(o,t)}o=u||o,!_||!o.isNew()&&b[o.id]||_.push(o),b[o.id]=!0}if(S){for(r=0,s=this.length;s>r;++r)b[(o=this.models[r]).cid]||y.push(o);y.length&&this.remove(y,t)}if(v.length||_&&_.length)if(f&&(c=!0),this.length+=v.length,null!=d)for(r=0,s=v.length;s>r;r++)this.models.splice(d+r,0,v[r]);else{_&&(this.models.length=0);var k=_||v;for(r=0,s=k.length;s>r;r++)this.models.push(k[r])}if(c&&this.sort({silent:!0}),!t.silent){for(r=0,s=v.length;s>r;r++)(o=v[r]).trigger("add",o,this,t);
(c||_&&_.length)&&this.trigger("sort",this,t)}return n?e[0]:e},reset:function(e,t){t||(t={});for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n],t);return t.previousModels=this.models,this._reset(),e=this.add(e,i.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,i.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,i.extend({at:0},t))
},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return a.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return i.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var i in e)if(e[i]!==t.get(i))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");
return e||(e={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return i.invoke(this.models,"get",e)},fetch:function(e){e=e?i.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,n=this;return e.success=function(i){var r=e.reset?"reset":"set";n[r](i,e),t&&t(n,i,e),n.trigger("sync",n,i,e)},B(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?i.clone(t):{},!(e=this._prepareModel(e,t)))return!1;
t.wait||this.add(e,t);var n=this,r=t.success;return t.success=function(e,i){t.wait&&n.add(e,t),r&&r(e,i,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e;t=t?i.clone(t):{},t.collection=this;var n=new this.model(e,t);return n.validationError?(this.trigger("invalid",this,n.validationError,t),!1):n},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)
},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,i,n){("add"!==e&&"remove"!==e||i===this)&&("destroy"===e&&this.remove(t,n),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];
i.each(v,function(e){f.prototype[e]=function(){var t=a.call(arguments);return t.unshift(this.models),i[e].apply(i,t)}});var y=["groupBy","countBy","sortBy","indexBy"];i.each(y,function(e){f.prototype[e]=function(t,n){var r=i.isFunction(t)?t:function(e){return e.get(t)};return i[e](this.models,r,n)}});var b=t.View=function(e){this.cid=i.uniqueId("view"),e||(e={}),i.extend(this,i.pick(e,w)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},x=/^(\S+)\s*(.*)$/,w=["model","collection","el","id","attributes","className","tagName","events"];
i.extend(b.prototype,o,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,i){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=i.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var n=e[t];if(i.isFunction(n)||(n=this[e[t]]),n){var r=t.match(x),s=r[1],a=r[2];
n=i.bind(n,this),s+=".delegateEvents"+this.cid,""===a?this.$el.on(s,n):this.$el.on(s,a,n)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var e=i.extend({},i.result(this,"attributes"));this.id&&(e.id=i.result(this,"id")),this.className&&(e["class"]=i.result(this,"className"));var n=t.$("<"+i.result(this,"tagName")+">").attr(e);this.setElement(n,!1)}}}),t.sync=function(e,n,r){var s=_[e];
i.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var a={type:s,dataType:"json"};if(r.url||(a.url=i.result(n,"url")||j()),null!=r.data||!n||"create"!==e&&"update"!==e&&"patch"!==e||(a.contentType="application/json",a.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(a.contentType="application/x-www-form-urlencoded",a.data=a.data?{model:a.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){a.type="POST",r.emulateJSON&&(a.data._method=s);var o=r.beforeSend;
r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",s),o?o.apply(this,arguments):void 0}}"GET"===a.type||r.emulateJSON||(a.processData=!1),"PATCH"===a.type&&S&&(a.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=t.ajax(i.extend(a,r));return n.trigger("request",n,l,r),l};var S=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),_={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};
t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var k=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},P=/\((.*?)\)/g,M=/(\(\?)?:\w+/g,C=/\*\w+/g,T=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(k.prototype,o,{initialize:function(){},route:function(e,n,r){i.isRegExp(e)||(e=this._routeToRegExp(e)),i.isFunction(n)&&(r=n,n=""),r||(r=this[n]);var s=this;return t.history.route(e,function(i){var a=s._extractParameters(e,i);s.execute(r,a),s.trigger.apply(s,["route:"+n].concat(a)),s.trigger("route",n,a),t.history.trigger("route",s,n,a)
}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,i){return t.history.navigate(e,i),this},_bindRoutes:function(){if(this.routes){this.routes=i.result(this,"routes");for(var e,t=i.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(T,"\\$&").replace(P,"(?:$1)?").replace(M,function(e,t){return t?e:"([^/?]+)"}).replace(C,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var n=e.exec(t).slice(1);
return i.map(n,function(e,t){return t===n.length-1?e||null:e?decodeURIComponent(e):null})}});var A=t.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},I=/^[#\/]|\s+$/g,E=/^\/+|\/+$/g,D=/msie [\w.]+/,L=/\/$/,R=/#.*$/;A.started=!1,i.extend(A.prototype,o,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);
return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var i=this.root.replace(L,"");e.indexOf(i)||(e=e.slice(i.length))}else e=this.getHash();return e.replace(I,"")},start:function(e){if(A.started)throw new Error("Backbone.history has already been started");A.started=!0,this.options=i.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);
var n=this.getFragment(),r=document.documentMode,s=D.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace(E,"/"),s&&this._wantsHashChange){var a=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=a.hide().appendTo("body")[0].contentWindow,this.navigate(n)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;
var o=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&o.hash&&(this.fragment=this.getHash().replace(I,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),A.started=!1
},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!A.started)return!1;t&&t!==!0||(t={trigger:!!t});var i=this.root+(e=this.getFragment(e||""));
if(e=e.replace(R,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==i&&(i=i.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,i){if(i){var n=e.href.replace(/(javascript:|#).*$/,"");
e.replace(n+"#"+t)}else e.hash="#"+t}}),t.history=new A;var O=function(e,t){var n,r=this;n=e&&i.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,t);var s=function(){this.constructor=n};return s.prototype=r.prototype,n.prototype=new s,e&&i.extend(n.prototype,e),n.__super__=r.prototype,n};h.extend=f.extend=k.extend=b.extend=A.extend=O;var j=function(){throw new Error('A "url" property or function must be specified')},B=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)
}};return t}),define("plex/base/mixins/views/bindingsMixin",["underscore"],function(e){var t={bindToModel:function(){this.bindings&&e.each(e.keys(this.bindings),function(t){var i,n=this.bindings[t];if(i=n.model?this[n.model]:this[this.bindingsModel]||this.model){var r=n.modelListeners||[n.modelAttribute];e.each(r,function(r){var s={obj:i,name:"change:"+r,callback:e.bind(this.renderBinding,this,t,n,i)};this._bindingListeners||(this._bindingListeners=[]),this._bindingListeners.push(s),this.listenTo(s.obj,s.name,s.callback)
},this),this.renderBinding(t,n,i)}},this)},unbindFromModel:function(){this.bindings&&(e.each(this._bindingListeners,function(e){this.stopListening(e.obj,e.name,e.callback)},this),this._bindingListeners=null)},renderBinding:function(t,i,n){var r=this.$(t),s=i.formatter,a=!!i.isHtml,o=i.autohide,l=n.get(i.modelAttribute);if(s&&(l=s.call(this,l,r)),o){var u=e.isFunction(o)?o.call(this,l):l;r.toggleClass("hidden",!u)}i.manual||(!a&&e.isString(l)&&(l=e.escape(l)),r.html(l))}};return t}),define("backbone",["underscore","jquery","backbone-lib","plex/base/utils/BaseClass","plex/base/mixins/views/bindingsMixin"],function(e,t,i,n,r){i=i.noConflict();
var s=i.sync;return i.sync=function(i,n,r){var a=r.server||n.server||n;r.url||(n.syncUrl?r.url=e.result(n,"syncUrl"):n.url&&(r.url=e.result(n,"url"))),e.isObject(r.data)&&(r.data=t.param(r.data,!0)),e.defaults(r,{headers:{},dataType:"text",processData:!1,timeout:r.data&&r.data.indexOf("checkFiles=1")>-1?6e4:15e3}),e.isFunction(a.resolveUrl)&&(r.url=a.resolveUrl(r.url),"cloudsync"===a.get("platform")&&(r.url+=r.url.indexOf("?")>-1?"&":"?",r.url+="redirect=0"),e.extend(r.headers,a.getHeaders()));var o=s(i,n,r);
return o.fail(function(e){e.aborting||0!==e.status&&401!==e.status||a.trigger("error:connection",a)}),o},i.wrapError=function(e,t){var i=t.error;t.error=function(n){i&&i(e,n,t),e.trigger("error",e,n,t)}},e.extend(i.View.prototype,r),i.Model.extend=n.extend,i.Collection.extend=n.extend,i.Router.extend=n.extend,i.View.extend=n.extend,i.History.extend=n.extend,i}),define("plex/chromecast/models/castAppModel",["backbone"],function(e){var t=e.Model.extend({defaults:{version:"dev"}});return new t}),define("plex/chromecast/adapters/castDimensions",["plex/chromecast/models/castAppModel"],function(e){var t={"X-Plex-Product":"Plex Chromecast","X-Plex-Version":e.get("version"),"X-Plex-Client-Identifier":e.get("clientID"),"X-Plex-Platform":"Chromecast","X-Plex-Platform-Version":cast.receiver.VERSION,"X-Plex-Device":"Chromecast","X-Plex-Device-Name":"Chromecast"};
return e.on("change:clientID",function(e,i){t["X-Plex-Client-Identifier"]=i}),e.on("change:version",function(e,i){t["X-Plex-Version"]=i}),t}),define("plex/base/adapters/errorTrackerAdapter",["plex/base/adapters/Adapter"],function(e){var t=new e({"interface":["init","enable","disable","set","capture"]});return t}),function(e,t){function i(e,t){var i,n;t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),document.createEvent?(i=document.createEvent("HTMLEvents"),i.initEvent(e,!0,!0)):(i=document.createEventObject(),i.eventType=e);
for(n in t)u(t,n)&&(i[n]=t[n]);if(document.createEvent)document.dispatchEvent(i);else try{document.fireEvent("on"+i.eventType.toLowerCase(),i)}catch(r){}}function n(e){this.name="RavenConfigError",this.message=e}function r(e){var t=V.exec(e),i={},r=7;try{for(;r--;)i[F[r]]=t[r]||""}catch(s){throw new n("Invalid DSN: "+e)}if(i.pass)throw new n("Do not specify your private key in the DSN!");return i}function s(e){return"undefined"==typeof e}function a(e){return"function"==typeof e}function o(e){return"string"==typeof e
}function l(e){for(var t in e)return!1;return!0}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){var i,n;if(s(e.length))for(i in e)u(e,i)&&t.call(null,i,e[i]);else if(n=e.length)for(i=0;n>i;i++)t.call(null,i,e[i])}function d(){O="?sentry_version=4&sentry_client=raven-js/"+H.VERSION+"&sentry_key="+L}function h(e,t){var n=[];e.stack&&e.stack.length&&c(e.stack,function(e,t){var i=p(t);i&&n.push(i)}),i("handle",{stackInfo:e,options:t}),m(e.name,e.message,e.url,e.lineno,n,t)
}function p(e){if(e.url){var t,i={filename:e.url,lineno:e.line,colno:e.column,"function":e.func||"?"},n=f(e);if(n){var r=["pre_context","context_line","post_context"];for(t=3;t--;)i[r[t]]=n[t]}return i.in_app=!(!U.includePaths.test(i.filename)||/(Raven|TraceKit)\./.test(i["function"])||/raven\.(min\.)?js$/.test(i.filename)),i}}function f(e){if(e.context&&U.fetchContext){for(var t=e.context,i=~~(t.length/2),n=t.length,r=!1;n--;)if(t[n].length>300){r=!0;break}if(r){if(s(e.column))return;return[[],t[i].substr(e.column,50),[]]
}return[t.slice(0,i),t[i],t.slice(i+1)]}}function m(e,t,i,n,r,s){var a,o;t+="",("Error"!==e||t)&&(U.ignoreErrors.test(t)||(r&&r.length?(i=r[0].filename||i,r.reverse(),a={frames:r}):i&&(a={frames:[{filename:i,lineno:n,in_app:!0}]}),t=v(t,100),U.ignoreUrls&&U.ignoreUrls.test(i)||(!U.whitelistUrls||U.whitelistUrls.test(i))&&(o=n?t+" at "+n:t,b(g({exception:{type:e,value:t},stacktrace:a,culprit:i,message:o},s)))))}function g(e,t){return t?(c(t,function(t,i){e[t]=i}),e):e}function v(e,t){return e.length<=t?e:e.substr(0,t)+"\u2026"
}function y(){var e={url:document.location.href,headers:{"User-Agent":navigator.userAgent}};return document.referrer&&(e.headers.Referer=document.referrer),e}function b(e){w()&&(e=g({project:R,logger:U.logger,site:U.site,platform:"javascript",request:y()},e),e.tags=g(U.tags,e.tags),e.extra=g(U.extra,e.extra),l(e.tags)&&delete e.tags,l(e.extra)&&delete e.extra,D&&(e.user=D),a(U.dataCallback)&&(e=U.dataCallback(e)),(!a(U.shouldSendCallback)||U.shouldSendCallback(e))&&(I=e.event_id||(e.event_id=_()),x(e)))
}function x(e){var t=new Image,n=E+O+"&sentry_data="+encodeURIComponent(JSON.stringify(e));t.onload=function(){i("success",{data:e,src:n})},t.onerror=t.onabort=function(){i("failure",{data:e,src:n})},t.src=n}function w(){return B?E?!0:(k("error","Error: Raven has not been configured."),!1):!1}function S(e){for(var t,i=[],n=0,r=e.length;r>n;n++)t=e[n],o(t)?i.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&i.push(t.source);return new RegExp(i.join("|"),"i")}function _(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,i="x"==e?t:3&t|8;
return i.toString(16)})}function k(t,i){e.console&&console[t]&&H.debug&&console[t](i)}function P(){var t=e.RavenConfig;t&&H.config(t.dsn,t.config).install()}var M={remoteFetching:!1,collectWindowErrors:!0,linesOfContext:7},C=[].slice,T="?";M.wrap=function(e){function t(){try{return e.apply(this,arguments)}catch(t){throw M.report(t),t}}return t},M.report=function(){function i(e){o(),f.push(e)}function n(e){for(var t=f.length-1;t>=0;--t)f[t]===e&&f.splice(t,1)}function r(){l(),f=[]}function s(e,t){var i=null;
if(!t||M.collectWindowErrors){for(var n in f)if(u(f,n))try{f[n].apply(null,[e].concat(C.call(arguments,2)))}catch(r){i=r}if(i)throw i}}function a(e,t,i,n,r){var a=null;if(v)M.computeStackTrace.augmentStackTraceWithInitialElement(v,t,i,e),c();else if(r)a=M.computeStackTrace(r),s(a,!0);else{var o={url:t,line:i,column:n};o.func=M.computeStackTrace.guessFunctionName(o.url,o.line),o.context=M.computeStackTrace.gatherContext(o.url,o.line),a={message:e,url:document.location.href,stack:[o]},s(a,!0)}return h?h.apply(this,arguments):!1
}function o(){p||(h=e.onerror,e.onerror=a,p=!0)}function l(){p&&(e.onerror=h,p=!1,h=t)}function c(){var e=v,t=m;m=null,v=null,g=null,s.apply(null,[e,!1].concat(t))}function d(t,i){var n=C.call(arguments,1);if(v){if(g===t)return;c()}var r=M.computeStackTrace(t);if(v=r,g=t,m=n,e.setTimeout(function(){g===t&&c()},r.incomplete?2e3:0),i!==!1)throw t}var h,p,f=[],m=null,g=null,v=null;return d.subscribe=i,d.unsubscribe=n,d.uninstall=r,d}(),M.computeStackTrace=function(){function t(t){if(!M.remoteFetching)return"";
try{var i=function(){try{return new e.XMLHttpRequest}catch(t){return new e.ActiveXObject("Microsoft.XMLHTTP")}},n=i();return n.open("GET",t,!1),n.send(""),n.responseText}catch(r){return""}}function i(e){if(!o(e))return[];if(!u(w,e)){var i="";-1!==e.indexOf(document.domain)&&(i=t(e)),w[e]=i?i.split("\n"):[]}return w[e]}function n(e,t){var n,r=/function ([^(]*)\(([^)]*)\)/,a=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,o="",l=10,u=i(e);if(!u.length)return T;for(var c=0;l>c;++c)if(o=u[t-c]+o,!s(o)){if(n=a.exec(o))return n[1];
if(n=r.exec(o))return n[1]}return T}function r(e,t){var n=i(e);if(!n.length)return null;var r=[],a=Math.floor(M.linesOfContext/2),o=a+M.linesOfContext%2,l=Math.max(0,t-a-1),u=Math.min(n.length,t+o-1);t-=1;for(var c=l;u>c;++c)s(n[c])||r.push(n[c]);return r.length>0?r:null}function a(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,"\\$&")}function l(e){return a(e).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function c(e,t){for(var n,r,s=0,a=t.length;a>s;++s)if((n=i(t[s])).length&&(n=n.join("\n"),r=e.exec(n)))return{url:t[s],line:n.substring(0,r.index).split("\n").length,column:r.index-n.lastIndexOf("\n",r.index)-1};
return null}function d(e,t,n){var r,s=i(t),o=new RegExp("\\b"+a(e)+"\\b");return n-=1,s&&s.length>n&&(r=o.exec(s[n]))?r.index:null}function h(t){for(var i,n,r,s,o=[e.location.href],u=document.getElementsByTagName("script"),d=""+t,h=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,p=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/,f=0;f<u.length;++f){var m=u[f];m.src&&o.push(m.src)}if(r=h.exec(d)){var g=r[1]?"\\s+"+r[1]:"",v=r[2].split(",").join("\\s*,\\s*");
i=a(r[3]).replace(/;$/,";?"),n=new RegExp("function"+g+"\\s*\\(\\s*"+v+"\\s*\\)\\s*{\\s*"+i+"\\s*}")}else n=new RegExp(a(d).replace(/\s+/g,"\\s+"));if(s=c(n,o))return s;if(r=p.exec(d)){var y=r[1];if(i=l(r[2]),n=new RegExp("on"+y+"=[\\'\"]\\s*"+i+"\\s*[\\'\"]","i"),s=c(n,o[0]))return s;if(n=new RegExp(i),s=c(n,o))return s}return null}function p(e){if(!e.stack)return null;for(var t,i,a=/^\s*at (?:((?:\[object object\])?\S+(?: \[as \S+\])?) )?\(?((?:file|https?|chrome-extension):.*?):(\d+)(?::(\d+))?\)?\s*$/i,o=/^\s*(\S*)(?:\((.*?)\))?@((?:file|https?|chrome).*?):(\d+)(?::(\d+))?\s*$/i,l=e.stack.split("\n"),u=[],c=/^(.*) is undefined$/.exec(e.message),h=0,p=l.length;p>h;++h){if(t=o.exec(l[h]))i={url:t[3],func:t[1]||T,args:t[2]?t[2].split(","):"",line:+t[4],column:t[5]?+t[5]:null};
else{if(!(t=a.exec(l[h])))continue;i={url:t[2],func:t[1]||T,line:+t[3],column:t[4]?+t[4]:null}}!i.func&&i.line&&(i.func=n(i.url,i.line)),i.line&&(i.context=r(i.url,i.line)),u.push(i)}return u.length?(u[0].line&&!u[0].column&&c?u[0].column=d(c[1],u[0].url,u[0].line):u[0].column||s(e.columnNumber)||(u[0].column=e.columnNumber+1),{name:e.name,message:e.message,url:document.location.href,stack:u}):null}function f(e){for(var t,i=e.stacktrace,s=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,a=i.split("\n"),o=[],l=0,u=a.length;u>l;l+=2)if(t=s.exec(a[l])){var c={line:+t[1],column:+t[2],func:t[3]||t[4],args:t[5]?t[5].split(","):[],url:t[6]};
if(!c.func&&c.line&&(c.func=n(c.url,c.line)),c.line)try{c.context=r(c.url,c.line)}catch(d){}c.context||(c.context=[a[l+1]]),o.push(c)}return o.length?{name:e.name,message:e.message,url:document.location.href,stack:o}:null}function m(t){var s=t.message.split("\n");if(s.length<4)return null;var a,o,d,h,p=/^\s*Line (\d+) of linked script ((?:file|https?)\S+)(?:: in function (\S+))?\s*$/i,f=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|https?)\S+)(?:: in function (\S+))?\s*$/i,m=/^\s*Line (\d+) of function script\s*$/i,g=[],v=document.getElementsByTagName("script"),y=[];
for(o in v)u(v,o)&&!v[o].src&&y.push(v[o]);for(o=2,d=s.length;d>o;o+=2){var b=null;if(a=p.exec(s[o]))b={url:a[2],func:a[3],line:+a[1]};else if(a=f.exec(s[o])){b={url:a[3],func:a[4]};var x=+a[1],w=y[a[2]-1];if(w&&(h=i(b.url))){h=h.join("\n");var S=h.indexOf(w.innerText);S>=0&&(b.line=x+h.substring(0,S).split("\n").length)}}else if(a=m.exec(s[o])){var _=e.location.href.replace(/#.*$/,""),k=a[1],P=new RegExp(l(s[o+1]));h=c(P,[_]),b={url:_,line:h?h.line:k,func:""}}if(b){b.func||(b.func=n(b.url,b.line));
var M=r(b.url,b.line),C=M?M[Math.floor(M.length/2)]:null;b.context=M&&C.replace(/^\s*/,"")===s[o+1].replace(/^\s*/,"")?M:[s[o+1]],g.push(b)}}return g.length?{name:t.name,message:s[0],url:document.location.href,stack:g}:null}function g(e,t,i,s){var a={url:t,line:i};if(a.url&&a.line){e.incomplete=!1,a.func||(a.func=n(a.url,a.line)),a.context||(a.context=r(a.url,a.line));var o=/ '([^']+)' /.exec(s);if(o&&(a.column=d(o[1],a.url,a.line)),e.stack.length>0&&e.stack[0].url===a.url){if(e.stack[0].line===a.line)return!1;
if(!e.stack[0].line&&e.stack[0].func===a.func)return e.stack[0].line=a.line,e.stack[0].context=a.context,!1}return e.stack.unshift(a),e.partial=!0,!0}return e.incomplete=!0,!1}function v(e,t){for(var i,r,s,a=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,o=[],l={},u=!1,c=v.caller;c&&!u;c=c.caller)if(c!==y&&c!==M.report){if(r={url:null,func:T,line:null,column:null},c.name?r.func=c.name:(i=a.exec(c.toString()))&&(r.func=i[1]),s=h(c)){r.url=s.url,r.line=s.line,r.func===T&&(r.func=n(r.url,r.line));
var p=/ '([^']+)' /.exec(e.message||e.description);p&&(r.column=d(p[1],s.url,s.line))}l[""+c]?u=!0:l[""+c]=!0,o.push(r)}t&&o.splice(0,t);var f={name:e.name,message:e.message,url:document.location.href,stack:o};return g(f,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),f}function y(e,t){var i=null;t=null==t?0:+t;try{if(i=f(e))return i}catch(n){if(x)throw n}try{if(i=p(e))return i}catch(n){if(x)throw n}try{if(i=m(e))return i}catch(n){if(x)throw n}try{if(i=v(e,t+1))return i}catch(n){if(x)throw n
}return{}}function b(e){e=(null==e?0:+e)+1;try{throw new Error}catch(t){return y(t,e+1)}}var x=!1,w={};return y.augmentStackTraceWithInitialElement=g,y.guessFunctionName=n,y.gatherContext=r,y.ofCaller=b,y}();var A,I,E,D,L,R,O,j=e.Raven,B=!(!e.JSON||!e.JSON.stringify),U={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],collectWindowErrors:!0,tags:{},extra:{}},N=!1,H={VERSION:"1.1.16",debug:!0,noConflict:function(){return e.Raven=j,H},config:function(e,t){if(E)return k("error","Error: Raven has already been configured"),H;
if(!e)return H;var i=r(e),n=i.path.lastIndexOf("/"),s=i.path.substr(1,n);return t&&c(t,function(e,t){U[e]=t}),U.ignoreErrors.push("Script error."),U.ignoreErrors.push("Script error"),U.ignoreErrors.push("Javascript error: Script error on line 0"),U.ignoreErrors.push("Javascript error: Script error. on line 0"),U.ignoreErrors=S(U.ignoreErrors),U.ignoreUrls=U.ignoreUrls.length?S(U.ignoreUrls):!1,U.whitelistUrls=U.whitelistUrls.length?S(U.whitelistUrls):!1,U.includePaths=S(U.includePaths),L=i.user,R=i.path.substr(n+1),E="//"+i.host+(i.port?":"+i.port:"")+"/"+s+"api/"+R+"/store/",i.protocol&&(E=i.protocol+":"+E),U.fetchContext&&(M.remoteFetching=!0),U.linesOfContext&&(M.linesOfContext=U.linesOfContext),M.collectWindowErrors=!!U.collectWindowErrors,d(),H
},install:function(){return w()&&!N&&(M.report.subscribe(h),N=!0),H},context:function(e,i,n){return a(e)&&(n=i||[],i=e,e=t),H.wrap(e,i).apply(this,n)},wrap:function(e,i){function n(){for(var t=[],n=arguments.length,r=!e||e&&e.deep!==!1;n--;)t[n]=r?H.wrap(e,arguments[n]):arguments[n];try{return i.apply(this,t)}catch(s){throw H.captureException(s,e),s}}if(s(i)&&!a(e))return e;if(a(e)&&(i=e,e=t),!a(i))return i;if(i.__raven__)return i;for(var r in i)u(i,r)&&(n[r]=i[r]);return n.__raven__=!0,n.__inner__=i,n
},uninstall:function(){return M.report.uninstall(),N=!1,H},captureException:function(e,t){if(!(e instanceof Error))return H.captureMessage(e,t);A=e;try{M.report(e,t)}catch(i){if(e!==i)throw i}return H},captureMessage:function(e,t){return b(g({message:e+""},t)),H},setUserContext:function(e){return D=e,H},setExtraContext:function(e){return U.extra=e||{},H},setTagsContext:function(e){return U.tags=e||{},H},lastException:function(){return A},lastEventId:function(){return I}};H.setUser=H.setUserContext;
var F="source protocol user pass host port path".split(" "),V=/^(?:(\w+):)?\/\/(\w+)(:\w+)?@([\w\.-]+)(?::(\d+))?(\/.*)/;n.prototype=new Error,n.prototype.constructor=n,P(),e.Raven=H,"function"==typeof define&&define.amd&&define("raven",[],function(){return H})}(this),define("plex/base/adapters/analytics/sentryTracker",["raven"],function(e){var t={},i={init:function(t,i){e.config(t).install(),this.set("version",i)},enable:function(){e.install()},disable:function(){e.uninstall()},set:function(i,n){t[i]=n,e.setTagsContext(t)
},capture:function(t,i){e.captureException(t,i)}};return i}),define("plex/base/adapters/analyticsAdapter",["plex/base/adapters/Adapter"],function(e){var t=e.extend({"interface":["enable","disable","set","trackView","trackEvent"],register:function(e){this._Analytics=e},init:function(e,t){return this._instance=new this._Analytics(e,t),this._instance}});return new t}),function(){function e(e,t){return e.name=t}function t(e,t){return e.href=t}function i(e){yt.set(e)}function n(e){return"function"==typeof e
}function r(e){return void 0!=e&&-1<(e.constructor+"")[q]("String")}function s(){return j.round(2147483647*j.random())}function a(e){var t=_t[W]("img");return t.width=1,t.height=1,t.src=e,t}function o(){}function l(e){return L instanceof Function?L(e):(i(28),e)}function u(e){return l(e)[F](/\(/g,"%28")[F](/\)/g,"%29")}function c(e,t){if(e){var i=_t[W]("script");i.type="text/javascript",i.async=!0,i.src=e,i.id=t;var n=_t.getElementsByTagName("script")[0];n[mt].insertBefore(i,n)}}function d(){var e=""+_t[nt][rt];
return 0==e[q]("www.")?e[dt](4):e}function h(e){var t=_t.referrer;if(/^https?:\/\//i.test(t)){if(e)return t;e="//"+_t[nt][rt];var i=t[q](e);if((5==i||6==i)&&(e=t.charAt(i+e[Z]),"/"==e||"?"==e||""==e||":"==e))return;return t}}function p(e,t){if(1==t[Z]&&null!=t[0]&&"object"==typeof t[0])return t[0];for(var i={},n=j.min(e[Z]+1,t[Z]),r=0;n>r;r++){if("object"==typeof t[r]){for(var s in t[r])t[r].hasOwnProperty(s)&&(i[s]=t[r][s]);break}r<e[Z]&&(i[e[r]]=t[r])}return i}function f(e){if(100!=e.get(mn)&&D(Ft(e,rn))%1e4>=100*Vt(e,mn))throw"abort"
}function m(e){if(kt(Ft(e,sn)))throw"abort"}function g(){var e=_t[nt][lt];if("http:"!=e&&"https:"!=e)throw"abort"}function v(e){e.set(oi,Vt(e,oi)+1);var t=[];Nt.map(function(i,n){if(n.p){var r=e.get(i);void 0!=r&&r!=n[$]&&("boolean"==typeof r&&(r*=1),t[U](n.p+"="+l(""+r)))}}),t[U]("z="+s()),e.set(ai,t[gt]("&"),!0)}function y(e){Lt(Ft(e,ai),e.get(si)),e.set(si,o,!0)}function b(e){var t=St.gaData;t&&(t.expId&&e.set(Bi,t.expId),t.expVar&&e.set(Ui,t.expVar))}function x(){if(St[ft]&&"preview"==St[ft].loadPurpose)throw"abort"
}function w(e){var t=Vt(e,Vi);t>=500&&i(15);var n=Ft(e,ri);if("transaction"!=n&&"item"!=n){var n=Vt(e,qi),r=(new Date)[G](),s=Vt(e,zi);if(0==s&&e.set(zi,r),s=j.round(2*(r-s)/1e3),s>0&&(n=j.min(n+s,20),e.set(zi,r)),0>=n)throw"abort";e.set(qi,--n)}e.set(Vi,++t)}function S(){var e=Gn;_("create",e,e.create,3),_("getByName",e,e.j,5),_("getAll",e,e.K,6),e=Vn[et],_("get",e,e.get,7),_("set",e,e.set,4),_("send",e,e.send,2),e=Ut[et],_("get",e,e.get),_("set",e,e.set),(St.gaplugins=St.gaplugins||{}).Linker=Rn,e=Rn[et],Yn.C("linker",Rn),_("decorate",e,e.Q,20),_("autoLink",e,e.S,25),Yn.C("displayfeatures",Hn)
}function _(e,t,n,r){t[e]=function(){try{return r&&i(r),n[pt](this,arguments)}catch(t){var a=t&&t[K];if(!(1<=100*j.random()||kt("?"))){var o=["t=error","_e=exc","_v=j15","sr=1"];e&&o[U]("_f="+e),a&&o[U]("_m="+l(a[dt](0,100))),o[U]("aip=1"),o[U]("z="+s()),Lt(o[gt]("&"))}throw t}}}function k(){var e,t,i;if((i=(i=St[ft])?i.plugins:null)&&i[Z])for(var n=0;n<i[Z]&&!t;n++){var r=i[n];-1<r[K][q]("Shockwave Flash")&&(t=r.description)}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),t=e.GetVariable("$version")
}catch(s){}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),t="WIN 6,0,21,0",e.AllowScriptAccess="always",t=e.GetVariable("$version")}catch(a){}if(!t)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),t=e.GetVariable("$version")}catch(o){}return t&&(e=t[Q](/[\d]+/g))&&3<=e[Z]&&(t=e[0]+"."+e[1]+" r"+e[2]),t||void 0}function P(e,t,i){"none"==t&&(t="");var n=[],r=Mt(e);e="__utma"==e?6:2;for(var s=0;s<r[Z];s++){var a=(""+r[s])[it](".");a[Z]>=e&&n[U]({hash:a[0],R:r[s],O:a})}return 0==n[Z]?void 0:1==n[Z]?n[0]:M(t,n)||M(i,n)||M(null,n)||n[0]
}function M(e,t){var i,n;null==e?i=n=1:(i=D(e),n=D(0==e[q](".")?e[dt](1):"."+e));for(var r=0;r<t[Z];r++)if(t[r][N]==i||t[r][N]==n)return t[r]}function C(e){e=e.get(rn);var t=T(e,0);return"_ga=1."+l(t+"."+e)}function T(e,t){for(var i=new Date,n=St.screen||{},r=St[ft],s=r.plugins||[],i=[e,r.userAgent,n.width,n.height,i.getTimezoneOffset(),i.getYear(),i.getDate(),i.getHours(),i.getMinutes()+t],n=0;n<s[Z];++n)i[U](s[n].description);return D(i[gt]("."))}function A(e,t){if(t==_t[nt][rt])return!1;for(var i=0;i<e[Z];i++)if(0<=t[q](e[i]))return!0;
return!1}function I(){var e=St.gaGlobal=St.gaGlobal||{};return e.hid=e.hid||s()}function E(e){function i(e){var t=(e[rt]||"")[it](":")[0][vt](),i=(e[lt]||"")[vt](),i=1*e[X]||("http:"==i?80:"https:"==i?443:"");return e=e.pathname||"",0==e[q]("/")||(e="/"+e),[t,""+i,e]}var n=_t[W]("a");t(n,_t[nt][ct]);var r=(n[lt]||"")[vt](),s=i(n),a=n[st]||"",o=r+"//"+s[0]+(s[1]?":"+s[1]:"");return 0==e[q]("//")?e=r+e:0==e[q]("/")?e=o+e:e&&0!=e[q]("?")?0>e[it]("/")[0][q](":")&&(e=o+s[2][dt](0,s[2].lastIndexOf("/"))+"/"+e):e=o+s[2]+(e||a),t(n,e),r=i(n),{protocol:(n[lt]||"")[vt](),host:r[0],port:r[1],path:r[2],G:n[st]||"",url:e||""}
}function D(e){var t,i=1,n=0;if(e)for(i=0,t=e[Z]-1;t>=0;t--)n=e.charCodeAt(t),i=(i<<6&268435455)+n+(n<<14),n=266338304&i,i=0!=n?i^n>>21:i;return i}var L=encodeURIComponent,R=window,O=setTimeout,j=Math,B=RegExp,U="push",N="hash",H="slice",F="replace",V="data",z="cookie",q="indexOf",Q="match",$="defaultValue",X="port",W="createElement",Y="setAttribute",K="name",G="getTime",J="host",Z="length",et="prototype",tt="clientWidth",it="split",nt="location",rt="hostname",st="search",at="target",ot="call",lt="protocol",ut="clientHeight",ct="href",dt="substring",ht="action",pt="apply",ft="navigator",mt="parentNode",gt="join",vt="toLowerCase",yt=new function(){var e=[];
this.set=function(t){e[t]=!0},this.M=function(){for(var t=[],i=0;i<e[Z];i++)e[i]&&(t[j.floor(i/6)]=t[j.floor(i/6)]^1<<i%6);for(i=0;i<t[Z];i++)t[i]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(t[i]||0);return t[gt]("")+"~"}},bt=function(e,t,n,r){try{e.addEventListener?e.addEventListener(t,n,!!r):e.attachEvent&&e.attachEvent("on"+t,n)}catch(s){i(27)}},xt=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent&&e.detachEvent("on"+t,i)},wt=function(){this.keys=[],this.w={},this.m={}
};wt[et].set=function(e,t,i){this.keys[U](e),i?this.m[":"+e]=t:this.w[":"+e]=t},wt[et].get=function(e){return this.m.hasOwnProperty(":"+e)?this.m[":"+e]:this.w[":"+e]},wt[et].map=function(e){for(var t=0;t<this.keys[Z];t++){var i=this.keys[t],n=this.get(i);n&&e(i,n)}};var St=R,_t=document,kt=function(e){var t=St._gaUserPrefs;if(t&&t.ioo&&t.ioo()||e&&!0===St["ga-disable-"+e])return!0;try{var i=St.external;if(i&&i._gaUserPrefs&&"oo"==i._gaUserPrefs)return!0}catch(n){}return!1},Pt=function(e){O(e,100)
},Mt=function(e){var t=[],i=_t[z][it](";");e=B("^\\s*"+e+"=\\s*(.*?)\\s*$");for(var n=0;n<i[Z];n++){var r=i[n][Q](e);r&&t[U](r[1])}return t},Ct=function(e,t,n,r,s,a){if(s=kt(s)?!1:At.test(_t[nt][rt])||"/"==n&&Tt.test(r)?!1:!0,!s)return!1;if(t&&200<t[Z]&&(t=t[dt](0,200),i(24)),n=e+"="+t+"; path="+n+"; ",a&&(n+="expires="+new Date((new Date)[G]()+a).toGMTString()+"; "),r&&"none"!=r&&(n+="domain="+r+";"),r=_t[z],_t.cookie=n,!(r=r!=_t[z]))e:{for(e=Mt(e),r=0;r<e[Z];r++)if(t==e[r]){r=!0;break e}r=!1}return r
},Tt=B(/^(www\.)?google(\.com?)?(\.[a-z]{2})?$/),At=B(/(^|\.)doubleclick\.net$/i),It=function(){return(ei||"https:"==_t[nt][lt]?"https:":"http:")+"//www.google-analytics.com"},Et=function(t){e(this,"len"),this.message=t+"-8192"},Dt=function(t){e(this,"ff2post"),this.message=t+"-2036"},Lt=function(e,t){if(t=t||o,2036>=e[Z])Rt(e,t);else{if(!(8192>=e[Z]))throw new Et(e[Z]);var i=t;if(0<=St[ft].userAgent[q]("Firefox")&&![].reduce)throw new Dt(e[Z]);Ot(e,i)||jt(e,i)}},Rt=function(e,t){var i=a(It()+"/collect?"+e);
i.onload=i.onerror=function(){i.onload=null,i.onerror=null,t()}},Ot=function(e,t){var i,n=St.XDomainRequest;return n?(i=new n,i.open("POST",It()+"/collect")):(n=St.XMLHttpRequest)&&(n=new n,"withCredentials"in n&&(i=n,i.open("POST",It()+"/collect",!0),i.setRequestHeader("Content-Type","text/plain"))),i?(i.onreadystatechange=function(){4==i.readyState&&(t(),i=null)},i.send(e),!0):void 0},jt=function(t,i){if(_t.body){t=L(t);try{var n=_t[W]('<iframe name="'+t+'"></iframe>')}catch(r){n=_t[W]("iframe"),e(n,t)
}n.height="0",n.width="0",n.style.display="none",n.style.visibility="hidden";var s=_t[nt],s=It()+"/analytics_iframe.html#"+L(s[lt]+"//"+s[J]+"/favicon.ico"),a=function(){n.src="",n[mt]&&n[mt].removeChild(n)};bt(St,"beforeunload",a);var o=!1,l=0,u=function(){if(!o){try{if(l>9||n.contentWindow[nt][J]==_t[nt][J])return o=!0,a(),xt(St,"beforeunload",a),void i()}catch(e){}l++,O(u,200)}};bt(n,"load",u),_t.body.appendChild(n),n.src=s}else Pt(function(){jt(t,i)})},Bt=function(){this.t=[]};Bt[et].add=function(e){this.t[U](e)
},Bt[et].execute=function(e){try{for(var t=0;t<this.t[Z];t++){var i=e.get(this.t[t]);i&&n(i)&&i[ot](St,e)}}catch(r){}t=e.get(si),t!=o&&n(t)&&(e.set(si,o,!0),O(t,10))};var Ut=function(){this.data=new wt},Nt=new wt,Ht=[];Ut[et].get=function(e){var t=$t(e),i=this[V].get(e);return t&&void 0==i&&(i=n(t[$])?t[$]():t[$]),t&&t.n?t.n(this,e,i):i};var Ft=function(e,t){var i=e.get(t);return void 0==i?"":""+i},Vt=function(e,t){var i=e.get(t);return void 0==i||""===i?0:1*i};Ut[et].set=function(e,t,i){if(e)if("object"==typeof e)for(var n in e)e.hasOwnProperty(n)&&qt(this,n,e[n],i);
else qt(this,e,t,i)};var zt,qt=function(e,t,i,n){var r=$t(t);r&&r.o?r.o(e,t,i,n):e[V].set(t,i,n)},Qt=function(t,i,n,r,s){e(this,t),this.p=i,this.n=r,this.o=s,this.defaultValue=n},$t=function(e){var t=Nt.get(e);if(!t)for(var i=0;i<Ht[Z];i++){var n=Ht[i],r=n[0].exec(e);if(r){t=n[1](r),Nt.set(t[K],t);break}}return t},Xt=function(e){var t;return Nt.map(function(i,n){n.p==e&&(t=n)}),t&&t[K]},Wt=function(e,t,i,n,r){return e=new Qt(e,t,i,n,r),Nt.set(e[K],e),e[K]},Yt=function(e,t){Ht[U]([B("^"+e+"$"),t])
},Kt=function(e,t,i){return Wt(e,t,i,void 0,Gt)},Gt=function(){};if(zt=r(R.GoogleAnalyticsObject)){var Jt=R.GoogleAnalyticsObject;zt=Jt?Jt[F](/^[\s\xa0]+|[\s\xa0]+$/g,""):""}var Zt=zt||"ga",ei=!1,ti=Kt("apiVersion","v"),ii=Kt("clientVersion","_v");Wt("anonymizeIp","aip");var ni=Wt("adSenseId","a"),ri=Wt("hitType","t"),si=Wt("hitCallback"),ai=Wt("hitPayload");Wt("nonInteraction","ni"),Wt("currencyCode","cu"),Wt("sessionControl","sc",""),Wt("queueTime","qt");var oi=Wt("_s","_s");Wt("description","cd");
var li=Wt("location","dl",""),ui=Wt("referrer","dr"),ci=Wt("page","dp","");Wt("hostname","dh");var di=Wt("language","ul"),hi=Wt("encoding","de");Wt("title","dt",function(){return _t.title||void 0}),Yt("contentGroup([0-9]+)",function(e){return new Qt(e[0],"cg"+e[1])});var pi=Wt("screenColors","sd"),fi=Wt("screenResolution","sr"),mi=Wt("viewportSize","vp"),gi=Wt("javaEnabled","je"),vi=Wt("flashVersion","fl");Wt("campaignId","ci"),Wt("campaignName","cn"),Wt("campaignSource","cs"),Wt("campaignMedium","cm"),Wt("campaignKeyword","ck"),Wt("campaignContent","cc");
var yi=Wt("eventCategory","ec"),bi=Wt("eventAction","ea"),xi=Wt("eventLabel","el"),wi=Wt("eventValue","ev"),Si=Wt("socialNetwork","sn"),_i=Wt("socialAction","sa"),ki=Wt("socialTarget","st"),Pi=Wt("l1","plt"),Mi=Wt("l2","pdt"),Ci=Wt("l3","dns"),Ti=Wt("l4","rrt"),Ai=Wt("l5","srt"),Ii=Wt("l6","tcp"),Ei=Wt("l7","dit"),Di=Wt("l8","clt"),Li=Wt("timingCategory","utc"),Ri=Wt("timingVar","utv"),Oi=Wt("timingLabel","utl"),ji=Wt("timingValue","utt");Wt("appName","an"),Wt("appVersion","av",""),Wt("appId","aid",""),Wt("appInstallerId","aiid",""),Wt("exDescription","exd"),Wt("exFatal","exf");
var Bi=Wt("expId","xid"),Ui=Wt("expVar","xvar"),Ni=Wt("_utma","_utma"),Hi=Wt("_utmz","_utmz"),Fi=Wt("_utmht","_utmht"),Vi=Wt("_hc",void 0,0),zi=Wt("_ti",void 0,0),qi=Wt("_to",void 0,20);Yt("dimension([0-9]+)",function(e){return new Qt(e[0],"cd"+e[1])}),Yt("metric([0-9]+)",function(e){return new Qt(e[0],"cm"+e[1])}),Wt("linkerParam",void 0,void 0,C,Gt),Wt("usage","_u",void 0,function(){return yt.M()},Gt),Wt("forceSSL",void 0,void 0,function(){return ei},function(e,t,i){ei=!!i});var Qi=Wt("joinId","jid");
Yt("\\&(.*)",function(e){var t=new Qt(e[0],e[1]),i=Xt(e[0][dt](1));return i&&(t.n=function(e){return e.get(i)},t.o=function(e,t,n,r){e.set(i,n,r)},t.p=void 0),t});var $i=Kt("oot"),Xi=Wt("previewTask"),Wi=Wt("checkProtocolTask"),Yi=Wt("checkStorageTask"),Ki=Wt("historyImportTask"),Gi=Wt("samplerTask"),Ji=Kt("rateLimiterTask"),Zi=Wt("buildHitTask"),en=Wt("sendHitTask"),tn=Wt("ceTask"),nn=Kt("name"),rn=Kt("clientId","cid"),sn=Kt("trackingId","tid"),an=Kt("cookieName",void 0,"_ga"),on=Kt("cookieDomain"),ln=Kt("cookiePath",void 0,"/"),un=Kt("cookieExpires",void 0,63072e3),cn=Kt("legacyCookieDomain"),dn=Kt("legacyHistoryImport",void 0,!0),hn=Kt("storage",void 0,"cookie"),pn=Kt("allowLinker",void 0,!1),fn=Kt("allowAnchor",void 0,!0),mn=Kt("sampleRate","sf",100),gn=Kt("siteSpeedSampleRate",void 0,1),vn=Kt("alwaysSendReferrer",void 0,!1),yn=function(e,t){var i=j.min(Vt(e,gn),100);
if(!(D(Ft(e,rn))%100>=i)&&(i={},bn(i)||xn(i))){var n=i[Pi];void 0==n||1/0==n||isNaN(n)||(n>0?(wn(i,Ci),wn(i,Ii),wn(i,Ai),wn(i,Mi),wn(i,Ti),wn(i,Ei),wn(i,Di),t(i)):bt(St,"load",function(){yn(e,t)},!1))}},bn=function(e){var t=St.performance||St.webkitPerformance,t=t&&t.timing;if(!t)return!1;var i=t.navigationStart;return 0==i?!1:(e[Pi]=t.loadEventStart-i,e[Ci]=t.domainLookupEnd-t.domainLookupStart,e[Ii]=t.connectEnd-t.connectStart,e[Ai]=t.responseStart-t.requestStart,e[Mi]=t.responseEnd-t.responseStart,e[Ti]=t.fetchStart-i,e[Ei]=t.domInteractive-i,e[Di]=t.domContentLoadedEventStart-i,!0)
},xn=function(e){if(St.top!=St)return!1;var t=St.external,i=t&&t.onloadT;return t&&!t.isValidLoadTime&&(i=void 0),i>2147483648&&(i=void 0),i>0&&t.setPageReadyTime(),void 0==i?!1:(e[Pi]=i,!0)},wn=function(e,t){var i=e[t];(isNaN(i)||1/0==i||0>i)&&(e[t]=void 0)},Sn=!1,_n=function(e){if("cookie"==Ft(e,hn)){var t=Ft(e,an),n=Mn(e),r=In(Ft(e,ln)),s=Tn(Ft(e,on)),a=1e3*Vt(e,un),o=Ft(e,sn);if("auto"!=s)Ct(t,n,r,s,o,a)&&(Sn=!0);else{i(32);var l;if(n=[],s=d()[it]("."),4!=s[Z]||(l=s[s[Z]-1],parseInt(l,10)!=l)){for(l=s[Z]-2;l>=0;l--)n[U](s[H](l)[gt]("."));
n[U]("none"),l=n}else l=["none"];for(var u=0;u<l[Z];u++)if(s=l[u],e[V].set(on,s),n=Mn(e),Ct(t,n,r,s,o,a))return void(Sn=!0);e[V].set(on,"auto")}}},kn=function(e){if("cookie"==Ft(e,hn)&&!Sn&&(_n(e),!Sn))throw"abort"},Pn=function(e){if(e.get(dn)){var t=Ft(e,on),n=Ft(e,cn)||d(),r=P("__utma",n,t);r&&(i(19),e.set(Fi,(new Date)[G](),!0),e.set(Ni,r.R),(t=P("__utmz",n,t))&&r[N]==t[N]&&e.set(Hi,t.R))}},Mn=function(e){var t=u(Ft(e,rn)),i=An(Ft(e,on));return e=En(Ft(e,ln)),e>1&&(i+="-"+e),["GA1",i,t][gt](".")
},Cn=function(e,t,i){for(var n,r=[],s=[],a=0;a<e[Z];a++){var o=e[a];o.r[i]==t?r[U](o):void 0==n||o.r[i]<n?(s=[o],n=o.r[i]):o.r[i]==n&&s[U](o)}return 0<r[Z]?r:s},Tn=function(e){return 0==e[q](".")?e.substr(1):e},An=function(e){return Tn(e)[it](".")[Z]},In=function(e){return e?(1<e[Z]&&e.lastIndexOf("/")==e[Z]-1&&(e=e.substr(0,e[Z]-1)),0!=e[q]("/")&&(e="/"+e),e):"/"},En=function(e){return e=In(e),"/"==e?1:e[it]("/")[Z]},Dn=B(/^https?:\/\/([^\/:]+)/),Ln=/(.*)([?&#])(?:_ga=[^&]*)(?:&?)(.*)/,Rn=function(e){this.target=e,this.T=!1
};Rn[et].Q=function(e,i){if(e.tagName){if("a"==e.tagName[vt]())return void(e[ct]&&t(e,On(this,e[ct],i)));if("form"==e.tagName[vt]())return jn(this,e)}return"string"==typeof e?On(this,e,i):void 0};var On=function(e,t,i){var n=Ln.exec(t);n&&3<=n[Z]&&(t=n[1]+(n[3]?n[2]+n[3]:"")),e=e[at].get("linkerParam");var r=t[q]("?"),n=t[q]("#");return i?t+=(-1==n?"#":"&")+e:(i=-1==r?"?":"&",t=-1==n?t+(i+e):t[dt](0,n)+i+e+t[dt](n)),t},jn=function(e,t){if(t&&t[ht]){var i=e[at].get("linkerParam")[it]("=")[1];if("get"==t.method[vt]()){for(var n=t.childNodes||[],r=0;r<n[Z];r++)if("_ga"==n[r][K])return void n[r][Y]("value",i);
n=_t[W]("input"),n[Y]("type","hidden"),n[Y]("name","_ga"),n[Y]("value",i),t.appendChild(n)}else"post"==t.method[vt]()&&(t.action=On(e,t[ht]))}};Rn[et].S=function(e,n,r){function s(r){try{r=r||St.event;var s;e:{var o=r[at]||r.srcElement;for(r=100;o&&r>0;){if(o[ct]&&o.nodeName[Q](/^a(?:rea)?$/i)){s=o;break e}o=o[mt],r--}s={}}("http:"==s[lt]||"https:"==s[lt])&&A(e,s[rt]||"")&&s[ct]&&t(s,On(a,s[ct],n))}catch(l){i(26)}}var a=this;if(this.T||(this.T=!0,bt(_t,"mousedown",s,!1),bt(_t,"touchstart",s,!1),bt(_t,"keyup",s,!1)),r){r=function(t){if(t=t||St.event,(t=t[at]||t.srcElement)&&t[ht]){var i=t[ht][Q](Dn);
i&&A(e,i[1])&&jn(a,t)}};for(var o=0;o<_t.forms[Z];o++)bt(_t.forms[o],"submit",r)}};var Bn,Un=function(e){return e.get(nn)&&"t0"!=e.get(nn)?"_dc_"+u(e.get(nn)):"_dc"},Nn=function(e){if(e.get(Qi)){var t=new wt,i=function(i){t.set($t(i).p,e.get(i))};i(ti),i(ii),i(sn),i(rn),i(Qi);var n=Vt(e,"forceSSL")||"https:"==_t[nt][lt]?"https:":"http:",n=n+"//stats.g.doubleclick.net/collect?t=dc&aip=1&";t.map(function(e,t){n+=l(e)+"="+l(""+t)+"&"}),n+="z="+s(),a(n),e.set(Qi,"",!0)}},Hn=function(e){i(29),e=e.b;var t=e.get(Zi);
e.set(Zi,function(e){return e.get(Qi)||(-1!=_t[z][q](Un(e)+"=1")?e.set(Qi,"",!0):(Un(e),Ct(Un(e),"1",e.get(ln),e.get(on),e.get(sn),6e5)?e.set(Qi,""+s(),!0):i(30))),t(e)});var n=e.get(en);e.set(en,function(e){var t=n(e);return Nn(e),t})},Fn=function(e,t,i){if(!Bn){var n;n=_t[nt][N];var r=St[K],a=/^#?gaso=([^&]*)/;(r=(n=(n=n&&n[Q](a)||r&&r[Q](a))?n[1]:Mt("GASO")[0]||"")&&n[Q](/^(?:!([-0-9a-z.]{1,40})!)?([-.\w]{10,1200})$/i))&&(Ct("GASO",""+n,i,t,e,0),R._udo||(R._udo=t),R._utcp||(R._utcp=i),e=r[1],c("https://www.google.com/analytics/web/inpage/pub/inpage.js?"+(e?"prefix="+e+"&":"")+s(),"_gasojs")),Bn=!0
}},Vn=function(e){function t(e,t){n.b[V].set(e,t)}function i(e,i){t(e,i),n.filters.add(e)}var n=this;this.b=new Ut,this.filters=new Bt,t(nn,e[nn]),t(sn,e[sn]),t(an,e[an]),t(on,e[on]||d()),t(ln,e[ln]),t(un,e[un]),t(cn,e[cn]),t(dn,e[dn]),t(pn,e[pn]),t(fn,e[fn]),t(mn,e[mn]),t(gn,e[gn]),t(vn,e[vn]),t(hn,e[hn]),t(ti,1),t(ii,"j15"),i($i,m),i(Xi,x),i(Wi,g),i(Yi,kn),i(Ki,Pn),i(Gi,f),i(Ji,w),i(tn,b),i(Zi,v),i(en,y),zn(this.b,e[rn]),qn(this.b),this.b.set(ni,I()),Fn(this.b.get(sn),this.b.get(on),this.b.get(ln))
},zn=function(e,t){if("cookie"==Ft(e,hn)){Sn=!1;var n;e:{var r=Mt(Ft(e,an));if(r&&!(1>r[Z])){n=[];for(var a=0;a<r[Z];a++){var o;o=r[a][it](".");var u=o.shift();("GA1"==u||"1"==u)&&1<o[Z]?(u=o.shift()[it]("-"),1==u[Z]&&(u[1]="1"),u[0]*=1,u[1]*=1,o={r:u,s:o[gt](".")}):o=void 0,o&&n[U](o)}if(1==n[Z]){i(13),n=n[0].s;break e}if(0!=n[Z]){if(i(14),r=An(Ft(e,on)),n=Cn(n,r,0),1==n[Z]){n=n[0].s;break e}r=En(Ft(e,ln)),n=Cn(n,r,1),n=n[0]&&n[0].s;break e}i(12)}n=void 0}n||(n=Ft(e,on),r=Ft(e,cn)||d(),n=P("__utma",r,n),(n=void 0==n?void 0:n.O[1]+"."+n.O[2])&&i(10)),n&&(e[V].set(rn,n),Sn=!0)
}if(n=e.get(fn),(a=(n=_t[nt][n?"href":"search"][Q]("(?:&|#|\\?)"+l("_ga")[F](/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")+"=([^&#]*)"))&&2==n[Z]?n[1]:"")&&(e.get(pn)?(n=a[q]("."),-1==n?i(22):(r=a[dt](n+1),"1"!=a[dt](0,n)?i(22):(n=r[q]("."),-1==n?i(22):(a=r[dt](0,n),n=r[dt](n+1),a!=T(n,0)&&a!=T(n,-1)&&a!=T(n,-2)?i(23):(i(11),e[V].set(rn,n)))))):i(21)),t&&(i(9),e[V].set(rn,l(t))),!e.get(rn))if(n=(n=St.gaGlobal&&St.gaGlobal.vid)&&-1!=n[st](/^(?:utma\.)?\d+\.\d+$/)?n:void 0)i(17),e[V].set(rn,n);else{for(i(8),n=St[ft],n=n.appName+n.version+n.platform+n.userAgent+(_t[z]?_t[z]:"")+(_t.referrer?_t.referrer:""),r=n[Z],a=St.history[Z];a>0;)n+=a--^r++;
e[V].set(rn,[s()^2147483647&D(n),j.round((new Date)[G]()/1e3)][gt]("."))}_n(e)},qn=function(e){var t=St[ft],n=St.screen,r=_t[nt];if(e.set(ui,h(e.get(vn))),r){var s=r.pathname||"";"/"!=s.charAt(0)&&(i(31),s="/"+s),e.set(li,r[lt]+"//"+r[rt]+s+r[st])}n&&e.set(fi,n.width+"x"+n.height),n&&e.set(pi,n.colorDepth+"-bit");var n=_t.documentElement,a=(s=_t.body)&&s[tt]&&s[ut],o=[];if(n&&n[tt]&&n[ut]&&("CSS1Compat"===_t.compatMode||!a)?o=[n[tt],n[ut]]:a&&(o=[s[tt],s[ut]]),n=0>=o[0]||0>=o[1]?"":o[gt]("x"),e.set(mi,n),e.set(vi,k()),e.set(hi,_t.characterSet||_t.charset),e.set(gi,t&&"function"==typeof t.javaEnabled&&t.javaEnabled()||!1),e.set(di,(t&&(t.language||t.browserLanguage)||"")[vt]()),r&&e.get(fn)&&(t=_t[nt][N])){for(t=t[dt](1),t=t[it]("&"),r=[],n=0;n<t[Z];++n)0!=t[n][q]("utm_id")&&0!=t[n][q]("utm_campaign")&&0!=t[n][q]("utm_source")&&0!=t[n][q]("utm_medium")&&0!=t[n][q]("utm_term")&&0!=t[n][q]("utm_content")||r[U](t[n]);
0<r[Z]&&(t="#"+r[gt]("&"),e.set(li,e.get(li)+t))}};Vn[et].get=function(e){return this.b.get(e)},Vn[et].set=function(e,t){this.b.set(e,t)};var Qn={pageview:[ci],event:[yi,bi,xi,wi],social:[Si,_i,ki],timing:[Li,Ri,ji,Oi]};Vn[et].send=function(){if(!(1>arguments[Z])){var e,t;"string"==typeof arguments[0]?(e=arguments[0],t=[][H][ot](arguments,1)):(e=arguments[0]&&arguments[0][ri],t=arguments),e&&(t=p(Qn[e]||[],t),t[ri]=e,this.b.set(t,void 0,!0),this.filters.execute(this.b),"pageview"==e&&$n(this),this.b[V].m={})
}};var $n=function(e){e.I||(e.I=!0,yn(e.b,function(t){e.send("timing",t)}))},Xn=function(e){return"prerender"==_t.webkitVisibilityState?!1:(e(),!0)},Wn=function(e){if(!Xn(e)){i(16);var t=!1,n=function(){!t&&Xn(e)&&(t=!0,xt(_t,"webkitvisibilitychange",n))};bt(_t,"webkitvisibilitychange",n)}},Yn={F:"/plugins/ua/",D:/^(?:(\w+)\.)?(?:(\w+):)?(\w+)$/};Yn.k=new wt,Yn.f=[];var Kn=function(e){if(n(e[0]))this.u=e[0];else{var t=Yn.D.exec(e[0]);if(null!=t&&4==t[Z]&&(this.c=t[1]||"t0",this.e=t[2]||"",this.d=t[3],this.a=[][H][ot](e,1),this.e||(this.A="create"==this.d,this.i="require"==this.d,this.g="provide"==this.d)),!n(e[0])){if(t=e[1],e=e[2],!this.d)throw"abort";
if(this.i&&(!r(t)||""==t))throw"abort";if(this.g&&(!r(t)||""==t||!n(e)))throw"abort";if(0<=this.c[q](".")||0<=this.c[q](":")||0<=this.e[q](".")||0<=this.e[q](":"))throw"abort";if(this.g&&"t0"!=this.c)throw"abort"}}};Yn.B=function(e,t,i){var r=Yn.k.get(e);return n(r)?(t.plugins_=t.plugins_||new wt,t.plugins_.set(e,new r(t,i||{})),!0):!1},Yn.C=function(e,t){Yn.k.set(e,t)},Yn.execute=function(){var e=Yn.J[pt](Yn,arguments),e=Yn.f.concat(e);for(Yn.f=[];0<e[Z]&&!Yn.v(e[0])&&(e.shift(),!(0<Yn.f[Z])););Yn.f=Yn.f.concat(e)
},Yn.J=function(){for(var e=[],t=0;t<arguments[Z];t++)try{var i=new Kn(arguments[t]);if(i.g)Yn.v(i);else{if(i.i){var r=i.a[1];if(!n(Yn.k.get(i.a[0]))&&!i.H&&r){var s,a=r+"",r=a&&0<=a[q]("/")?a:"//www.google-analytics.com"+Yn.F+a,o=E(""+r),l=o[lt],u=_t[nt][lt];s="https:"==l||l==u?!0:"http:"!=l?!1:"http:"==u;var d;if(d=s){var a=o,h=E(_t[nt][ct]);if(a.G||0<=a.url[q]("?")||0<=a.path[q]("://"))d=!1;else if(a[J]==h[J]&&a[X]==h[X])d=!0;else{var p="http:"==a[lt]?80:443;d="www.google-analytics.com"==a[J]&&(a[X]||p)==p&&0==a.path[q]("/plugins/")?!0:!1
}}d&&(i.H=!!c(o.url))}}e[U](i)}}catch(f){}return e},Yn.v=function(e){try{if(e.u)e.u[ot](St,Gn.j("t0"));else if(e.g)Yn.C(e.a[0],e.a[1]);else{var t=e.c==Zt?Gn:Gn.j(e.c);if(e.A)"t0"==e.c&&Gn.create[pt](Gn,e.a);else if(t)if(e.i){if(!Yn.B(e.a[0],t,e.a[2]))return!0}else e.e&&(t=t.plugins_.get(e.e)),t[e.d][pt](t,e.a)}}catch(i){}};var Gn=function(){i(1),Yn.execute[pt](Yn,[arguments])};Gn.h={},Gn.P=[],Gn.L=0,Gn.answer=42;var Jn=[sn,on,nn];Gn.create=function(){var e=p(Jn,[][H][ot](arguments));e[nn]||(e[nn]="t0");
var t=""+e[nn];return Gn.h[t]?Gn.h[t]:(e=new Vn(e),Gn.h[t]=e,Gn.P[U](e),e)},Gn.j=function(e){return Gn.h[e]},Gn.K=function(){return Gn.P[H](0)},Gn.N=function(){var e=St[Zt];if(!e||42!=e.answer){Gn.L=e&&e.l,Gn.loaded=!0,St[Zt]=Gn,S();var t=e&&e.q;"[object Array]"==Object[et].toString[ot](Object(t))&&Wn(function(){Yn.execute[pt](Gn,t)})}},Gn.N()}(window),define("google-analytics",function(e){return function(){var t;return t||e.ga}}(this)),define("plex/base/adapters/analytics/GoogleAnalytics",["google-analytics","plex/base/utils/BaseClass"],function(e,t){var i=t.extend({constructor:function(t,i){this.ga=this.createGaQueue(),e("create",t,"auto"),e("set",{appName:i.name,appVersion:i.version})
},createGaQueue:function(){var t=function(){t.queue.push(arguments)};return t.queue=[],t.run=function(){for(;t.queue.length;)e.apply(window,t.queue.shift())},t},enable:function(){this.ga.run&&this.ga.run(),this.ga=e},disable:function(){this.ga=function(){}},set:function(t){e("set",t)},trackView:function(e){this.ga("send",{hitType:"appview",description:e})},trackEvent:function(e){this.ga("send","event",e)}});return i}),define("plex/base/adapters/playerProfileAdapter",["plex/base/adapters/Adapter"],function(e){var t=new e({props:["capabilities","video","music","photo"]});
return t}),define("plex/chromecast/adapters/player/castPlayerProfile",[],function(){var e={capabilities:{embed:!1,redirect:!1},video:{directPlay:{generic:{video:{maxBitrate:12e3,maxBitDepth:8,maxWidth:1920,maxHeight:1280,maxFrameRate:60,maxLevel:42}},mp4:{mimeType:'video/mp4; codecs="avc1.42E01E"',video:{codec:"h264"},audio:{codec:["aac","mp3"]}},mkv:{mimeType:"video/webm",video:{codec:["h264","vp8"]},audio:{codec:["aac","mp3","vorbis"]}}},directStream:{video:{codec:"h264",maxBitrate:12e3,maxBitDepth:8,maxWidth:1920,maxHeight:1280,maxLevel:42},audio:{codec:"aac",maxBitrate:768,maxChannels:6}}},music:{directPlay:{generic:{maxBitrate:350},mp4:{mimeType:"audio/mp4",audioCodec:"aac"},mp3:{mimeType:'audio/mpeg; codecs="mp3"',audioCodec:"mp3"},ogg:{mimeType:'audio/ogg; codecs="vorbis"',audioCodec:"vorbis"}},directStream:{audio:{codec:"mp3",maxBitrate:320,maxChannels:2}}}};
return e}),define("plex/base/utils/AjaxQueue",["underscore","jquery","plex/base/utils/BaseClass"],function(e,t,i){var n=i.extend({initialize:function(){this.ajaxQueue=[],this.currentRequest=null},dequeue:function(){this.ajaxQueue.length>0?(this.currentRequest=this.ajaxQueue.shift(),this.currentRequest()):this.currentRequest=null},queue:function(i){var n,r=t.Deferred(),s=r.promise(),a=function(){return n=t.ajax(i),n.done(r.resolve).fail(r.reject)};return s.always(e.bind(function(){this.currentRequest===a&&this.dequeue()
},this)),s.abort=e.bind(function(t){if(n)return n.abort(t);var o=e.indexOf(this.ajaxQueue,a);return o>-1&&this.ajaxQueue.splice(o,1),r.rejectWith(i.context||i,[s,t,""]),s},this),this.ajaxQueue.push(a),this.currentRequest||this.dequeue(),s}});return n}),define("plex/base/utils/browser",["underscore","plex/base/utils/BaseClass"],function(e,t){var i=/version\/(\d+(\.\d+)?)/i,n=/(?:chrome|crios|gfibertv)[\/-](\d+(\.\d+)?)/i,r=/firefox[ \/](\d+(\.\d+)?)/i,s=/(msie |rv:)(\d+(\.\d+)?)/i,a=/Konvergo\/(\d+(\.\d+)?)/i,o=/(?:applewebkit|safari)\/(\d+(\.\d+)?)/i,l=t.extend({browsers:[{id:"konvergo",name:"Plex Home Theater",webkit:!0,regex:/Konvergo/,versionRegex:a},{id:"wiiu",name:"Wii U",msie:!0,regex:/wiiu/i,versionRegex:o},{id:"ps3",name:"Unknown Browser",regex:/\(PLAYSTATION 3 \d\./},{id:"ps3",name:"Unknown Browser",regex:/\(PlayStation 4 \d\./},{id:"ps3",name:"Mystery 3",webkit:!0,regex:/\(PlayStation 3\)/,versionRegex:o},{id:"ps4",name:"Mystery 4",webkit:!0,regex:/\(PlayStation 4\)/,versionRegex:o},{id:"ie",name:"Internet Explorer",msie:!0,regex:/(msie|trident)/i,versionRegex:s,versionMatchIndex:2},{id:"opera",name:"Opera",presto:!0,regex:/opera/i,versionRegex:i},{id:"opera",name:"Opera",webkit:!0,regex:/OPR\//,versionRegex:/OPR\/(\d+(\.\d+)?)/},{id:"chrome",name:"Chrome",webkit:!0,regex:/(chrome|crios|gfiber)/i,versionRegex:n},{id:"firefox",name:"Firefox",gecko:!0,regex:/firefox/i,versionRegex:r},{id:"safari",name:"Safari",webkit:!0,regex:/os x.+safari/i,versionRegex:i},{id:"safari",name:"Safari",webkit:!0,regex:/applewebkit.+version/i,versionRegex:/applewebkit.+version\/(\d+(\.\d+)?)/i},{id:"safari",name:"Safari",webkit:!0,regex:/applewebkit/i,versionRegex:/(?:applewebkit|safari)\/(\d+(\.\d+)?)/i}],platforms:[{id:"ios",name:"iOS",mobile:!0,regex:/(iphone|ipad|ipod)/i},{id:"android",name:"Android",mobile:!0,regex:/android/i},{id:"windowsphone",name:"Windows Phone",mobile:!0,regex:/windows phone/i},{id:"webos",name:"webOS",mobile:!0,predicate:function(e){return/web[o0]s/i.test(e)&&!/large screen/i.test(e)
}},{id:"webos",name:"webOS",tv:!0,predicate:function(e){var t=/web[o0]s/i.test(e)&&/large screen/i.test(e);return this.version(e)?t:!1},version:function(){try{return JSON.parse(window.PalmSystem.deviceInfo).platformVersion}catch(e){}}},{id:"weboshybrid",name:"webOS",tv:!0,predicate:function(e){var t=/web[o0]s/i.test(e)&&/large screen/i.test(e);return!(!t||!window.NetCastGetMouseOnOff)}},{id:"netcast",name:"NetCast",tv:!0,regex:/netcast/i},{id:"blackberry",name:"Blackberry",mobile:!0,regex:/BlackBerry|RIM|BB10/},{id:"ps3",name:"PlayStation 3",tv:!0,regex:/P(lay)?S(tation )?3/,version:function(){return window.WM_devSettings?window.WM_devSettings.version:void 0
}},{id:"ps4",name:"PlayStation 4",tv:!0,regex:/P(lay)?S(tation )?4/,version:function(){return window.WM_devSettings?window.WM_devSettings.version:void 0}},{id:"wiiu",name:"Wii U",tv:!0,regex:/Nintendo WiiU/},{id:"smarthub",name:"SmartHub",tv:!0,regex:/smarthub/i},{id:"sta",name:"Smart TV Alliance",tv:!0,version:function(t){var i,n;if(/SmartTvA/.test(t))n=/SmartTvA\/(\d+\.\d+)/.exec(t),i=n&&n[1]||i;else{var r=[/Linux i686.+Chromium\/18/,/nettv\/4.2/i,/toshiba-dtv/i,/viera/i],s=[/nettv\/4/i],a=[/nettv/i],o=function(e){return e.test(t)
};e.some(r,o)?i="2.0":e.some(s,o)?i="1.0":e.some(a,o)&&(i="0.0")}return i},predicate:function(e){return void 0!==this.version(e)}},{id:"tivo",name:"TiVo",tv:!0,version:function(e){var t=/TiVo_(TCD[^,]+)/.exec(e);return t&&t[1]||void 0},predicate:function(e){return/opera/i.test(e)&&/tivo/i.test(e)}},{id:"viziomtk",name:"Vizio MTK",tv:!0,predicate:function(e){return/opera/i.test(e)&&"undefined"!=typeof iMTK_JSP}},{id:"viziosigma",name:"Vizio Sigma",tv:!0,predicate:function(e){return/opera/i.test(e)&&/vizio/i.test(e)
},version:function(e){var t=/\/([^\s]+) \(Vizio/.exec(e);return t&&t[1]||void 0}},{id:"operatvstore",name:"Opera TV Store",tv:!0,regex:/opera tv store/i},{id:"operatv",name:"Opera TV",tv:!0,regex:/opera\/\d+\.\d+ \(linux (mips|arm)/i},{id:"googlefiber",name:"Google Fiber",tv:!0,regex:/gfibertv/i},{id:"linux",name:"Linux",context:"platform",regex:/linux/i},{id:"osx",name:"OSX",context:"platform",regex:/mac/i},{id:"windows",name:"Windows",context:"platform",regex:/win/i}],id:"unknown",name:"Unknown Browser",platform:"Unknown Platform",version:"0",platformVersion:"0",platformModifierKey:"ctrl",webkit:!1,gecko:!1,msie:!1,presto:!1,constructor:function(e){var t="",i="";
e?(t=e.userAgent,i=e.platform):null!=navigator&&(t=navigator.userAgent,i=navigator.platform),this.detect({userAgent:t,platform:i})},detect:function(t){var i,n=this.runTests(this.browsers,t),r=this.runTests(this.platforms,t);n&&(this.id=n.id,this.name=n.name,this.version=this.getVersion(t.userAgent,n.versionRegex,n.versionMatchIndex||1),this.webkit=!!n.webkit,this.gecko=!!n.gecko,this.msie=!!n.msie,this.presto=!!n.presto),r&&(i=e.isFunction(r.version)?r.version(t.userAgent):r.version,this.platform=r.name,this.platformID=r.id,this.platformVersion=i||this.platformVersion,this.mobile=!!r.mobile,this.tv=!!r.tv,("OSX"===r.name||"iOS"===r.name)&&(this.platformModifierKey="command"))
},runTests:function(e,t){for(var i,n,r,s=0;n!==!0&&(r=e[s++]);)i=t[r.context||"userAgent"],r.regex?n=r.regex.test(i):r.predicate&&(n=r.predicate(i));return r},getVersion:function(e,t,i){var n=e.match(t);return n&&n.length>i&&n[i]||"0"},toJSON:function(){var t={};for(var i in this)e.has(this,i)&&this[i]&&(t[i]=this[i]);return t}});return new l}),define("plex/base/utils/capabilities",["plex/base/utils/browser"],function(e){var t={hasConsole:!!(window.console&&window.console.log&&window.console.log.call),hasWebSocket:!!window.WebSocket,hasEventSource:!!window.EventSource,hasReplaceState:!(!window.history||!window.history.replaceState),hasFileUpload:!!(window.File&&window.FileList&&window.FileReader),hasMediaSource:!(!window.MediaSource&&!window.WebKitMediaSource),hasObjectUrl:function(){var t="ie"===e.id&&11===parseInt(e.version,10);
return t||e.presto?!1:!!(window.URL&&window.URL.createObjectURL&&window.URL.revokeObjectURL)}(),hasBlob:function(){try{return!!new Blob}catch(e){return!1}}(),hasFullscreen:function(){var e=document.createElement("div");return!!(e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullscreen)}(),hasCanvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),hasTouchScreen:!!("ontouchstart"in window),isChromeApp:!(!window.chrome||!window.chrome.storage)};
return t}),define("plex/base/models/config",["underscore","backbone"],function(e,t){var i=t.Model.extend({defaults:e.extend({env:"production",bundled:!1,hosted:!0,flash:!0,playerDiscovery:!0,colorizeLogs:!0,defaultTarget:"_self",serverUpdate:!1,serverSavePrimaryOnly:!1,requestAllConnections:!1},window.PLEXWEB)});return new i}),define("plex/base/utils/ConsoleLogger",["underscore","plex/base/utils/BaseClass","plex/base/utils/capabilities","plex/base/mixins/eventMixin","plex/base/models/config"],function(e,t,i,n,r){var s=t.extend({mixins:n,log:function(t){e.isString(t)&&(t={message:t});
var n=t.type||"log",s=t.message||"";if(this.trigger("add",{type:n,message:s}),i.hasConsole){var a=t.logFn,o=t.color;a=a in console?console[a]:console.log,o&&r.get("colorizeLogs")?(s="%c"+s,o="color: "+o+";",a.call(console,s,o)):a.call(console,s)}},success:function(e){this.log({type:"success",message:e,color:"green"})},info:function(e){this.log({type:"info",message:e,logFn:"info",color:"blue"})},debug:function(e){this.log({type:"debug",message:e,logFn:"trace",color:"#d500ff"})},warn:function(e){this.log({type:"warning",message:e,logFn:"warn",color:"#ff6600"})
},error:function(e){this.log({type:"error",message:e,logFn:"error",color:"red"})},group:function(e,t){console.group&&console.group(e);for(var i=0,n=t.length;n>i;i++)this.log(t[i]);console.groupEnd&&console.groupEnd()}});return s}),define("plex/base/utils/ServerLogger",["underscore","jquery","plex/base/utils/BaseClass","plex/base/utils/AjaxQueue","plex/base/utils/ConsoleLogger","plex/base/mixins/eventMixin"],function(e,t,i,n,r,s){var a=0,o=1,l=2,u=3,c=4,d=r.extend({mixins:s,initialize:function(e){this.queuedLogs=[],this.ajaxQueue=new n,e||(e={}),this.source=e.source,this.server=e.server
},flushQueuedLogs:function(){var t=this.queuedLogs;this.queuedLogs=[],e.each(t,function(e){this.logToServer(e)},this)},queueLog:function(e){this.queuedLogs.push(e)},logToServer:function(i){if(!this.server)return this.queueLog(i),t.Deferred().resolve().promise();e.isString(i)&&(i={message:i});var n=i.level||l,r=i.message||"",s={level:n,message:r,source:this.source},a="/log?"+t.param(s,!0),o=this.server.getXHROptions(a);return this.ajaxQueue.queue(o)},setServer:function(e){this.server=e,e&&this.flushQueuedLogs()
},success:function(e){r.prototype.success.apply(this,arguments),this.logToServer({level:l,message:e})},info:function(e){r.prototype.info.apply(this,arguments),this.logToServer({level:l,message:e})},warn:function(e){r.prototype.warn.apply(this,arguments),this.logToServer({level:o,message:e})},error:function(e){r.prototype.error.apply(this,arguments),this.logToServer({level:a,message:e})},verbose:function(e){r.prototype.debug.apply(this,arguments),this.logToServer({level:c,message:e})},debug:function(e){r.prototype.debug.apply(this,arguments),this.logToServer({level:u,message:e})
}});return d}),define("plex/chromecast/adapters/CastLogger",["plex/base/utils/ServerLogger","plex/chromecast/models/castAppModel"],function(e,t){var i=e.extend({initialize:function(){e.prototype.initialize.apply(this,arguments),this.listenTo(t,{"change:primaryServer":this.onPrimaryServerChange})},onPrimaryServerChange:function(e,t){t&&this.setServer(t)}});return i}),define("plex/chromecast/adapters/castAdapters",["plex/base/adapters/localizerAdapter","plex/chromecast/adapters/castLocalizer","plex/base/adapters/storageAdapter","plex/base/adapters/webStorage","plex/base/adapters/dimensionsAdapter","plex/chromecast/adapters/castDimensions","plex/base/adapters/errorTrackerAdapter","plex/base/adapters/analytics/sentryTracker","plex/base/adapters/analyticsAdapter","plex/base/adapters/analytics/GoogleAnalytics","plex/base/adapters/playerProfileAdapter","plex/chromecast/adapters/player/castPlayerProfile","plex/base/adapters/loggerAdapter","plex/chromecast/adapters/CastLogger"],function(e,t,i,n,r,s,a,o,l,u,c,d,h,p){var f={registerAll:function(){e.register(t),i.register(n),r.register(s),a.register(o),l.register(u),c.register(d),h.register(new p({source:"Chromecast"}))
}};return f}),define("plex/base/utils/xhrTracker",["underscore","jquery","plex/base/utils/BaseClass"],function(e,t,i){var n=i.extend({initialize:function(){e.bindAll(this,"onAjaxSend"),this.requests=[],this.byId={}},startListening:function(){t(document).on("ajaxSend",this.onAjaxSend)},stopListening:function(){t(document).off("ajaxSend",this.onAjaxSend)},abortAll:function(e){for(var t=this.requests.length-1;t>-1;t--){var i=this.requests[t];(null==e||e===i.settings.scope)&&this.abort(i)}},abort:function(t){var i=e.isString(t)?this.byId[t]:t;
i&&(i.xhr.aborting=!0,i.xhr.abort(),this.remove(i))},store:function(t,i){var n=e.uniqueId("r");t.rid=n;var r={xhr:t,settings:i};return this.requests.push(r),this.byId[n]=r,r},remove:function(t){var i=e.indexOf(this.requests,t);i>-1&&this.requests.splice(i,1),this.byId.hasOwnProperty(t.xhr.rid)&&delete this.byId[t.xhr.rid]},onAjaxSend:function(t,i,n){if(!n.skipCorsWithRedirect){var r=this.store(i,n);i.always(e.bind(function(){i.aborting||this.remove(r)},this))}}});return new n}),define("plex/base/utils/t",["plex/base/adapters/localizerAdapter"],function(e){return function(){return e.t.apply(e,arguments)
}}),define("plex/base/utils/formatters/stringUtil",["underscore","plex/base/utils/t"],function(e,t){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n={encode64:function(e){var t,n,r,s,a,o="",l="",u="",c=0;do t=e.charCodeAt(c++),n=e.charCodeAt(c++),l=e.charCodeAt(c++),r=t>>2,s=(3&t)<<4|n>>4,a=(15&n)<<2|l>>6,u=63&l,isNaN(n)?a=u=64:isNaN(l)&&(u=64),o=o+i.charAt(r)+i.charAt(s)+i.charAt(a)+i.charAt(u),t=n=l="",r=s=a=u="";while(c<e.length);return o},decode64:function(e){var t,n,r,s,a,o="",l="",u="",c=0,d=/[^A-Za-z0-9\+\/\=]/g;
if(d.exec(e))throw new Error('There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, "+", "/", and "="\nExpect errors in decoding.');e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do r=i.indexOf(e.charAt(c++)),s=i.indexOf(e.charAt(c++)),a=i.indexOf(e.charAt(c++)),u=i.indexOf(e.charAt(c++)),t=r<<2|s>>4,n=(15&s)<<4|a>>2,l=(3&a)<<6|u,o+=String.fromCharCode(t),64!=a&&(o+=String.fromCharCode(n)),64!=u&&(o+=String.fromCharCode(l)),t=n=l="",r=s=a=u="";while(c<e.length);
return unescape(o)},toUtf8:function(e){for(var t="",i=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r||(2048>r?(n>i&&(t+=e.substring(i,n)),i=n+1,t+=String.fromCharCode(192|r>>>6),t+=String.fromCharCode(128|63&r)):(n>i&&(t+=e.substring(i,n)),i=n+1,t+=String.fromCharCode(224|r>>>12),t+=String.fromCharCode(128|r>>>6&63),t+=String.fromCharCode(128|63&r)))}return i>0&&i<e.length&&(t+=e.substring(i)),0===i?e:t},truncate:function(e,t){if(!e)return"";if(e.length>t){for(var i=e.substring(0,t-3);/\S/.test(i.charAt(i.length-1))===!1&&i.length>1;)i=i.slice(0,-1);
return i+"..."}return e},truncateMiddle:function(e,t,i){if(!e)return"";if(e.length>t){i=i||Math.floor((t-3)/2);var n=t-3-i;return e.substr(0,i)+"..."+e.substr(e.length-n)}return e},pluralize:function(e,t,i){return null==i&&(i=e+"s"),1===t?e:i},formatLabel:function(e){for(var t="",i=0,n=e.length;n>i;i++){var r=e.charAt(i),s=r.toUpperCase();t+=0===i?s:r===s?" "+s:r}return t},formatBoolean:function(e){return t(e&&0!==parseInt(e,10)?"Yes":"No")},upperCase:function(e){return(e||"").toUpperCase()},upperCaseFirstLetter:function(e){return e.charAt(0).toUpperCase()+e.slice(1)
},lowerCaseFirstLetter:function(e){return e.charAt(0).toLowerCase()+e.slice(1)},titleCase:function(e){return e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},getLastSegment:function(t){return e.first(/[^\/\\]+$/.exec(t||"")||[])},random:function(){return Math.random().toString(36).substr(2)},shortFilename:function(e,t){return e?n.truncateMiddle(n.getLastSegment(e),t):void 0}};return n}),define("plex/base/initializers/appInitializer",["jquery","plex/base/utils/xhrTracker","plex/base/utils/formatters/stringUtil","plex/base/adapters/storageAdapter"],function(e,t,i,n){var r={init:function(r){var s=e.Deferred();
if(window.PLEXWEB&&window.PLEXWEB.appVersion)r.set("version",window.PLEXWEB.appVersion);else{var a=e("#plex-script");if(a.length){var o=/version=([\.\w]+)$/.exec(a[0].src);o&&r.set("version",o[1])}}t.startListening();var l=n.get({key:"clientID"});return l.done(function(e){r.set("clientID",e)}),l.fail(function(){var e=i.random();n.set({key:"clientID",value:e}),r.set("clientID",e)}),l.always(function(){s.resolve()}),s.promise()}};return r}),define("plex/base/adapters/analytics/loggingErrorTracker",["plex/base/adapters/loggerAdapter"],function(e){var t={init:function(){e.info("Error tracker initialized")
},enable:function(){e.info("Error tracker enabled")},disable:function(){e.info("Error tracker disabled")},set:function(t){e.info("Error tracker set options "+JSON.stringify(t,null,2))},capture:function(t,i){e.error(t),e.info("Tracked error "+JSON.stringify(i,null,2))}};return t}),define("plex/base/adapters/analytics/LoggingAnalytics",["plex/base/utils/BaseClass","plex/base/adapters/loggerAdapter"],function(e,t){var i=e.extend({enable:function(){t.info("Analytics enabled")},disable:function(){t.info("Analytics disabled")
},set:function(e){t.info("Analytics set options "+JSON.stringify(e,null,2))},trackView:function(e){t.info('Analytics tracked view "'+e+'"')},trackEvent:function(e){t.info("Analytics tracked event "+JSON.stringify(e,null,2))}});return i}),define("plex/base/models/StorageModel",["underscore","backbone","plex/base/adapters/storageAdapter"],function(e,t,i){function n(t,i){return t?e.reduce(i,function(e,i,n){return t[n]!==i&&(e[n]=i),e},{}):i}var r=t.Model.extend({save:function(r,s,a){var o,l=this.attributes;
if(null==r||"object"==typeof r?(o=r,a=s):(o={})[r]=s,a=e.extend({validate:!0},a),o&&!a.wait){if(!this.set(o,a))return!1}else if(!this._validate(o,a))return!1;o&&a.wait&&(this.attributes=e.extend({},l,o)),void 0===a.parse&&(a.parse=!0);var u=this,c=a.success;a.success=function(){u.attributes=l,c&&c(u,l,a),u.trigger("sync",u,l,a)},t.wrapError(this,a);var d=i.set({key:e.result(this,"storageKey"),value:JSON.stringify(n(e.result(this,"defaults"),this.attributes))});return d.done(a.success).fail(a.error),o&&a.wait&&(this.attributes=l),d
},populate:function(){return this.populatePromise||(this.populatePromise=this.fetch.apply(this,arguments)),this.populatePromise},fetch:function(n){n=n?e.clone(n):{},void 0===n.parse&&(n.parse=!0);var r=this,s=n.success;n.success=function(e){return r.set(r.parse(e,n),n)?(s&&s(r,e,n),void r.trigger("sync",r,e,n)):!1},t.wrapError(this,n);var a=i.get({key:e.result(this,"storageKey")});return a.done(n.success).fail(n.error),this.populatePromise=a,a},destroy:function(n){n=n?e.clone(n):{};var r=this,s=n.success,a=function(){r.trigger("destroy",r,r.collection,n)
};n.success=function(e){n.wait&&a(),s&&s(r,e,n),r.trigger("sync",r,e,n)},t.wrapError(this,n);var o=i.remove({key:e.result(this,"storageKey")});return o.done(n.success).fail(n.error),n.wait||a(),o},parse:function(e){return JSON.parse(e)}});return r}),define("plex/base/models/sessionStatsModel",["underscore","plex/base/models/StorageModel"],function(e,t){var i=t.extend({storageKey:"sessionstats",incPlaybackCount:function(){this.save("playbackCount",this.get("playbackCount")+1)},startSession:function(){var t=(new Date).getTime();
this.save({playbackCount:0,startTime:t,heartbeatTime:t}),setInterval(e.bind(function(){this.save("heartbeatTime",(new Date).getTime())},this),1e4)}});return new i}),define("plex/base/initializers/analyticsInitializer",["plex/base/adapters/dimensionsAdapter","plex/base/adapters/errorTrackerAdapter","plex/base/adapters/analyticsAdapter","plex/base/adapters/analytics/loggingErrorTracker","plex/base/adapters/analytics/LoggingAnalytics","plex/base/models/config","plex/base/models/sessionStatsModel"],function(e,t,i,n,r,s,a){function o(i){("production"!==s.get("env")||i.disableErrorTracking)&&(t.disable(),t.register(n)),c=i.errorTrackerID||c,t.init(c,e.prop("X-Plex-Version")),t.set("X-Plex-Product",e.prop("X-Plex-Product")),t.set("X-Plex-Device",e.prop("X-Plex-Device")),t.set("X-Plex-Platform",e.prop("X-Plex-Platform")),t.set("X-Plex-Platform-Version",e.prop("X-Plex-Platform-Version"))
}function l(t){("production"!==s.get("env")||t.disableAnalytics)&&i.register(r),u=t.googleAnalyticsID||u,i.init(u,{name:e.prop("X-Plex-Product"),version:e.prop("X-Plex-Version")}),i.set({dimension1:e.prop("X-Plex-Product"),dimension2:e.prop("X-Plex-Client-Identifier"),dimension3:e.prop("X-Plex-Platform"),dimension4:e.prop("X-Plex-Platform-Version"),dimension5:e.prop("X-Plex-Device"),dimension6:e.prop("X-Plex-Version")}),a.populate().done(function(){var e=a.get("heartbeatTime")-a.get("startTime"),t=Math.round(e/1e3),n=a.get("playbackCount");
i.trackEvent({eventCategory:"App",eventAction:"Shutdown",eventValue:t,metric1:n})}),a.populate().always(function(){a.startSession(),i.trackEvent({eventCategory:"App",eventAction:"Start",eventValue:1,sessionControl:"start"})})}var u="UA-6111912-18",c="https://1803afa09e504c87b50d399f36bce337@app.getsentry.com/34200",d={init:function(e){e||(e={}),o(e),l(e)}};return d}),define("plex/chromecast/initializers/castAnalyticsInitializer",["plex/base/initializers/analyticsInitializer","plex/base/adapters/analyticsAdapter"],function(e,t){var i={init:function(){e.init(),t.enable()
}};return i}),define("plex/base/utils/playerUtil",["underscore","plex/base/utils/BaseClass"],function(e,t){function i(t,i){var n=e.invert(t);return e.reduce(t,function(e,t){return e[t]=i[n[t]],e},{})}var n=t.extend({types:{VIDEO:"video",MUSIC:"music",PHOTO:"photo"},elements:{VIDEO:"video",MUSIC:"audio",PHOTO:"photo"},streams:{VIDEO:"video",MUSIC:"audio",PHOTO:"photo"},states:{STOPPED:"stopped",PAUSED:"paused",PLAYING:"playing",BUFFERING:"buffering",ERROR:"error"},castStates:{ERROR:"IDLE",STOPPED:"IDLE",PAUSED:"PAUSED",PLAYING:"PLAYING",BUFFERING:"BUFFERING"},initialize:function(){this.typeByElement=i(this.elements,this.types),this.elementByType=i(this.types,this.elements),this.typeByStream=i(this.streams,this.types),this.streamByType=i(this.types,this.streams),this.statebyCastState=i(this.castStates,this.states),this.castStateByState=i(this.states,this.castStates)
},getTypeByElement:function(e){return this.typeByElement[e]},getElementByType:function(e){return this.elementByType[e]},getTypeByStream:function(e){return this.typeByStream[e]},getStreamByType:function(e){return this.streamByType[e]},getStateByCastState:function(e){return this.statebyCastState[e]},getCastStateByState:function(e){return this.castStateByState[e]}});return new n}),function(e){function t(e,t){return function(i){return l(e.call(this,i),t)}}function i(e,t){return function(i){return this.lang().ordinal(e.call(this,i),t)
}}function n(){}function r(e){x(e),a(this,e)}function s(e){var t=f(e),i=t.year||0,n=t.month||0,r=t.week||0,s=t.day||0,a=t.hour||0,o=t.minute||0,l=t.second||0,u=t.millisecond||0;this._input=e,this._milliseconds=+u+1e3*l+6e4*o+36e5*a,this._days=+s+7*r,this._months=+n+12*i,this._data={},this._bubble()}function a(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function o(e){return 0>e?Math.ceil(e):Math.floor(e)
}function l(e,t){for(var i=e+"";i.length<t;)i="0"+i;return i}function u(e,t,i,n){var r,s,a=t._milliseconds,o=t._days,l=t._months;a&&e._d.setTime(+e._d+a*i),(o||l)&&(r=e.minute(),s=e.hour()),o&&e.date(e.date()+o*i),l&&e.month(e.month()+l*i),a&&!n&&tt.updateOffset(e),(o||l)&&(e.minute(r),e.hour(s))}function c(e){return"[object Array]"===Object.prototype.toString.call(e)}function d(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function h(e,t,i){var n,r=Math.min(e.length,t.length),s=Math.abs(e.length-t.length),a=0;
for(n=0;r>n;n++)(i&&e[n]!==t[n]||!i&&g(e[n])!==g(t[n]))&&a++;return a+s}function p(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=jt[e]||Bt[t]||t}return e}function f(e){var t,i,n={};for(i in e)e.hasOwnProperty(i)&&(t=p(i),t&&(n[t]=e[i]));return n}function m(t){var i,n;if(0===t.indexOf("week"))i=7,n="day";else{if(0!==t.indexOf("month"))return;i=12,n="month"}tt[t]=function(r,s){var a,o,l=tt.fn._lang[t],u=[];if("number"==typeof r&&(s=r,r=e),o=function(e){var t=tt().utc().set(n,e);return l.call(tt.fn._lang,t,r||"")
},null!=s)return o(s);for(a=0;i>a;a++)u.push(o(a));return u}}function g(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function v(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function y(e){return b(e)?366:365}function b(e){return 0===e%4&&0!==e%100||0===e%400}function x(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[at]<0||e._a[at]>11?at:e._a[ot]<1||e._a[ot]>v(e._a[st],e._a[at])?ot:e._a[lt]<0||e._a[lt]>23?lt:e._a[ut]<0||e._a[ut]>59?ut:e._a[ct]<0||e._a[ct]>59?ct:e._a[dt]<0||e._a[dt]>999?dt:-1,e._pf._overflowDayOfYear&&(st>t||t>ot)&&(t=ot),e._pf.overflow=t)
}function w(e){e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function S(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function _(e){return e?e.toLowerCase().replace("_","-"):e
}function k(e,t){return t.abbr=e,ht[e]||(ht[e]=new n),ht[e].set(t),ht[e]}function P(e){delete ht[e]}function M(e){var t,i,n,r,s=0,a=function(e){if(!ht[e]&&pt)try{require("./lang/"+e)}catch(t){}return ht[e]};if(!e)return tt.fn._lang;if(!c(e)){if(i=a(e))return i;e=[e]}for(;s<e.length;){for(r=_(e[s]).split("-"),t=r.length,n=_(e[s+1]),n=n?n.split("-"):null;t>0;){if(i=a(r.slice(0,t).join("-")))return i;if(n&&n.length>=t&&h(r,n,!0)>=t-1)break;t--}s++}return tt.fn._lang}function C(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")
}function T(e){var t,i,n=e.match(vt);for(t=0,i=n.length;i>t;t++)n[t]=Ft[n[t]]?Ft[n[t]]:C(n[t]);return function(r){var s="";for(t=0;i>t;t++)s+=n[t]instanceof Function?n[t].call(r,e):n[t];return s}}function A(e,t){return e.isValid()?(t=I(t,e.lang()),Ut[t]||(Ut[t]=T(t)),Ut[t](e)):e.lang().invalidDate()}function I(e,t){function i(e){return t.longDateFormat(e)||e}var n=5;for(yt.lastIndex=0;n>=0&&yt.test(e);)e=e.replace(yt,i),yt.lastIndex=0,n-=1;return e}function E(e,t){var i;switch(e){case"DDDD":return wt;
case"YYYY":case"GGGG":case"gggg":return St;case"YYYYY":case"GGGGG":case"ggggg":return _t;case"S":case"SS":case"SSS":case"DDD":return xt;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Pt;case"a":case"A":return M(t._l)._meridiemParse;case"X":return Tt;case"Z":case"ZZ":return Mt;case"T":return Ct;case"SSSS":return kt;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return bt;
default:return i=new RegExp(N(U(e.replace("\\","")),"i"))}}function D(e){var t=(Mt.exec(e)||[])[0],i=(t+"").match(Lt)||["-",0,0],n=+(60*i[1])+g(i[2]);return"+"===i[0]?-n:n}function L(e,t,i){var n,r=i._a;switch(e){case"M":case"MM":null!=t&&(r[at]=g(t)-1);break;case"MMM":case"MMMM":n=M(i._l).monthsParse(t),null!=n?r[at]=n:i._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(r[ot]=g(t));break;case"DDD":case"DDDD":null!=t&&(i._dayOfYear=g(t));break;case"YY":r[st]=g(t)+(g(t)>68?1900:2e3);break;case"YYYY":case"YYYYY":r[st]=g(t);
break;case"a":case"A":i._isPm=M(i._l).isPM(t);break;case"H":case"HH":case"h":case"hh":r[lt]=g(t);break;case"m":case"mm":r[ut]=g(t);break;case"s":case"ss":r[ct]=g(t);break;case"S":case"SS":case"SSS":case"SSSS":r[dt]=g(1e3*("0."+t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=D(t);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":e=e.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(i._w=i._w||{},i._w[e]=t)
}}function R(e){var t,i,n,r,s,a,o,l,u,c,d=[];if(!e._d){for(n=j(e),e._w&&null==e._a[ot]&&null==e._a[at]&&(s=function(t){return t?t.length<3?parseInt(t,10)>68?"19"+t:"20"+t:t:null==e._a[st]?tt().weekYear():e._a[st]},a=e._w,null!=a.GG||null!=a.W||null!=a.E?o=Y(s(a.GG),a.W||1,a.E,4,1):(l=M(e._l),u=null!=a.d?Q(a.d,l):null!=a.e?parseInt(a.e,10)+l._week.dow:0,c=parseInt(a.w,10)||1,null!=a.d&&u<l._week.dow&&c++,o=Y(s(a.gg),c,u,l._week.doy,l._week.dow)),e._a[st]=o.year,e._dayOfYear=o.dayOfYear),e._dayOfYear&&(r=null==e._a[st]?n[st]:e._a[st],e._dayOfYear>y(r)&&(e._pf._overflowDayOfYear=!0),i=q(r,0,e._dayOfYear),e._a[at]=i.getUTCMonth(),e._a[ot]=i.getUTCDate()),t=0;3>t&&null==e._a[t];++t)e._a[t]=d[t]=n[t];
for(;7>t;t++)e._a[t]=d[t]=null==e._a[t]?2===t?1:0:e._a[t];d[lt]+=g((e._tzm||0)/60),d[ut]+=g((e._tzm||0)%60),e._d=(e._useUTC?q:z).apply(null,d)}}function O(e){var t;e._d||(t=f(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],R(e))}function j(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function B(e){e._a=[],e._pf.empty=!0;var t,i,n,r,s,a=M(e._l),o=""+e._i,l=o.length,u=0;for(n=I(e._f,a).match(vt)||[],t=0;t<n.length;t++)r=n[t],i=(E(r,e).exec(o)||[])[0],i&&(s=o.substr(0,o.indexOf(i)),s.length>0&&e._pf.unusedInput.push(s),o=o.slice(o.indexOf(i)+i.length),u+=i.length),Ft[r]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(r),L(r,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(r);
e._pf.charsLeftOver=l-u,o.length>0&&e._pf.unusedInput.push(o),e._isPm&&e._a[lt]<12&&(e._a[lt]+=12),e._isPm===!1&&12===e._a[lt]&&(e._a[lt]=0),R(e),x(e)}function U(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,n,r){return t||i||n||r})}function N(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function H(e){var t,i,n,r,s;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(r=0;r<e._f.length;r++)s=0,t=a({},e),w(t),t._f=e._f[r],B(t),S(t)&&(s+=t._pf.charsLeftOver,s+=10*t._pf.unusedTokens.length,t._pf.score=s,(null==n||n>s)&&(n=s,i=t));
a(e,i||t)}function F(e){var t,i=e._i,n=At.exec(i);if(n){for(e._pf.iso=!0,t=4;t>0;t--)if(n[t]){e._f=Et[t-1]+(n[6]||" ");break}for(t=0;4>t;t++)if(Dt[t][1].exec(i)){e._f+=Dt[t][0];break}Mt.exec(i)&&(e._f+="Z"),B(e)}else e._d=new Date(i)}function V(t){var i=t._i,n=ft.exec(i);i===e?t._d=new Date:n?t._d=new Date(+n[1]):"string"==typeof i?F(t):c(i)?(t._a=i.slice(0),R(t)):d(i)?t._d=new Date(+i):"object"==typeof i?O(t):t._d=new Date(i)}function z(e,t,i,n,r,s,a){var o=new Date(e,t,i,n,r,s,a);return 1970>e&&o.setFullYear(e),o
}function q(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function Q(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function $(e,t,i,n,r){return r.relativeTime(t||1,!!i,e,n)}function X(e,t,i){var n=rt(Math.abs(e)/1e3),r=rt(n/60),s=rt(r/60),a=rt(s/24),o=rt(a/365),l=45>n&&["s",n]||1===r&&["m"]||45>r&&["mm",r]||1===s&&["h"]||22>s&&["hh",s]||1===a&&["d"]||25>=a&&["dd",a]||45>=a&&["M"]||345>a&&["MM",rt(a/30)]||1===o&&["y"]||["yy",o];
return l[2]=t,l[3]=e>0,l[4]=i,$.apply({},l)}function W(e,t,i){var n,r=i-t,s=i-e.day();return s>r&&(s-=7),r-7>s&&(s+=7),n=tt(e).add("d",s),{week:Math.ceil(n.dayOfYear()/7),year:n.year()}}function Y(e,t,i,n,r){var s,a,o=new Date(Date.UTC(e,0)).getUTCDay();return i=null!=i?i:r,s=r-o+(o>n?7:0),a=7*(t-1)+(i-r)+s+1,{year:a>0?e:e-1,dayOfYear:a>0?a:y(e-1)+a}}function K(e){var t=e._i,i=e._f;return"undefined"==typeof e._pf&&w(e),null===t?tt.invalid({nullInput:!0}):("string"==typeof t&&(e._i=t=M().preparse(t)),tt.isMoment(t)?(e=a({},t),e._d=new Date(+t._d)):i?c(i)?H(e):B(e):V(e),new r(e))
}function G(e,t){tt.fn[e]=tt.fn[e+"s"]=function(e){var i=this._isUTC?"UTC":"";return null!=e?(this._d["set"+i+t](e),tt.updateOffset(this),this):this._d["get"+i+t]()}}function J(e){tt.duration.fn[e]=function(){return this._data[e]}}function Z(e,t){tt.duration.fn["as"+e]=function(){return+this/t}}function et(e){var t=!1,i=tt;"undefined"==typeof ender&&(this.moment=e?function(){return!t&&console&&console.warn&&(t=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),i.apply(null,arguments)
}:tt)}for(var tt,it,nt="2.4.0",rt=Math.round,st=0,at=1,ot=2,lt=3,ut=4,ct=5,dt=6,ht={},pt="undefined"!=typeof module&&module.exports,ft=/^\/?Date\((\-?\d+)/i,mt=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,gt=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,vt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,yt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,bt=/\d\d?/,xt=/\d{1,3}/,wt=/\d{3}/,St=/\d{1,4}/,_t=/[+\-]?\d{1,6}/,kt=/\d+/,Pt=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Mt=/Z|[\+\-]\d\d:?\d\d/i,Ct=/T/i,Tt=/[\+\-]?\d+(\.\d{1,3})?/,At=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,It="YYYY-MM-DDTHH:mm:ssZ",Et=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],Dt=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Lt=/([\+\-]|\d\d)/gi,Rt="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Ot={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},jt={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Bt={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Ut={},Nt="DDD w W M D d".split(" "),Ht="M D H h m s w W".split(" "),Ft={M:function(){return this.month()+1
},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return l(this.year()%100,2)},YYYY:function(){return l(this.year(),4)
},YYYYY:function(){return l(this.year(),5)},gg:function(){return l(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return l(this.weekYear(),5)},GG:function(){return l(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return l(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)
},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return g(this.milliseconds()/100)},SS:function(){return l(g(this.milliseconds()/10),2)},SSS:function(){return l(this.milliseconds(),3)},SSSS:function(){return l(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(g(e/60),2)+":"+l(g(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+l(g(10*e/6),4)
},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},Vt=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Nt.length;)it=Nt.pop(),Ft[it+"o"]=i(Ft[it],it);for(;Ht.length;)it=Ht.pop(),Ft[it+it]=t(Ft[it],2);for(Ft.DDDD=t(Ft.DDD,3),a(n.prototype,{set:function(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]
},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,i,n;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(i=tt.utc([2e3,t]),n="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[t]=new RegExp(n.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]
},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,n;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(i=tt([2e3,1]).day(t),n="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(n.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t
},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"
},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var i=this._calendar[e];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,n){var r=this._relativeTime[i];
return"function"==typeof r?r(e,t,i,n):r.replace(/%d/i,e)},pastFuture:function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return W(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),tt=function(t,i,n,r){return"boolean"==typeof n&&(r=n,n=e),K({_i:t,_f:i,_l:n,_strict:r,_isUTC:!1})
},tt.utc=function(t,i,n,r){var s;return"boolean"==typeof n&&(r=n,n=e),s=K({_useUTC:!0,_isUTC:!0,_l:n,_i:t,_f:i,_strict:r}).utc()},tt.unix=function(e){return tt(1e3*e)},tt.duration=function(e,t){var i,n,r,a=tt.isDuration(e),o="number"==typeof e,l=a?e._input:o?{}:e,u=null;return o?t?l[t]=e:l.milliseconds=e:(u=mt.exec(e))?(i="-"===u[1]?-1:1,l={y:0,d:g(u[ot])*i,h:g(u[lt])*i,m:g(u[ut])*i,s:g(u[ct])*i,ms:g(u[dt])*i}):(u=gt.exec(e))&&(i="-"===u[1]?-1:1,r=function(e){var t=e&&parseFloat(e.replace(",","."));
return(isNaN(t)?0:t)*i},l={y:r(u[2]),M:r(u[3]),d:r(u[4]),h:r(u[5]),m:r(u[6]),s:r(u[7]),w:r(u[8])}),n=new s(l),a&&e.hasOwnProperty("_lang")&&(n._lang=e._lang),n},tt.version=nt,tt.defaultFormat=It,tt.updateOffset=function(){},tt.lang=function(e,t){var i;return e?(t?k(_(e),t):null===t?(P(e),e="en"):ht[e]||M(e),i=tt.duration.fn._lang=tt.fn._lang=M(e),i._abbr):tt.fn._lang._abbr},tt.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),M(e)},tt.isMoment=function(e){return e instanceof r
},tt.isDuration=function(e){return e instanceof s},it=Vt.length-1;it>=0;--it)m(Vt[it]);for(tt.normalizeUnits=function(e){return p(e)},tt.invalid=function(e){var t=tt.utc(0/0);return null!=e?a(t._pf,e):t._pf.userInvalidated=!0,t},tt.parseZone=function(e){return tt(e).parseZone()},a(tt.fn=r.prototype,{clone:function(){return tt(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return A(tt(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return S(this)},isDSTShifted:function(){return this._a?this.isValid()&&h(this._a,(this._isUTC?tt.utc(this._a):tt(this._a)).toArray())>0:!1},parsingFlags:function(){return a({},this._pf)},invalidAt:function(){return this._pf.overflow
},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=A(this,e||tt.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var i;return i="string"==typeof e?tt.duration(+t,e):tt.duration(e,t),u(this,i,1),this},subtract:function(e,t){var i;return i="string"==typeof e?tt.duration(+t,e):tt.duration(e,t),u(this,i,-1),this},diff:function(e,t,i){var n,r,s=this._isUTC?tt(e).zone(this._offset||0):tt(e).local(),a=6e4*(this.zone()-s.zone());
return t=p(t),"year"===t||"month"===t?(n=432e5*(this.daysInMonth()+s.daysInMonth()),r=12*(this.year()-s.year())+(this.month()-s.month()),r+=(this-tt(this).startOf("month")-(s-tt(s).startOf("month")))/n,r-=6e4*(this.zone()-tt(this).startOf("month").zone()-(s.zone()-tt(s).startOf("month").zone()))/n,"year"===t&&(r/=12)):(n=this-s,r="second"===t?n/1e3:"minute"===t?n/6e4:"hour"===t?n/36e5:"day"===t?(n-a)/864e5:"week"===t?(n-a)/6048e5:n),i?r:o(r)},from:function(e,t){return tt.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)
},fromNow:function(e){return this.from(tt(),e)},calendar:function(){var e=this.diff(tt().zone(this.zone()).startOf("day"),"days",!0),t=-6>e?"sameElse":-1>e?"lastWeek":0>e?"lastDay":1>e?"sameDay":2>e?"nextDay":7>e?"nextWeek":"sameElse";return this.format(this.lang().calendar(t,this))},isLeapYear:function(){return b(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();
return null!=e?(e=Q(e,this.lang()),this.add({d:e-t})):t},month:function(e){var t,i=this._isUTC?"UTC":"";return null!=e?"string"==typeof e&&(e=this.lang().monthsParse(e),"number"!=typeof e)?this:(t=this.date(),this.date(1),this._d["set"+i+"Month"](e),this.date(Math.min(t,this.daysInMonth())),tt.updateOffset(this),this):this._d["get"+i+"Month"]()},startOf:function(e){switch(e=p(e)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);
case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),this},endOf:function(e){return e=p(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+tt(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+tt(e).startOf(t)},isSame:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)===+tt(e).startOf(t)
},min:function(e){return e=tt.apply(null,arguments),this>e?this:e},max:function(e){return e=tt.apply(null,arguments),e>this?this:e},zone:function(e){var t=this._offset||0;return null==e?this._isUTC?t:this._d.getTimezoneOffset():("string"==typeof e&&(e=D(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,t!==e&&u(this,tt.duration(t-e,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this
},hasAlignedHourOffset:function(e){return e=e?tt(e).zone():0,0===(this.zone()-e)%60},daysInMonth:function(){return v(this.year(),this.month())},dayOfYear:function(e){var t=rt((tt(this).startOf("day")-tt(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},weekYear:function(e){var t=W(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=W(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);
return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=W(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},get:function(e){return e=p(e),this[e]()},set:function(e,t){return e=p(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=M(t),this)}}),it=0;it<Rt.length;it++)G(Rt[it].toLowerCase().replace(/s$/,""),Rt[it]);
G("year","FullYear"),tt.fn.days=tt.fn.day,tt.fn.months=tt.fn.month,tt.fn.weeks=tt.fn.week,tt.fn.isoWeeks=tt.fn.isoWeek,tt.fn.toJSON=tt.fn.toISOString,a(tt.duration.fn=s.prototype,{_bubble:function(){var e,t,i,n,r=this._milliseconds,s=this._days,a=this._months,l=this._data;l.milliseconds=r%1e3,e=o(r/1e3),l.seconds=e%60,t=o(e/60),l.minutes=t%60,i=o(t/60),l.hours=i%24,s+=o(i/24),l.days=s%30,a+=o(s/30),l.months=a%12,n=o(a/12),l.years=n},weeks:function(){return o(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*g(this._months/12)
},humanize:function(e){var t=+this,i=X(t,!e,this.lang());return e&&(i=this.lang().pastFuture(t,i)),this.lang().postformat(i)},add:function(e,t){var i=tt.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=tt.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=p(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=p(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()
},lang:tt.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),n=Math.abs(this.hours()),r=Math.abs(this.minutes()),s=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(n||r||s?"T":"")+(n?n+"H":"")+(r?r+"M":"")+(s?s+"S":""):"P0D"}});for(it in Ot)Ot.hasOwnProperty(it)&&(Z(it,Ot[it]),J(it.toLowerCase()));Z("Weeks",6048e5),tt.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()
},tt.lang("en",{ordinal:function(e){var t=e%10,i=1===g(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),pt?(module.exports=tt,et(!0)):"function"==typeof define&&define.amd?define("moment",["require","exports","module"],function(t,i,n){return n.config().noGlobal!==!0&&et(n.config().noGlobal===e),tt}):et()}.call(this),define("plex/base/utils/formatters/numberUtil",["underscore"],function(e){var t={leadingZero:function(t){if(t=parseInt(t,10),e.isNaN(t))return"";var i=10>t?"0":"";return i+t
},bytesToSize:function(t,i){if(t=parseInt(t,10),i=i||1,e.isNaN(t))return"";if(0===t)return"0 Bytes";var n=["Bytes","KB","MB","GB","TB"],r=parseInt(Math.floor(Math.log(t)/Math.log(1024)),10);return(t/Math.pow(1024,r)).toFixed(i)+" "+n[r]}};return t}),define("plex/base/utils/types/streamTypes",["underscore","plex/base/utils/BaseClass"],function(e,t){var i=t.extend({types:[{id:1,typeString:"video",key:"videoStreamID",title:"Video"},{id:2,typeString:"audio",key:"audioStreamID",title:"Audio"},{id:3,typeString:"subtitles",key:"subtitleStreamID",title:"Subtitles"}],initialize:function(){this.byID=e.reduce(this.types,function(e,t){return e[t.id]=t,e
},{}),this.byType=e.reduce(this.types,function(e,t){return e[t.typeString]=t,e},{})},getStreamType:function(e){return this.byID[e]},getStreamTypeByString:function(e){return this.byType[e]}});return new i}),define("plex/base/utils/mediaUtil",["underscore","jquery","moment","plex/base/utils/t","plex/base/utils/formatters/numberUtil","plex/base/utils/types/streamTypes","plex/base/adapters/loggerAdapter"],function(e,t,i,n,r,s,a){var o={capabilities:"protocols=http-live-streaming,http-mp4-streaming,http-streaming-video,http-streaming-video-720p,http-mp4-video,http-mp4-video-720p;videoDecoders=h264{profile:high&resolution:1080&level:51};audioDecoders=mp3,aac{bitrate:160000}",timelineDelay:1e4,pingDelay:3e4,playbackDelay:1e3,timeline:function(i,n){var r=i.item,s=i.media,o=i.part,l=r.get("ratingKey"),u=r.get("type");
if(!l)return t.Deferred().resolve().promise();var c={ratingKey:l,key:r.get("key"),state:i.state};if(i.continuing&&(c.continuing="1"),r.get("playQueueItemID")&&(c.playQueueItemID=r.get("playQueueItemID")),!("photo"===u||s&&o))return t.Deferred().resolve().promise();if("photo"!==u){var d=r.get("viewOffset")||0,h=s.duration;if(e.isNumber(i.position)&&(d=i.position,d=this.getAbsoluteOffset(s,o,d)),h||e.isNumber(i.duration)&&(h=i.duration,s.duration=h),!h)return t.Deferred().resolve().promise();d>h&&(d=h),c.time=d,c.duration=h,"track"!==u&&r.isLibraryItem()&&this.setViewOffset(r,d,h)
}var p="timeline: "+c.state;null!=c.time&&(p+=", "+c.time+"/"+c.duration),a.log(p);var f="/:/timeline?"+t.param(c,!0);return n=e.extend(r.server.getXHROptions(f),n),t.ajax(n)},setViewOffset:function(e,t,i){1!==e.get("extraType")&&(6e4>t||(t>.9*i?(e.set("viewOffset",0),e.set("viewCount",1)):e.set("viewOffset",t)))},ping:function(e,i){if(!i)return t.Deferred().resolve().promise();a.log("ping transcoder");var n;return n=e.supports("universalTranscoder")?"/video/:/transcode/universal/ping?session="+i:"/video/:/transcode/segmented/ping?session="+i,t.ajax(e.getXHROptions(n))
},stop:function(i,n,r){if(!n)return t.Deferred().resolve().promise();a.log("stop transcoder");var s;return s=i.supports("universalTranscoder")?"/video/:/transcode/universal/stop?session="+n:"/video/:/transcode/segmented/stop?session="+n,r=e.extend(i.getXHROptions(s),r),t.ajax(r)},getMediaIndex:function(t,i){var n=t.get("Media"),r=e.indexOf(n,e.findWhere(n,{id:i}));return r},getPartIndex:function(t,i){var n=t.Part,r=e.indexOf(n,e.findWhere(n,{key:i}));return r},getPartCount:function(e){return e?e.Part.length:0
},getStreams:function(t,i){var n=[];if(t){var r=e.first(t.Part);r&&r.Stream&&n.push.apply(n,e.where(r.Stream,i))}return n},getSelectedVideo:function(t){var i=s.getStreamTypeByString("video"),n=this.getStreams(t,{streamType:i.id});return e.first(n)},getSelectedAudio:function(t){var i=s.getStreamTypeByString("audio"),n=this.getStreams(t,{streamType:i.id,selected:!0});return e.first(n)},getSelectedSubtitles:function(t){var i=s.getStreamTypeByString("subtitles"),n=this.getStreams(t,{streamType:i.id,selected:!0}),r=e.first(n);
return r&&r.id>0?r:void 0},selectStream:function(t,i,n){if(t){var r=this.getStreams(t,{streamType:i.id});e.each(r,function(e){e.selected=e.id===n})}},getMissingParts:function(t){var i=[];return e.isArray(t)||(t=[t]),e.each(t,function(t){var n=t.Part;n&&e.each(n,function(e){(e.exists===!1||e.accessible===!1)&&i.push(e)})}),i},getRelativeOffset:function(e,t,i){var n=i;if(e.Part.length>1)for(var r=0,s=e.Part.length;s>r;r++){var a=e.Part[r];if(!a.duration)break;if(t.key===a.key)break;n-=a.duration}return n
},getAbsoluteOffset:function(e,t,i){var n=i;if(e.Part.length>1)for(var r=0,s=e.Part.length;s>r;r++){var a=e.Part[r];if(!a.duration)break;if(t.key===a.key)break;n+=a.duration}return n},getPartByAbsoluteOffset:function(t,i){var n;if(t.Part.length>1)for(var r=0,s=0,a=t.Part.length;a>s&&(n=t.Part[s],n.duration)&&(r+=n.duration,!(r>i));s++);else n=e.first(t.Part);return n},getScreenshotIndex:function(t,i){if(t.indexes){var n=t.indexes.split(",");if(n.length)return e.indexOf(n,i)>-1?i:n[0]}},getScreenshotUrl:function(e,t,i){var n=this.getPartByAbsoluteOffset(e,t);
if(i=this.getScreenshotIndex(n,i)){var r=this.getRelativeOffset(e,n,t);return n.key.replace(/[^\/]*$/,"")+"indexes/"+i+"/"+r}},getSeasonIndex:function(e){var t=e.seasonPrefix||"S{1}",i=e.seasonIndex;return i>1e3?i:(e.noLeadingZero||(i=r.leadingZero(i)),n(t,i))},getSeasonEpisodeIndex:function(e){var t=e.seasonPrefix||"S{1}",s=e.episodePrefix||"E{1}",a=e.seasonIndex,o=e.episodeIndex;return o>0&&1e3>a?(e.noLeadingZero||(a=r.leadingZero(a),o=r.leadingZero(o)),n(t,a)+n(s,o)):e.date?i(e.date).format("M/D/YY"):""
},getEpisodeIndex:function(e){var t=e.episodePrefix||"E{1}",s=e.episodeIndex||0;return s>0?(e.noLeadingZero||(s=r.leadingZero(s)),n(t,s)):e.date?i(e.date).format("M/D/YY"):""}};return o}),define("plex/base/utils/playerQualities",["underscore","plex/base/utils/mediaUtil","plex/base/adapters/loggerAdapter"],function(e,t,i){var n={bitrates:[64,96,208,320,720,1500,2e3,3e3,4e3,8e3,1e4,12e3,2e4],videoResolutions:["220x180","220x128","284x160","420x240","576x320","720x480","1280x720","1280x720","1280x720","1920x1080","1920x1080","1920x1080","1920x1080"],videoQualities:[10,20,30,30,40,60,60,75,100,60,75,90,100],getQualityByIndex:function(e){return 0>e?{index:-1}:{index:e,bitrate:this.bitrates[e],videoResolution:this.videoResolutions[e],videoQuality:this.videoQualities[e]}
},getQualityAttribute:function(e){return e.isLibraryItem()?e.server.hasLocalConnection()?"localQuality":"remoteQuality":"channelQuality"},getCurrentQuality:function(t,n){var r=this.getQualityAttribute(t),s=n.get(r);return s>=this.bitrates.length&&(i.warn("Quality index "+s+" is out of bounds"),s=n.defaults[r],n.save(r,s)),e.extend(this.getQualityByIndex(s),{attribute:r})},getAvailableQualities:function(e){e||(e={});for(var t=e.lowestQualityIndex,i=e.highestQualityIndex,n=e.comparator,r=[],s=0,a=this.bitrates.length;a>s;s++)if(!(t&&t>s)){if(i&&s>i)return r;
if(n&&n.call(this,s))return r;r.push(this.getQualityByIndex(s))}return r},getAvailableQualitiesFor:function(e,i,n){if(!e||!i)return[];var r=i.get("transcoderVideo"),s=i.get("transcoderVideoRemuxOnly"),a=t.getSelectedVideo(e),o=!(!a||!a.bitrate),l=!!e.videoResolution;if(!r||s||!o&&!l)return[];var u=o?this.getAvailableQualitiesBelowBitrate(a.bitrate,n):this.getAvailableQualitiesBelowResolution(e.videoResolution,n);return u},getAvailableQualitiesBelowBitrate:function(e,t){return t||(t={}),t.comparator=function(t){var i=this.bitrates[t];
return i>=e},this.getAvailableQualities(t)},getAvailableQualitiesBelowResolution:function(e,t){t||(t={});var i=this.getHeightFromResolution(e);return t.comparator=function(e){var t=this.videoResolutions[e],n=this.getHeightFromResolution(this.getResolutionFromSize(t));return n>=i},this.getAvailableQualities(t)},getResolutionFromSize:function(e){var t=e.split("x"),i=parseInt(t[1],10);return i>2560?"8k":i>1100?"4k":i>720?"1080":i>576?"720":i>480?"576":i>360?"480":"sd"},getHeightFromResolution:function(e){switch(e){case"8k":return 5120;
case"4k":return 2560;case"1080":return 1080;case"720":return 720;case"576":return 576;case"480":return 480;case"sd":return 360;default:return 360}},getNearestQualityIndex:function(e){if(!e)return-1;var t=this.bitrates.indexOf(e);if(0>t){t=0;for(var i=0;i<this.bitrates.length;i++){var n=this.bitrates[i];if(n>e)break;t=i}}return t}};return n}),define("plex/base/utils/Backlog",["underscore","plex/base/utils/BaseClass"],function(e,t){var i=t.extend({initialize:function(){this._entries=[]},wrapAll:function(t,i,n){e.each(t,function(e){this.wrap(e,i,n)
},this)},wrap:function(t,i,n){n[t]=e.wrap(n[t],e.bind(function(t){var r=e.toArray(arguments).slice(1);return i.call(n)?t.apply(n,r):void this.add({fn:t,args:r,context:n})},this))},add:function(e){this._entries.push(e)},process:function(){e.each(this._entries,function(e){var t=e.context||this;e.fn.apply(t,e.args)},this),this.clear()},clear:function(){this._entries.length=0}});return i}),define("plex/chromecast/utils/constants/castCustomMessages",[],function(){var e={PLAY:"PLAY",PAUSE:"PAUSE",STOP:"STOP",PREVIOUS:"PREVIOUS",NEXT:"NEXT",SKIPTO:"SKIPTO",SHOWDETAILS:"SHOWDETAILS",REFRESHPLAYQUEUE:"REFRESHPLAYQUEUE",SETSTREAM:"SETSTREAM",SETQUALITY:"SETQUALITY"};
return e}),define("plex/base/commands/server/testServerConnectionCommand",["underscore","jquery","plex/base/adapters/loggerAdapter"],function(e,t,i){function n(n){var r=n.server,s=n.connection,a=r.get("friendlyName"),o=r.url(s),l=t.Deferred();s.test&&"pending"===s.test.state()&&(s.aborting=!0,s.test.abort(),s.aborting=!1),i.log("Testing connection to "+a+" at "+o);var u=e.extend(r.getXHROptions(o),{timeout:r.timeout});u.data=e.extend(u.headers,u.data||{}),delete u.headers;var c=t.ajax(u);return s.test=c,c.always(function(){s.test=null
}),c.done(function(e,t,n){var u=r.parse(e),c=u&&u.machineIdentifier;!c||r.id&&u.machineIdentifier!==r.id?(i.warn(a+" is unavailable at "+o+" (Invalid Response)"),l.reject(r,s,n)):(i.success(a+" is available at "+o),l.resolve(r,s,u,o))}),c.fail(function(e){i.warn(a+" is unavailable at "+o+" (Status "+e.status+")"),l.reject(r,s,e)}),l.promise()}return n}),define("plex/base/commands/server/testServerImageCommand",["jquery","plex/base/adapters/loggerAdapter"],function(e,t){function i(i){var n,r=i.server,s=i.connection,a=r.get("friendlyName"),o=(new Date).getTime(),l=r.resolveUrl("/web/img/blank.png?cb="+o,{connection:s}),u=e.Deferred();
t.log("Testing image for "+a+" at "+l);var c=new Image;return c.onload=function(){c.onload=c.onerror=c.onabort=null,n=clearTimeout(n),t.success("Image test for "+a+" was successful. Show mixed content warning."),u.resolve(r,s)},c.onerror=c.onabort=function(){c.onload=c.onerror=c.onabort=null,n=clearTimeout(n),t.warn(a+" is unavailable at "+l),u.reject(r,s)},n=setTimeout(function(){c.onload=c.onerror=c.onabort=null,c.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",t.warn(a+" is unavailable at "+l+" (Timeout)"),u.reject(r,s)
},5e3),c.src=l,u.promise()}return i}),define("x2js",function(e){return function(){var t;return t||e.X2JS}}(this)),define("plex/base/utils/parser",["underscore","x2js","plex/base/adapters/loggerAdapter"],function(e,t,i){function n(t,i){e.isArray(i)?e.each(i,t):t(i)}var r=new t(!1,"",!0),s={parseXML:function(e){return r.xml_str2json(e)},replaceXMLElementNames:function(t,i,n){e.isArray(i)||(i=[i]);var r=i.join("|"),s=new RegExp("<("+r+")","g"),a=new RegExp("</("+r+")>","g");return t=t.replace(s,"<"+n+' elementName="$1"'),t=t.replace(a,"</"+n+">")
},parseEncodedString:function(e,t){function i(t){if(e.hasOwnProperty(t)){var i=e[t];e[t]=null==i?"":decodeURIComponent(i)}}e&&n(i,t)},parseInteger:function(e,t){function i(t){if(e.hasOwnProperty(t)){var i=e[t];e[t]=null==i||""===i?0:parseInt(i,10)}}e&&n(i,t)},parseBoolean:function(e,t){function i(t){if(e.hasOwnProperty(t)){var i=e[t];e[t]=i===!0||"true"==i||"1"==i}}e&&n(i,t)},parseArray:function(t,i){function r(i){if(t.hasOwnProperty(i)){var n=t[i];e.isArray(n)||(t[i]=[n])}else t[i]=[]}t&&n(r,i)},parseQueryString:function(t,r,s){function a(n){if(t.hasOwnProperty(n)){var r=t[n];
if(!e.isObject(r))return e.isString(r)&&(r=r.trim().replace(/^(\?|#)/,""))?void(t[n]=e.reduce(r.split(s),function(e,t){var n=t.split("="),r=n[0],s=n[1];try{r=decodeURIComponent(r),s=void 0===s?null:decodeURIComponent(s),e.hasOwnProperty(r)?Array.isArray(e[r])?e[r].push(s):e[r]=[e[r],s]:e[r]=s}catch(a){i.warn("Unable to decode query string at "+r)}return e},{})):void(t[n]={})}}t&&(s||(s="&"),n(a,r))}};return s}),define("plex/base/mixins/models/populateMixin",["underscore","jquery","backbone","plex/base/utils/xhrTracker"],function(e,t,i,n){var r={hasPendingPopulate:function(){return!!this.populatePromise&&"pending"===this.populatePromise.state()
},populate:function(){return this.populatePromise||this.fetch.apply(this,arguments),this.populatePromise},fetch:function(){var n,r=t.Deferred();return this.hasPendingPopulate()?this.populatePromise:(n=this._fetch?this._fetch.apply(this,arguments):this instanceof i.Collection?i.Collection.prototype.fetch.apply(this,arguments):i.Model.prototype.fetch.apply(this,arguments),this.populatePromise=r.promise(),this.populatePromise.rid=n.rid,n.done(e.bind(function(e){r.resolveWith(this,[this,e]),this.resetPopulatePromise(t.Deferred().resolveWith(this,[this]).promise())
},this)),n.fail(e.bind(function(e){r.rejectWith(this,[this,e]),this.resetPopulatePromise(t.Deferred().rejectWith(this,[this]).promise())},this)),this.populatePromise)},abortPendingPopulate:function(){return this.hasPendingPopulate()&&n.abort(this.populatePromise.rid),this.populatePromise},resetPopulatePromise:function(e){return this.hasPendingPopulate()||(this.populatePromise=e),this.populatePromise},updatePopulatePromise:function(e){var i=this.populatePromise&&this.populatePromise.state();return i===e?this.populatePromise:(this.resetPopulatePromise(t.Deferred()),"resolved"===e?this.populatePromise.resolveWith(this,[this]):"rejected"===e&&this.populatePromise.rejectWith(this,[this]),this.populatePromise)
}};return r}),define("plex/base/models/BaseCollection",["underscore","backbone","jquery","plex/base/utils/parser","plex/base/utils/cache/CollectionCache","plex/base/mixins/models/populateMixin"],function(e,t,i,n,r,s){var a=t.Collection.extend({mixins:[s],cache:new r,constructor:function(e,n){if(n||(n={}),this.server=n.server,this.section=n.section,this.channel=n.channel,this.device=n.device,this.parent=n.parent,this.allowInCache=n.allowInCache,this.persistInCache=n.persistInCache,this.skipCache=n.skipCache,n.url&&(this.url=n.url),n.path&&(this.path=n.path),(null!=n.pageStart||null!=n.pageSize)&&(this.pageStart=n.pageStart||0,this.pageSize=n.pageSize||0),n.populated&&this.resetPopulatePromise(i.Deferred().resolve().promise()),!n.allowInCache)return void t.Collection.prototype.constructor.apply(this,arguments);
this.initialize.apply(this,arguments);var r=this.cache.getItemCacheKey(this),s=this.cache.get(r);return s?s:n.onlyIfCached?{}:(t.Collection.prototype.constructor.apply(this,arguments),void this.cache.store(this,r))},sync:function(){return this.allowInCache&&this.cache.store(this),t.sync.apply(this,arguments)},syncUrl:function(){var t="";if(this.url&&(t=e.result(this,"url")),this.path){var n=e.result(this,"path");t+="/"!==t.substr(t.length-1)?"/":"",t+="/"===n[0]?n.substr(1):n}if(null!=this.pageStart||null!=this.pageSize){var r=this.pageStart||0,s=this.pageSize||0,a={};
a["X-Plex-Container-Start"]=r,a["X-Plex-Container-Size"]=s;var o=t.indexOf("?"),l=t.length;t+=o>-1?l-1>o?"&":"":"?",t+=i.param(a,!0)}return t},convert:function(t,i){var r=e.isObject(t)?t:n.parseXML(t);if(!i)return r;var s=r[i];return s?(e.isArray(s)||(s=[s]),s):[]},clone:function(e){var t={server:this.server,section:this.section,parent:this.parent,url:this.url};return e||(e=this.models),new this.constructor(e,t)},cloneDeep:function(e){return e||(e=this.map(function(e){return e.clone()})),this.clone(e)
},clear:function(t){t=e.extend({silent:!0},t),this.abortPendingPopulate(),this.resetPopulatePromise(null),this.reset([],t)}});return a.extend=function(){var e=t.Collection.extend.apply(this,arguments);return e.prototype.cache=new r,e},a}),define("plex/base/models/BaseModel",["underscore","backbone","jquery","plex/base/utils/parser","plex/base/utils/cache/ModelCache","plex/base/mixins/models/populateMixin"],function(e,t,i,n,r,s){var a=t.Model.extend({mixins:[s],cache:new r,constructor:function(i,n){i||(i={}),n||(n={}),this.server=this.findOption(n,"server"),this.section=this.findOption(n,"section"),this.channel=this.findOption(n,"channel"),this.device=this.findOption(n,"device"),this.parent=this.findOption(n,"parent");
var r=this.findOption(n,"skipCache");if(r)return void t.Model.prototype.constructor.apply(this,arguments);var s=this.cache.getItemCacheKey(this,i),a=this.cache.get(s);if(a)return n.parse&&(i=a.parse.call(a,i)),this.preserveCachedAttributes&&this.preserveCachedAttributes(n.url)?e.each(i,function(t,i){e.isUndefined(a.get(i))&&!e.isUndefined(t)&&a.set(i,t)}):a.set(i),a.server=this.server||a.server,a.section=this.section||a.section,a.channel=this.channel||a.channel,a.device=this.device||a.device,a.parent=this.parent||a.parent,a;
var o=this.findOption(n,"onlyIfCached");return o?{}:(t.Model.prototype.constructor.apply(this,arguments),void this.cache.store(this,s))},findOption:function(e,t){return e[t]||e.collection&&e.collection[t]},clone:function(){var e={server:this.server,section:this.section,channel:this.channel,parent:this.parent,skipCache:!0};return new this.constructor(this.attributes,e)||null},convert:function(t){var i=e.isObject(t)?t:n.parseXML(t);return i},parse:function(t){var i=this.convert(t);return this.whitelistedAttrs&&(i=e.pick(i,this.whitelistedAttrs)),i
},save:function(n,r,s){var a,o,l,u=this.attributes;null==n||"object"==typeof n?(a=n,s=r):(a={})[n]=r,s=e.extend({validate:!0},s);var c=this.getSaveParams(a,s);if(e.extend(c,s.data),a&&!s.wait){if(!this.set(a,s))return!1}else if(!this._validate(a,s))return!1;if(a&&s.wait&&(this.attributes=e.extend({},u,a)),e.isEmpty(c)&&!s.force)return s.success&&s.success(this),i.Deferred().resolve(this);void 0===s.parse&&(s.parse=!0);var d=this,h=s.success;s.success=function(t){if(d.attributes=u,t){var i=d.parse(t,s);
if(s.wait&&(i=e.extend(a||{},i)),e.isObject(i)&&!d.set(i,s))return!1;d.cache.store(d)}h&&h(d,t,s),d.trigger("sync",d,t,s)},t.wrapError(this,s),o=this.isNew()?"create":s.patch?"patch":"update","patch"===o&&(s.attrs=a);var p=e.result(this,"saveUrl")||e.result(this,"url");if(!e.isEmpty(c)){var f=p.indexOf("?")>0?"&":"?";s.url=p+f+i.param(c,!0)}return s.data="",l=this.sync(o,this,s),a&&s.wait&&(this.attributes=u),l},getSaveParams:function(e){return this.isNew()?e||this.toJSON():this.changedAttributes(e)||{}
},getScopedKey:function(t){return null!=t&&e.isFunction(this.cacheKey)?this.cacheKey(this.attributes)+"!"+t:t}});return a.extend=function(){var e=t.Model.extend.apply(this,arguments);return e.prototype.cache=new r,e},a}),define("plex/base/models/settingsModel",["underscore","plex/base/utils/browser","plex/base/models/StorageModel"],function(e,t,i){var n=window.navigator.language||window.navigator.userLanguage||"en";n=n.split("-")[0];var r=i.extend({storageKey:"settingsv2",plexPassSettings:["syncVideoQuality","syncAudioQuality","syncPictureQuality"],defaults:{language:n,autoLogin:!1,playThemeMusic:!1,keyboardShortcuts:!0,showUnwatchedIcons:!1,debugLevel:0,dashboardPriorityOnDeck:1,dashboardPriorityRecentlyAdded:2,dashboardPriorityChannels:3,dashboardPriorityQueue:4,dashboardPriorityRecommendations:5,dashboardOnDeckEnabled:!0,dashboardRecentlyAddedEnabled:!0,dashboardChannelsEnabled:!0,dashboardQueueEnabled:!0,dashboardRecommendationsEnabled:!0,sharedSearch:!0,channelSearch:!0,localQuality:-1,remoteQuality:8,channelQuality:-1,dash:!0,directPlay:!0,directStream:!0,autoResolution:!0,preferAAC:"wiiu"===t.id,allowAC3:!1,subtitleSize:100,audioBoost:100,syncVideoQuality:"medium",syncAudioQuality:"medium",syncPictureQuality:"medium",sidebarOpen:!1,videoPlayerVolume:100,musicPlayerVolume:100,announcementsLastReadTimestamp:0,serverUpdateDismissedVersion:"",listType:"media-tile-list","listType!track":"media-list"},getListTypeKey:function(e){var t="listType";
return e&&(t+="!"+e.get("typeString")),t},getListType:function(t){var i,n;return t=t||{},e.has(t,"mediaType")&&e.isObject(t.mediaType)&&(n=this.getListTypeKey(t.mediaType)),i=this.get(n)||this.get(t.fallbackKey)||this.get("listType")},saveListType:function(t,i){var n=this.getListTypeKey(t);this.save(n,i),e.isEqual(n,"listType")||this.trigger("change:listType",this,i)},getSectionListType:function(e,t){var i;return e&&(t=t||e.get("currentType"),i=e.getScopedKey("listType")),this.getListType({mediaType:t,fallbackKey:i})
}});return new r}),define("plex/base/models/AnnouncementModel",["underscore","plex/base/models/BaseModel","plex/base/models/settingsModel"],function(e,t,i){var n=t.extend({whitelistedAttrs:["promo","timestamp","link","thumb","title","description"],initialize:function(){this.listenTo(i,"change:announcementsLastReadTimestamp",this.onTimestampChange),this.onTimestampChange()},parse:function(t){return e.pick(t,this.whitelistedAttrs)},onTimestampChange:function(){this.set("isUnread",this.get("timestamp")>i.get("announcementsLastReadTimestamp"))
}});return n}),define("plex/base/models/AnnouncementCollection",["plex/base/models/BaseCollection","plex/base/models/AnnouncementModel"],function(e,t){var i=e.extend({model:t,url:"https://plex.r.worldssl.net/announcements/announcements.json?cb="+(new Date).getTime(),parse:function(e){return JSON.parse(e)}});return i}),define("plex/base/models/debug/debugModel",["underscore","backbone","plex/base/utils/browser"],function(e,t,i){var n=t.Model.extend({initialize:function(){this.set("host",window.location.host),this.set("userAgent",window.navigator.userAgent),this.set("browser",i)
},toJSON:function(){var i=this.parent.get("primaryServer"),n=this.parent.get("user"),r=n.get("features");return this.set("version",this.parent.get("version")),i&&(this.set("primaryServerUrl",i.url()),this.set("primaryServerAuthToken",!!i.get("accessToken")),this.set("primaryServerVersion",i.get("versionFull"))),this.set("username",n.get("username")),this.set("cloudUrl",n.server.get("connections")),this.set("cloudAccessToken",!!n.server.get("accessToken")),r&&this.set("userFeatures",e.keys(r).join(", ")),t.Model.prototype.toJSON.apply(this,arguments)
}});return new n}),define("plex/base/models/debug/LogModel",["backbone"],function(e){var t=e.Model.extend({initialize:function(){this.set("time",new Date)}});return t}),define("plex/base/models/debug/LogCollection",["underscore","jquery","backbone","plex/base/adapters/loggerAdapter","plex/base/models/settingsModel","plex/base/models/debug/debugModel","plex/base/models/debug/LogModel"],function(e,t,i,n,r,s,a){var o=/(auth_token=|accessToken=|X-Plex-Token=)(\"?\w+\"?)/g,l=/(email=)(\"?[^&]+\"?)/g,u=/(password=)([^&]+)/,c=/(address=|host=)(\"?[^&]+\"?)/g,d=function(e){return e=e.replace(o,"$1TOKEN"),e.replace(u,"$1PASSWORD")
},h=function(e){return e&&e.hasOwnProperty("X-Plex-Token")&&(e["X-Plex-Token"]="TOKEN"),e&&e.hasOwnProperty("Authorization")&&(e.Authorization="BASIC AUTHORIZATION"),e},p=function(e){return e?(e=e.replace(o,'$1"TOKEN"'),e=e.replace(l,'$1"EMAIL"'),e=e.replace(c,'$1"IP ADRRESS"')):void 0},f=i.Collection.extend({model:a,initialize:function(t,i){e.bindAll(this,"onAjaxComplete"),this.parent=i.parent,s.parent=i.parent,r.on("change:debugLevel",this.onDebugLevelChange,this),n.on("change:instance",this.onLoggerChange,this),this.updateLogger()
},updateLogger:function(){this.logger&&(this.logger.off("add",this.onLogAdd,this),this.logger=null),n.hasInstance()&&(this.logger=n.getInstance(),this.startListening())},startListening:function(){!this.enabled&&this.logger&&r.get("debugLevel")&&(this.logger.on("add",this.onLogAdd,this),i.history.on("route",this.onRoute,this),t(document).on("ajaxComplete",this.onAjaxComplete),this.enabled=!0)},stopListening:function(){this.logger.off("add",this.onLogAdd,this),i.history.off("route",this.onRoute,this),t(document).off("ajaxComplete",this.onAjaxComplete),this.reset(),this.enabled=!1
},add:function(){this.length>200&&this.shift(),i.Collection.prototype.add.apply(this,arguments)},toJSON:function(){var t=i.Collection.prototype.toJSON.apply(this,arguments);return t.unshift(e.extend({type:"info"},s.toJSON())),t},toJSONString:function(){return JSON.stringify(this.toJSON(),null,2)},onDebugLevelChange:function(e,t){0===t?this.stopListening():this.startListening()},onLoggerChange:function(){this.updateLogger()},onLogAdd:function(e){this.add(e)},onRoute:function(e,t,i){var n={type:"navigation",route:t,args:i,fragment:window.location.hash};
this.add(n)},onAjaxComplete:function(t,i,n){var s={type:"ajax",url:d(n.url),status:i.status};e.isEmpty(n.headers)||(s.headers=h(n.headers)),e.isEmpty(n.data)||(s.params=n.data),200===i.status?2===r.get("debugLevel")?s.response=p(i.responseText):s.responseLength=i.responseText.length:(s.statusText=i.statusText,s.response=p(i.responseText)),this.add(s)}});return f}),define("plex/base/mixins/serverMixin",["underscore","plex/base/adapters/dimensionsAdapter","plex/base/utils/parser","plex/base/models/settingsModel"],function(e,t,i,n){var r={idAttribute:"machineIdentifier",defaults:function(){return{friendlyName:"Unknown",cloud:!1,bundled:!1,relayed:!1,home:!1,shared:!1,synced:!1,mixedContent:!1,isCloudSync:!1,protocolCapabilities:[],sources:[]}
},whitelistedAttrs:["machineIdentifier","name","friendlyName","home","sourceTitle","accessToken","superToken","version","createdAt","updatedAt","protocol","protocolCapabilities","platform","platformVersion","startState","serverClass","synced","sync","multiuser","allowMediaDeletion","transcoderActiveVideoSessions","transcoderAudio","transcoderVideo","transcoderVideoRemuxOnly","flashInstalled","silverlightInstalled","soundflowerInstalled","myPlex","myPlexMappingState","myPlexSigninState","myPlexSubscription","myPlexUsername","product"],features:{splitApart:"0.9.7.0",merge:"0.9.7.0",batchEdit:"0.9.7.0",search:"0.9.7.0",advancedFilters:"0.9.7.0",cleanBundles:"0.9.7.0",timelineState:"0.9.7.2",firstRunPref:"0.9.7.3",artworkUpload:"0.9.7.9",sync:"0.9.7.10",universalTranscoder:"0.9.7.17",universalMusicTranscoder:"0.9.8.3",syncNotifications:"0.9.7.23",sharedSettings:"0.9.7.23",specificMediaDeletion:"0.9.7.23",dash:"0.9.8.6",chunkedHTTP:"0.9.9.3",streamingMKV:"0.9.9.4",hubFilters:"0.9.9.2",desktopStreamingMKV:"0.9.9.6",sectionSettings:"0.9.9.6",playQueues:"0.9.9.6",cancelAllUpdates:"0.9.9.10",hubFilterSigns:"0.9.9.12",imageFilters:"0.9.9.13",playlists:"0.9.9.13",playItemsBatchAdd:"0.9.9.16",updater:"0.9.11.1",labels:"0.9.11.2",publicNowPlaying:"0.9.11.3",reachability:"0.9.11.14",transientToken:"0.9.11.18"},cacheKey:function(e){return e.machineIdentifier
},url:function(e,t){e||(e=this.get("activeConnection")),t||(t={});var i=t.scheme||e.scheme||"http",n=t.address||e.address,r=t.port||e.port,s=i+"://"+n;return r&&(s+=":"+r),s+"/"},useHostedHttps:"https:"===window.location.protocol,convert:function(t){var n=e.isObject(t)?t:i.parseXML(t);return i.parseInteger(n,["createdAt","updatedAt","transcoderActiveVideoSessions"]),i.parseBoolean(n,["home","synced","sync","multiuser","allowMediaDeletion","transcoderAudio","transcoderVideo","transcoderVideoRemuxOnly","flashInstalled","silverlightInstalled","soundflowerInstalled","myPlex","myPlexSubscription"]),n&&"undefined"==typeof n.startState&&(n.startState=null),n
},parse:function(t){var i=this.convert(t);if(!i||!i.machineIdentifier)return null;var n=i.scheme,r=i.address,s=parseInt(i.port,10),a=i.localAddresses;i=e.pick(i,this.whitelistedAttrs),!this.get("shared")||i.sourceTitle||i.home?i.sourceTitle&&!i.home?i.friendlyName=i.sourceTitle:i.friendlyName||(i.friendlyName=i.name):delete i.friendlyName,i.sourceTitle&&(i.shared=!0),i.fullVersion=i.version;var o=/(\d+\.){2,3}\d+/.exec(i.version);return o&&(i.version=o[0]),i.protocolCapabilities&&(i.protocolCapabilities=i.protocolCapabilities.split(",")),"secondary"===i.serverClass&&(i.synced=!0),"cloudsync"===i.platform&&(i.isCloudSync=!0),i.accessToken&&this.set("accessToken",i.accessToken),r&&s&&this.addConnection({scheme:n,address:r,port:s,accessToken:i.accessToken}),a&&(a=a.split(","),e.each(a,function(e){this.addConnection({address:e,port:32400,accessToken:i.accessToken})
},this)),i},resolveUrl:function(e,t){if(t||(t={}),/^\w+:\/\//.test(e))return e;var i=this.get("accessToken"),n=t.useLoopback?"http://127.0.0.1:32400/":this.url(t.connection,t);return e&&(n+="/"===e[0]?e.substr(1):e),t.appendToken&&i?(n+=n.indexOf("?")>0?"&":"?",n+="X-Plex-Token="+i):n},getXHROptions:function(e){var t={};return t.url=this.resolveUrl(e),t.dataType="text",t.headers=this.getHeaders(),t},getHeaders:function(){var i=t.getInstance(),r=this.parent,s=r.get("user"),a=this.get("accessToken"),o=e.clone(i);
return a&&(o["X-Plex-Token"]=a),s&&s.get("username")&&(o["X-Plex-Username"]=s.get("username")),o["Accept-Language"]=n.get("language"),o},isLocalAddress:function(e){return this.isLoopbackAddress(e)||/(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^192\.168\.)/.test(e)},isLoopbackAddress:function(e){return/^(127(\.\d+){1,3}|[0:]+1|localhost|0\.0\.0\.0)$/.test(e)},supports:function(e){var t=this.features[e];return t?this.isVersionOrNewer(t):!1},isVersionOrNewer:function(e){var t=this.get("version");
if(e&&t){e=e.split("."),t=t.split(".");for(var i=0,n=e.length;n>i;i++)if(i<t.length){var r=parseInt(e[i],10),s=parseInt(t[i],10);if(s>r)return!0;if(r>s)return!1}return!0}return!0}};return r}),define("plex/base/utils/types/subsetTypes",["underscore","plex/base/utils/BaseClass"],function(e,t){var i=t.extend({types:[{key:"all",title:"All"},{key:"unwatched",title:"Unwatched"},{key:"newest",title:"Recently Released"},{key:"recentlyAdded",title:"Recently Added"},{key:"recentlyViewed",title:"Recently Viewed"},{key:"recentlyViewedShows",title:"Recently Viewed Shows"},{key:"onDeck",title:"On Deck"},{key:"folder",title:"By Folder"}],initialize:function(){this.byKey=e.reduce(this.types,function(e,t){return e[t.key]=t,e
},{})},getSubsetType:function(e){return this.byKey[e]}});return new i}),define("plex/base/models/library/section/SectionSubsetModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"key",whitelistedAttrs:["key","title","secondary"],whitelistedPrimarySubsets:["all","recentlyAdded","recentlyViewed","recentlyViewedShows","onDeck","newest","folder"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return t.parseBoolean(n,"secondary"),n
},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs),i.primary=!i.secondary&&e.contains(this.whitelistedPrimarySubsets,i.key),"all"===i.key&&(i.title="All"),i}});return n}),define("plex/base/models/library/section/SectionSubsetCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/library/section/SectionSubsetModel"],function(e,t,i){var n=t.extend({model:i,url:function(){return e.result(this.section,"url")},parse:function(e){return this.convert(e,"Directory")
},filterPrimaries:function(){var e=this.filter(function(e){return e.get("primary")});return this.clone(e)}});return n}),define("plex/base/models/library/section/MediaTypeModel",["underscore","plex/base/models/BaseModel"],function(e,t){var i=t.extend({defaults:{selected:!1},whitelistedAttrs:["id","typeString","title","element"],parse:function(t){var i=e.pick(t,this.whitelistedAttrs);return i}});return i}),define("plex/base/models/library/section/MediaTypeCollection",["plex/base/models/BaseCollection","plex/base/models/library/section/MediaTypeModel"],function(e,t){var i=e.extend({model:t});
return i}),define("plex/base/models/library/section/FilterOptionModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"key",whitelistedAttrs:["key","type","title"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs)}});return n}),define("plex/base/models/library/section/FilterOptionCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/library/section/FilterOptionModel"],function(e,t,i){var n=t.extend({model:i,url:function(){var t=e.result(this.section,"url"),i=t+"/"+this.parent.id;
return this.standalone||(i+="?"+this.getUrlParams()),i},initialize:function(e,t){this.standalone=t.standalone},getUrlParams:function(){var t={},i=[],n=this.section.get("currentType"),r=this.section.get("currentFilters");n&&(t.type=n.id),e.each(r,function(e){e.key!==this.parent.id&&e.values.length&&(t[e.key]=e.values.join(","))},this);for(var s in t)i.push("unviewedLeafCount"===s?s+">="+t[s]:s+"="+t[s]);return i.join("&")},parse:function(e){return this.convert(e,"Directory")},search:function(e){var t=this.filter(function(t){return t.get("title").toLowerCase().indexOf(e.toLowerCase())>-1
});return this.clone(t)}});return n}),define("plex/base/models/library/section/FilterModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel","plex/base/models/library/section/FilterOptionCollection"],function(e,t,i,n){var r=i.extend({idAttribute:"filter",whitelistedAttrs:["filter","filterType","key","title"],initialize:function(e){e||(e={}),this.set("options",new n([],{server:this.server,section:this.section,parent:this,standalone:e.standalone}))},convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);
return n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs)}});return r}),define("plex/base/models/library/section/FilterCollection",["underscore","jquery","plex/base/models/BaseCollection","plex/base/models/library/section/FilterModel"],function(e,t,i,n){var r=i.extend({model:n,comparator:"filterType",url:function(){var i=e.result(this.section,"url")+"/filters",n=this.section.get("currentType"),r={includeAdvanced:1};return n&&(r.type=n.id),i+"?"+t.param(r,!0)},parse:function(e){return this.convert(e,"Directory")
}});return r}),define("plex/base/models/library/section/LinearFilterModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel","plex/base/models/library/section/FilterOptionCollection"],function(e,t,i,n){var r=i.extend({idAttribute:"key",whitelistedAttrs:["secondary","key","title"],initialize:function(){this.set("options",new n([],{server:this.server,section:this.section,parent:this}))},convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return t.parseBoolean(n,"secondary"),n},parse:function(t){var i=this.convert(t);
return i.title=i.title.replace("By ",""),i=e.pick(i,this.whitelistedAttrs)}});return r}),define("plex/base/models/library/section/LinearFilterCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/library/section/LinearFilterModel"],function(e,t,i){var n=t.extend({model:i,url:function(){var t=e.result(this.section,"url");return t},parse:function(e){return this.convert(e,"Directory")},filterBySecondary:function(){var e=this.filter(function(e){return e.get("secondary")});return this.clone(e)
}});return n}),define("plex/base/models/library/section/SortModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"key",defaults:{selected:!1},whitelistedAttrs:["key","title","defaultDirection"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return n},parse:function(t){var i=this.convert(t);return i.defaultDirection=i["default"],i=e.pick(i,this.whitelistedAttrs)}});return n}),define("plex/base/models/library/section/SortCollection",["underscore","jquery","plex/base/models/BaseCollection","plex/base/models/library/section/SortModel"],function(e,t,i,n){var r=i.extend({model:n,url:function(){var i=e.result(this.section,"url")+"/sorts",n=this.section.get("currentType"),r={};
return n&&(r.type=n.id),i+"?"+t.param(r,!0)},parse:function(e){return this.convert(e,"Directory")}});return r}),define("plex/base/models/library/section/AlphanumericModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"key",whitelistedAttrs:["key","title","size"],url:function(){return"/library/sections/"+this.section.id+"/firstCharacter/"+this.id},convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return t.parseInteger(n,"size"),n
},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs)}});return n}),define("plex/base/models/library/section/AlphanumericCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/library/section/AlphanumericModel"],function(e,t,i){var n=t.extend({model:i,url:function(){var t=e.result(this.section,"url"),i=t+"/firstCharacter?"+this.getUrlParams();return i},getUrlParams:function(){var t={},i=[],n=this.section.get("currentType");n&&(t.type=n.id);var r=this.section.get("currentFilters");
e.each(r,function(e){e.values.length&&(t[e.key]=e.values.join(","))},this);for(var s in t)i.push("unviewedLeafCount"===s?s+">="+t[s]:s+"="+t[s]);return i.join("&")},parse:function(e){return this.convert(e,"Directory")}});return n}),define("plex/base/utils/types/mediaTypes",["underscore","plex/base/utils/BaseClass","plex/base/utils/formatters/stringUtil"],function(e,t,i){var n=t.extend({types:[{id:1,typeString:"movie",title:"Movie",plural:i.pluralize("Movie"),element:"video"},{id:2,typeString:"show",title:"Show",plural:i.pluralize("TV Show"),element:"directory",child:3,grandchild:4},{id:3,typeString:"season",title:"Season",plural:i.pluralize("Season"),element:"directory",parent:2,child:4},{id:4,typeString:"episode",title:"Episode",plural:i.pluralize("Episode"),element:"video",grandparent:2,parent:3},{id:5,typeString:"trailer",title:"Trailer",plural:i.pluralize("Trailer"),element:"video"},{id:6,typeString:"comic",title:"Comic",plural:i.pluralize("Comic"),element:"photo"},{id:7,typeString:"person",title:"Person",plural:i.pluralize("Person",null,"People"),element:"directory"},{id:8,typeString:"artist",title:"Artist",plural:i.pluralize("Artist"),element:"directory",child:9,grandchild:10},{id:9,typeString:"album",title:"Album",plural:i.pluralize("Album"),element:"directory",parent:8,child:10},{id:10,typeString:"track",title:"Track",plural:i.pluralize("Track"),element:"audio",grandparent:8,parent:9},{id:11,typeString:"picture",title:"Picture",plural:i.pluralize("Picture"),element:"photo"},{id:12,typeString:"clip",title:"Clip",plural:i.pluralize("Clip"),element:"video"},{id:13,typeString:"photo",title:"Photo",plural:i.pluralize("Photo"),element:"photo",parent:14},{id:14,typeString:"photoAlbum",title:"Photo Album",plural:i.pluralize("Photo Album"),element:"directory",child:13},{id:15,typeString:"playlist",title:"Playlist",plural:i.pluralize("Playlist"),element:"directory"},{id:16,typeString:"playlistFolder",title:"Playlist",plural:i.pluralize("Playlist"),element:"directory",child:15},{id:1001,typeString:"userPlaylistItem",title:"Clip",plural:i.pluralize("Clip"),element:"video"}],initialize:function(){this.byID=e.reduce(this.types,function(e,t){return e[t.id]=t,e
},{}),this.byType=e.reduce(this.types,function(e,t){return e[t.typeString]=t,e},{})},getMediaType:function(e){return this.byID[e]},getMediaTypeByString:function(e){return this.byType[e]},getRelatedMediaTypes:function(t){var i=this.byType[t];if(!i)return[];var n=["grandparent","parent","child","grandchild"],r=e.compact(e.map(n,e.bind(function(e){return i.hasOwnProperty(e)?this.byID[i[e]]:void 0},this)));return r.unshift(i),r},getChildMediaType:function(e){var t=this.byType[e];if(t){var i=t.grandchild||t.child;
return i?this.byID[i]:t}},typeHasChildMedia:function(e){var t=this.getChildMediaType(e);return t?t.typeString!==e:!1}});return new n}),define("plex/base/utils/rangeUtil",["underscore"],function(e){function t(t){var i=e.clone(t);return"undefined"!=typeof i.last?(i.end=i.last+1,i.size=i.end-i.start):"undefined"!=typeof i.size?(i.end=i.start+i.size,i.last=i.end-1):"undefined"!=typeof i.end&&(i.last=i.end-1,i.size=i.end-i.start),i}function i(i,n){return e.filter(e.map(i,t),function(e){return n?e.size>=0:e.size>0
})}var n={difference:function(e,n,r){e=t(e),n=t(n);var s=[{start:e.start,last:Math.min(e.last,n.start-1)},{start:Math.max(e.start,n.end),last:e.last}];return i(s,r)},union:function(e,n,r){if(e=t(e),n=t(n),e.start>n.start){var s=e;e=n,n=s}var a=[e];return n.start<=e.end?a[0].last=Math.max(n.last,e.last):a.push(n),i(a,r)},degap:function(e,i){var n=t(e);return i=t(i),i.size?(n.start>i.end&&(n={start:i.end,end:n.end}),n.end<i.start&&(n={start:n.start,end:i.start}),t(n)):n},each:function(e,i,n){e=t(e);
for(var r=Math.min(e.start,e.end),s=Math.max(e.start,e.end);s>=r;r++)i.call(n,r)},roundByPage:function(e,i){return e=t(e),t({start:Math.floor(e.start/i)*i,end:Math.ceil(e.end/i)*i})}};return n}),define("plex/base/mixins/models/paginationMixin",["underscore","jquery","plex/base/utils/rangeUtil"],function(e,t,i){var n={fetchRange:function(e){return e.remove=!1,e.scope="page",e.prepend&&(e.at=0),this.pageStart=e.start,this.pageSize=e.size,this.fetch(e).promise()},populateRange:function(n){var r=t.Deferred();
if(this.hasPendingPopulate())return r.reject().promise();this.populatedRange||(this.populatedRange={start:0,end:0});var s=i.difference(n,this.populatedRange)[0];if(!s)return r.resolve().promise();if(s=i.degap(s,this.populatedRange),n.reloadThreshold&&s.size>n.reloadThreshold)return this.clear(),this.populatedRange={start:0,end:0},this.populateRange(e.omit(n,"reloadThreshold"));var a=e.extend(n,s);a.prepend=s.start<this.populatedRange.start;var o=this.fetchRange(a);return o.done(e.bind(function(e){this.populatedRange={start:i.union(this.populatedRange,s)[0].start,size:e.length},r.resolve(e)
},this)),o.fail(r.reject),r.promise()},remove:function(t){var i=e.isArray(t)?t.length:1;this.populatedRange&&this.populatedRange.end&&(this.populatedRange.end-=i)}};return n}),define("plex/base/utils/constants/timelineEvents",[],function(){var e={CREATED:0,MATCHING:2,DOWNLOADING_METADATA:3,LOADING_METADATA:4,PROCESSED:5,ANALYZING:6,DELETED:9};return e}),define("plex/base/models/library/MetadataModel",["require","underscore","jquery","plex/base/utils/t","plex/base/utils/parser","plex/base/utils/mediaUtil","plex/base/utils/types/mediaTypes","plex/base/utils/types/streamTypes","plex/base/utils/formatters/stringUtil","plex/base/utils/constants/timelineEvents","plex/base/models/BaseModel"],function(e,t,i,n,r,s,a,o,l,u,c){var d=c.extend({idAttribute:"ratingKey",defaults:{title:"",titleSort:"",tagline:"",rating:"",summary:"",year:"",studio:"",contentRating:"",originallyAvailableAt:"",originalTitle:"",thumb:"",parentThumb:"",grandparentThumb:"",banner:"",art:"",parentArt:"",grandparentArt:"",primaryExtraKey:""},omittedSaveAttrs:["updatedAt","thumb","banner","art","Media","Location"],tagAttrs:["Collection","Director","Writer","Genre","Country","Label"],subcollections:["Media","Genre","Collection","Field","Writer","Director","Role","Country","Location","Label"],url:function(){return this.get("key")
},urlRoot:function(){return this.get("key")},cacheKey:function(e){e.identifier&&!this.isLibraryItem(e)&&(e=this.normalizeKey(e));var t=this.normalizeChildrenKey(e.key);return this.server&&this.server.getScopedKey(t.key)},preserveCachedAttributes:function(e){return/\/(children|library\/sections\/\d+\/\w+)(\?.*)?$/.test(e)},initialize:function(){this.listenTo(this,"socket:timeline",function(e){e.state===u.PROCESSED?(this.fetch({data:"includeExtras=1"}),this.refreshChildren()):e.state===u.DELETED&&this.trigger("destroy",this,this.collection)
})},convert:function(e){var i=t.isObject(e)?e:r.parseXML(e);if(!i.ratingKey&&!i.key&&!i.id){var n=i.Directory||i.Video||i.Track||i.Photo||i;n.identifier=i.identifier,n.mediaTagPrefix=i.mediaTagPrefix,n.mediaTagVersion=i.mediaTagVersion,n.allowSync=i.allowSync,n.librarySectionID=i.librarySectionID,n.librarySectionUUID=i.librarySectionUUID,i=n}r.parseBoolean(i,["allowSync","selected"]),r.parseInteger(i,["index","parentIndex","duration","viewOffset","viewCount","leafCount","viewedLeafCount","extraType","lastViewedAt","addedAt","updatedAt"]),r.parseArray(i,this.subcollections);
var s=i.Media;return t.each(s,function(e){r.parseBoolean(e,["indirect","optimizedForStreaming","premium"]),r.parseInteger(e,["id","duration","width","height","bitrate","audioChannels"]),r.parseArray(e,"Part");var i=e.Part;t.each(i,function(e){r.parseBoolean(e,"optimizedForStreaming"),r.parseInteger(e,["id","duration","size"]),r.parseEncodedString(e,"file"),r.parseArray(e,"Stream"),e.exists="0"!==e.exists,e.accessible="0"!==e.accessible;var i=e.Stream;t.each(i,function(e){r.parseBoolean(e,"selected"),r.parseInteger(e,["id","index","streamType","duration","width","height","bitrate","bitDepth","samplingRate","channels"])
})})}),i},parse:function(i){var r=this.convert(i);if(!r.key)return r;this.isLibraryItem(r)||(r=this.normalize(r)),"photo"===r.type&&/\/children$/.test(r.key)&&(r.type="photoAlbum"),"photoalbum"===r.type&&(r.type="photoAlbum"),r.isFolder=/\/folder\?parent\=/.test(r.key),r.isExtra=!!r.extraType;var a=e("plex/base/models/library/MetadataCollection"),l=e("plex/base/models/library/HubCollection");this.parseChildren(r,a),this.parseExtras(r,a),this.parseRelated(r,l),null!=r.viewedLeafCount&&(r.unviewedLeafCount=r.leafCount-r.viewedLeafCount);
var u=r.Media,c=o.getStreamTypeByString("subtitles");return t.each(u,function(e){var i=t.first(e.Part);if(i&&i.Stream){var r=i.Stream,a=s.getStreams(e,{streamType:c.id,selected:!0}),o={id:0,streamType:c.id,language:n("None")};a.length||(o.selected=!0),r.unshift(o)}}),t.defaults(r,this.defaults),r},parseChildren:function(e,t){var i=this.normalizeChildrenKey(e.key);if(i.hasChildren&&(e.key=i.key,!this.get("children"))){var n=new t([],{server:this.server,section:this.section,parent:this,url:i.previousKey});
this.set("children",n)}},parseExtras:function(e,t){if(e.Extras){var i,n,r=this.get("extras");e.Extras.size>0?(i=e.Extras,n=!0):(i=[],n=!1),r?r.set(i,{parse:n}):(r=new t(i,{server:this.server,section:this.section,parent:this,url:e.key+"/extras",populated:!0,parse:n}),this.set("extras",r)),delete e.Extras}},parseRelated:function(e,t){if(e.Related){var i,n,r=this.get("related");e.Related.Hub?(i=e.Related,n=!0):(i=[],n=!1),r?r.reset(i,{parse:n}):(r=new t(i,{server:this.server,section:this.section,parent:this,populated:!0,parse:n}),this.set("related",r)),delete e.Related
}},normalize:function(e){return e=this.normalizeKey(e),e=this.normalizeType(e),e=this.normalizeMetadata(e)},normalizeChildrenKey:function(e){var t=/(.*)\/children$/.exec(e),i=e;return t&&(e=t[1]),{key:e,previousKey:i,hasChildren:!!t}},normalizeKey:function(e){var t=e.key.split("/");return 1===t.length&&e.containerKey&&(e.hasInvalidKey=!0,e.originalKey=e.key,e.key=e.containerKey+"/"+e.key),e.ratingKey||(e.ratingKey=e.originalKey||e.key),e},normalizeType:function(e){return e.mediaType&&!e.type&&(e.type=e.mediaType,delete e.mediaType),e.elementName&&!e.type&&(e.type=e.elementName.toLowerCase()),/image/i.test(e.type)?e.type="photo":/(movie|episode|video)/i.test(e.type)&&(e.type="clip"),a.getMediaTypeByString(e.type)||(e.type="channelDirectory"),e
},normalizeMetadata:function(e){return e.label?(e.title=e.label,delete e.label):e.artist&&(e.track?(e.title=e.track,e.originalTitle=e.artist,e.parentTitle=e.album,e.grandparentTitle=e.albumArtist):e.album?(e.title=e.album,e.parentTitle=e.artist):e.title=e.artist,delete e.track,delete e.album,delete e.albumArtist,delete e.artist),e.totalTime&&(e.duration=e.totalTime,delete e.totalTime),e},refreshChildren:function(){var e=this.get("children");if(e&&e.populatePromise){var t=e.fetch();t.always(function(){e.invoke("refreshChildren")
})}},resolveIndirect:function(e,n){var r=i.Deferred();if(!e||!n)return r.reject(this).promise();if(!e.indirect)return r.resolve(this).promise();if(n.postURL)return this.resolvePostUrl(e,n);var s=n.key;this.server.get("cloud")&&(s=this.server.resolveUrl(n.key,{connection:{address:"node.plexapp.com",port:32400}}));var a=i.ajax(this.server.getXHROptions(s));return a.done(t.bind(function(t){this.mergeIndirectResponse(t,e,n)?r.resolve(this):r.reject(this)},this)),a.fail(t.bind(function(){r.reject(this)
},this)),r.promise()},resolvePostUrl:function(e,n){var r=i.Deferred(),s=this.server.get("cloud")||this.server.get("synced"),a=s?this.server.parent.get("primaryServer"):this.server,o=a.getXHROptions("/system/proxy");if(!a)return r.reject(this).promise();o.headers=o.headers||{},o.headers["X-Plex-Url"]=n.postURL;var l=i.ajax(o);return l=l.then(t.bind(function(e,t,r){var s=n.key+"&postURL="+encodeURIComponent(n.postURL),a=r.getAllResponseHeaders()+"\r\n"+e;this.server.get("cloud")&&(s=this.server.resolveUrl(s,{connection:{address:"node.plexapp.com",port:32400}}));
var o=this.server.getXHROptions(s);return o.type="POST",o.data=a,i.ajax(o)},this)),l.done(t.bind(function(t){this.mergeIndirectResponse(t,e,n)?r.resolve(this):r.reject(this)},this)),l.fail(t.bind(function(){r.reject(this)},this)),r.promise()},mergeIndirectResponse:function(e,i,n){var s=r.parseXML(e);if(!(s&&s.Video&&s.Video.Media&&s.Video.Media.Part))return!1;var a=this.parse(s.Video),o=t.first(a.Media),l=t.first(o.Part);if(o.Part.length>1){var u=t.indexOf(i.Part,n);u<o.Part.length&&(l=o.Part[u])
}if(!o||!l)return!1;if(o.indirect=!1,t.extend(i,t.omit(o,"Part")),t.extend(n,l),s.httpHeaders){for(var c,d=new RegExp("([^=]+)=([^&]+)&?","g"),h={};c=d.exec(s.httpHeaders);)c[1]in h?(t.isArray(h[c[1]])||(h[c[1]]=[h[c[1]]]),h[c[1]].push(c[2])):h[c[1]]=c[2];this.set("indirectHttpHeaders",h,{silent:!0})}return!0},getSaveParams:function(e){return t.each(e.Field,function(t){e[t.name+".locked"]=t.locked}),delete e.Field,t.each(this.tagAttrs,function(i){i in e&&(t.isEmpty(e[i])?e[l.lowerCaseFirstLetter(i)+"[]"]="":t.each(e[i],function(t,n){e[l.lowerCaseFirstLetter(i)+"["+n+"].tag.tag"]=t.tag
}),delete e[i])}),e},batchAdd:function(e,n,r){var s=t.pluck(e,"id").join(","),a="/library/metadata/"+s+"/"+n+"/add?tag="+encodeURIComponent(r),o=t.extend(this.server.getXHROptions(a),{type:"PUT"});return i.ajax(o)},getDownloadUrl:function(){var e=t.first(this.get("Media"));if(e){var i=t.first(e.Part);if(i&&i.key)return this.server.resolveUrl(i.key,{appendToken:!0})}return""},getFilepath:function(){var e=t.first(this.get("Media"));if(e){var i=t.first(e.Part);if(i)return i.file}return null},getLocation:function(){var e=t.first(this.get("Location"));
return e?e.path:this.getFilepath()},getMediaKey:function(){var e=t.first(this.get("Media")),i=this.get("key");if(e){var n=t.first(e.Part);if(n)return n.key}return i},isLibraryItem:function(e){var t=e?e.identifier:this.get("identifier");if(t)return"com.plexapp.plugins.library"===t;var i=e?e.key:this.get("key");return/^(\/sync\/[A-Za-z0-9-\/]*)?\/library\//.test(i)}});return d}),define("plex/base/models/library/MetadataCollection",["underscore","plex/base/utils/parser","plex/base/mixins/models/paginationMixin","plex/base/models/BaseCollection","plex/base/models/library/MetadataModel"],function(e,t,i,n,r){var s=n.extend({mixins:i,model:r,subcollections:["Directory","Video","Track","Photo"],collectionProperties:["key","totalSize","viewGroup","allowSync","title","grandparentTitle","art"],url:function(){var t=this.section||this.parent;
return t?e.result(t,"url"):""},initialize:function(e,t){t||(t={}),this.allowAllLeaves=t.allowAllLeaves,this.populatedRange={start:0,end:0}},parse:function(i){var n=this.convert(this.mergeElements(i));null==n.totalSize&&(n.totalSize=n.size),t.parseInteger(n,"totalSize"),t.parseBoolean(n,"allowSync"),t.parseArray(n,"Metadata"),e.each(this.collectionProperties,function(e){var t=this[e],i=n[e],r=this.section?this.section.get("currentSubset").id:null,s=r&&"all"!==r&&"folder"!==r;s&&"totalSize"===e&&i>200&&(i=200),"totalSize"===e&&this.totalSizeAdjustment&&(i+=this.totalSizeAdjustment),void 0!==i&&t!==i&&(this[e]=i,this.trigger("change:"+e,this,i))
},this);var r=n.Metadata,s=e.result(this,"url");return e.each(r,function(e){e.containerKey=s,n.identifier&&(e.identifier=n.identifier),n.mediaTagPrefix&&(e.mediaTagPrefix=n.mediaTagPrefix),n.mediaTagVersion&&(e.mediaTagVersion=n.mediaTagVersion)}),this.allowAllLeaves?r:e.reject(r,function(e){var t=/\/allLeaves$/.test(e.key);return t&&this.totalSize&&(this.totalSize-=1,this.totalSizeAdjustment||(this.totalSizeAdjustment=0),this.totalSizeAdjustment-=1),t},this)},mergeElements:function(i){if(e.isString(i))i=t.replaceXMLElementNames(i,this.subcollections,"Metadata");
else if(e.isObject(i)&&!i.Metadata){var n=e.compact(e.pick(i,this.subcollections));i.Metadata=e.flatten(n,!0)}return i},remove:function(){n.prototype.remove.apply(this,arguments),i.remove.apply(this,arguments)},clear:function(){this.totalSize=null,this.trigger("change:totalSize",this,null),delete this.totalSizeAdjustment,this.populatedRange={start:0,end:0},n.prototype.clear.apply(this,arguments)},splitByType:function(){var e={};return this.each(function(t){var i=t.get("type");e.hasOwnProperty(i)?e[i].push(t):e[i]=[t]
}),e},filterByType:function(e){var t=this.filter(function(t){return t.get("type")===e});return this.clone(t)}});return s}),define("plex/base/models/library/SectionMetadataCollection",["underscore","plex/base/utils/types/mediaTypes","plex/base/models/library/MetadataCollection","plex/base/models/library/section/MediaTypeModel"],function(e,t,i,n){var r=i.extend({pageStart:0,pageSize:0,url:function(){var t=this.section.get("currentFolderKey");if(t)return t;var i=e.result(this.section,"url"),n=this.section.get("currentSubset"),r=n.id;
if(!this.section.get("allowAdvancedFilters")){var s=this.section.get("currentFilters");return s.length?s[0].values[0]:i+"/"+r}("recentlyAdded"===r||"newest"===r)&&(r="all");var a=i+"/"+r;return a+=a.indexOf("?")>-1?"&":"?",a+=this.getUrlParams()},initialize:function(){i.prototype.initialize.apply(this,arguments),this.server.get("synced")&&(this.pageStart=null,this.pageSize=null)},clear:function(){this.server.get("synced")?(this.pageStart=null,this.pageSize=null):(this.pageStart=0,this.pageSize=0),i.prototype.clear.apply(this,arguments)
},getUrlParams:function(){var e=this.getFilterUrlParams({sendType:!0});return this.section.get("refreshing")&&this.server.supports("timelineState")&&e.push("timelineState=1"),e.length?e.join("&"):""},getFilterUrlParams:function(i){i||(i={});var n={},r=[],s=this.getMediaType().id;i.sendType&&s&&s!==t.getMediaTypeByString("photo").id&&(n.type=s);var a=this.section.get("currentFilters");e.each(a,function(e){e.values.length&&(n[e.key]=e.values.join(","))});var o=this.getSort();o&&(n.sort=o);for(var l in n)r.push("unviewedLeafCount"===l?l+">="+n[l]:l+"="+n[l]);
return r},getMediaType:function(){var e=this.section.get("currentType"),i=this.section.get("currentSubset");if(e||(e=t.getMediaTypeByString(this.section.get("type")),this.section.set("currentType",new n(e))),/^(onDeck|recentlyAdded|recentlyViewed|newest)$/.test(i.id)){if(e.id===t.getMediaTypeByString("show").id)return t.getMediaTypeByString("episode");if(e.id===t.getMediaTypeByString("artist").id)return t.getMediaTypeByString("album")}return this.parent&&"season"===this.parent.get("type")?t.getMediaTypeByString("episode"):e
},getSort:function(){var e=this.section.get("currentSort"),t=this.section.get("currentSubset").id;return"recentlyAdded"===t?"addedAt:desc":"newest"===t?"originallyAvailableAt:desc":e?e.id+":"+e.get("direction"):!1}});return r}),define("plex/base/models/library/section/SectionModel",["underscore","plex/base/utils/parser","plex/base/utils/types/subsetTypes","plex/base/models/BaseModel","plex/base/models/library/section/SectionSubsetModel","plex/base/models/library/section/SectionSubsetCollection","plex/base/models/library/section/MediaTypeCollection","plex/base/models/library/section/FilterCollection","plex/base/models/library/section/LinearFilterCollection","plex/base/models/library/section/SortCollection","plex/base/models/library/section/AlphanumericCollection","plex/base/models/library/SectionMetadataCollection"],function(e,t,i,n,r,s,a,o,l,u,c,d){var h=n.extend({idAttribute:"key",persistInCache:!0,defaults:function(){return{isSection:!0,selecting:!1,selectedModels:[],currentType:null,currentFilters:[],currentSort:null,currentFirstCharacter:null,currentFolderKey:null}
},url:function(){if(this.isNew())return e.result(this,"urlRoot")||e.result(this.collection,"url");var t=e.isNaN(parseInt(this.id,10)),i=t?this.id:"/library/sections/"+this.id;return i},whitelistedAttrs:["key","uuid","title","type","thumb","art","language","agent","scanner","createdAt","updatedAt","allowAdvancedFilters","refreshing","Location"],whitelistedSaveAttrs:["name","title","type","agent","scanner","language","Location"],cacheKey:function(e){return this.server&&this.server.getScopedKey(e.key)
},initialize:function(){var t={server:this.server,section:this},n=this.get("allowAdvancedFilters")?o:l;this.set("currentSubset",new r(i.getSubsetType("all"),t)),this.set("subsets",new s([],t)),this.set("types",new a([],t)),this.set("filters",new n([],t)),this.set("sorts",new u([],t)),this.set("alphanumeric",new c([],t));var h=new d([],t);h.on("change:allowSync",e.bind(function(e,t){this.set("allowSync",t)},this)),this.set("items",h)},convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return t.parseBoolean(n,["filters","refreshing"]),t.parseInteger(n,["createdAt","updatedAt"]),t.parseArray(n,"Location"),n
},parse:function(t){var i=this.convert(t);return i.allowAdvancedFilters=i.filters,i=e.pick(i,this.whitelistedAttrs)},changedAttributes:function(){var t=n.prototype.changedAttributes.apply(this,arguments);return t&&(t=e.pick(t,this.whitelistedSaveAttrs)),t},getSaveParams:function(){var t=n.prototype.getSaveParams.apply(this,arguments);return t=e.pick(t,this.whitelistedSaveAttrs),"title"in t&&(t.name=t.title,delete t.title),e.isObject(t.type)&&(t.type=t.type.typeString),"Location"in t&&(t.location=e.map(t.Location,function(e){return e.path
}),delete t.Location),t},getSyncTitle:function(t){var i=this.get("title"),n=[],r=this.get("currentSubset"),s=this.get("currentFilters");return t?(e.each(t,function(e){n.push(e.get("title"))}),n=n.join(", "),i+": "+n):"all"!==r.id?i+": "+r.get("title"):s.length?(e.each(s,function(e){n.push(e.titles.join(", "))}),i+": "+n.join(",")):i}});return h}),define("plex/base/models/library/section/SectionCollection",["plex/base/models/BaseCollection","plex/base/models/library/section/SectionModel"],function(e,t){var i=e.extend({model:t,url:"/library/sections",parse:function(e){return this.convert(e,"Directory")
}});return i}),define("plex/base/models/library/PlayQueueItemModel",["underscore","plex/base/models/library/MetadataModel"],function(e,t){var i=t.extend({idAttribute:"playQueueItemID",propagatedAttributes:["viewOffset","viewCount"],cacheKey:function(e){return this.server&&this.server.getScopedKey(e.playQueueItemID)},initialize:function(){t.prototype.initialize.apply(this,arguments),this.listenTo(this,"change",function(){var i=this.changedAttributes(),n=e.intersection(e.keys(i),this.propagatedAttributes);
e.each(n,function(i){var n=new t({key:this.get("key")},{server:this.server,onlyIfCached:!0});e.isEmpty(n)||n.set(i,this.get(i))},this)})}});return i}),define("plex/base/models/library/PlayQueueItemCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/library/PlayQueueItemModel"],function(e,t,i){var n=t.extend({model:i,parse:function(i){return e.extend(this,e.pick(i,["totalSize","availableRange"])),t.prototype.parse.apply(this,arguments)}});return n}),define("plex/base/models/library/LocalPlayQueueModel",["underscore","jquery","backbone","plex/base/models/BaseModel","plex/base/utils/types/mediaTypes","plex/base/models/library/PlayQueueItemCollection","plex/base/models/library/PlayQueueItemModel"],function(e,t,i,n,r,s,a){var o=function(e){return e instanceof i.Collection?e:e.get("children")
},l=function(e){var t=e.get("type"),i="channelDirectory"===t,n=i||t&&"directory"===r.getMediaTypeByString(t).element||e.get("isFolder"),s=void 0===e.length;return s&&!n},u=function(t){var i=this.get("nextPlayQueueItemID");this.set("nextPlayQueueItemID",++i);var n=e.extend({},t.attributes,{playQueueItemID:i}),r=new a(n,{server:t.server,parent:t.parent});return r},c=n.extend({defaults:{selectedItem:null,mediaType:null,collection:null,owned:!0,lastAddedItem:null,hasUserAdditions:!1,nextPlayQueueItemID:0},url:"",initialize:function(e){this.set("mediaType",e.mediaType),this.set("collection",new s([],{type:e.mediaType,server:e.server}))
},fetch:function(){},queueContent:function(i,n,r){r||(r={});var s=t.Deferred().resolve().promise();return this.isItemQueueable(i)&&(i.get("children")&&e.result(i.get("children"),"url")&&(s=s.then(function(){return i.get("children").populate()})),s=s.done(e.bind(function(){this.set("lastAddedItem",i),this.get("collection").length&&this.set("hasUserAdditions",!0);var t=this.get("collection").indexOf(n);-1===t&&(t=0);var s=r.next?{at:t+1}:{},a=o(i);if(a){var c=a.filter(l);r.shuffle&&(c=e(c).shuffle());
var d=e.map(c,e.bind(u,this));this.get("collection").add(d,s)}else this.get("collection").add(u.apply(this,[i]),s);this.get("collection").trigger("reset",this.get("collection"))},this))),s},addContent:function(t,i){var n=this.queueContent(t,this.get("selectedItem"),i);return n.done(e.bind(function(){var e=null;i&&i.firstItem?e=this.get("collection").find(function(e){return e.get("key")===i.firstItem.get("key")}):this.get("collection").length&&(e=this.get("collection").at(0)),this.set("selectedItem",e)
},this)),n},removeItem:function(e){return e.get("playQueueItemID")===this.get("selectedItem").get("playQueueItemID")?t.Deferred().resolve().promise():(this.set("hasUserAdditions",!0),this.get("collection").remove(e),this.get("collection").trigger("reset",this.get("collection")),t.Deferred().resolve().promise())},moveItem:function(e,i){if(e===this.get("selectedItem").get("playQueueItemID"))return t.Deferred().resolve().promise();var n=this.get("collection"),r=n.findWhere({playQueueItemID:e});n.remove(r);
var s=i||this.get("selectedItem").get("playQueueItemID"),a=n.findWhere({playQueueItemID:s}),o=n.indexOf(a)+1;return this.set("hasUserAdditions",!0),n.add(r,{at:o}),n.trigger("reset",n),t.Deferred().resolve().promise()},isItemQueueable:function(t){if(t.get("currentSubset")&&"photo"!==t.viewGroup)return!1;if("photoAlbum"===t.get("type")&&!t.isLibraryItem())return!1;var i=["track","episode","movie","photo","clip","userPlaylistItem","photoAlbum","album","season"],n=e(i).contains(t.get("type")),r=o(t),s=r&&r.any(l);
return n||s},yieldOwnership:function(){var i=this.get("lastAddedItem"),n=e.result(i.get("children")||i,"url");return t.Deferred().resolve(n).promise()},takeOwnership:function(){return t.Deferred().resolve().promise()},release:function(){this.get("collection").release()},supports:function(e){return!(e&&(e.unwatched||e.remoteRefresh))}});return c}),define("plex/base/utils/contentUtil",["underscore","jquery","plex/base/utils/types/mediaTypes"],function(e,t,i){var n={uri:function(n,r){var s=r&&r.unwatched,a=n.get("librarySectionUUID")||n.get("uuid"),o=n.get("librarySectionID");
if(!a||!o){var l=n.server.getSectionForItem(n);e.isEmpty(l)||(a=l.get("uuid"),o=l.id)}var u="library://"+a,c=e(n).result("url");if(n.get("items")){var d=n.get("selecting")&&n.get("selectedModels").length;if(d&&n.server.supports("playItemsBatchAdd")){var h=e(n.get("items").models).pluck("id"),p=e(n.get("selectedModels")).pluck("id"),f=e.intersection(h,p);c="/library/metadata/"+f.join(","),u+="/directory/"+encodeURIComponent(c)}else{var m=n.get("items").getFilterUrlParams().slice(0),g=m.indexOf("unwatchedLeaves=1");
if(g>-1){var v=i.getChildMediaType(n.get("type")).typeString;m.splice(g,1,v+".unwatched=1")}m.push("sourceType="+n.get("currentType").id);var y=n.get("currentSubset").id;u+="/directory/"+encodeURIComponent(c),u+=encodeURIComponent("/"+y+"?"+m.join("&"))}}else if(s){c="/library/sections/"+o+"/all?";var b={"show.id":n.get("parentRatingKey")||n.get("ratingKey"),type:i.getMediaTypeByString("episode").id,unwatched:1,sort:"originallyAvailableAt,"},x=n.get("type");"show"===x?b.sort+="season.index,episode.index":"season"===x&&(b.sort+="index",b["season.id"]=n.get("ratingKey")),u+="/directory/"+encodeURIComponent(c+t.param(b,!0))
}else u+=e(n.models).isArray()?"/directory/"+encodeURIComponent(c):"/item/"+encodeURIComponent(c);return u}};return n}),define("plex/base/models/library/PlayQueueModel",["underscore","jquery","plex/base/models/BaseModel","plex/base/utils/contentUtil","plex/base/utils/parser","plex/base/models/library/PlayQueueItemCollection"],function(e,t,i,n,r,s){var a={audio:"Track",photo:"Photo",video:"Video"},o=i.extend({defaults:{selectedItem:null,mediaType:null,collection:null,server:null,owned:!0,allowedElement:null,hasUserAdditions:!1,playQueueID:null,playQueueVersion:0,playQueueSelectedItemID:null},url:function(){return"/playQueues/"+this.get("playQueueID")
},initialize:function(e,t){this.set("server",t.server),this.set("allowedElement",a[this.get("mediaType")]),this.set("collection",new s([],{server:t.server}))},_fetch:function(){var t=e.result(this,"url");return this._ajax("GET",t)},convert:function(t){var i=e.isObject(t)?t:r.parseXML(t);return r.parseInteger(i,"playQueueVersion"),r.parseArray(i,this.get("allowedElement")),i},parse:function(t){var i=this.convert(t);if(i.playQueueVersion>this.get("playQueueVersion")){var n=function(e){var t="playQueue"+e;
this.set(t,i[t])};e.each(["ID","Version","SelectedItemID","SelectedItemOffset"],n,this)}var r=i[this.get("allowedElement")],s=e(r).pluck("playQueueItemID").indexOf(i.playQueueSelectedItemID),a=parseInt(i.playQueueSelectedItemOffset,10),o=a-s;return e.each(r,function(e,t){e.queueIndex=o+t,i.identifier&&(e.identifier=i.identifier),i.mediaTagPrefix&&(e.mediaTagPrefix=i.mediaTagPrefix),i.mediaTagVersion&&(e.mediaTagVersion=i.mediaTagVersion)}),r.totalSize=parseInt(i.playQueueTotalCount,10),r.availableRange={start:o,end:o+r.length},r
},_ajax:function(i,n){var r=e.extend(this.get("server").getXHROptions(n),{type:i}),s=t.ajax(r),a=function(e){var t=this.parse(e);this.get("collection").reset(t,{parse:!0})};return s.done(e.bind(a,this)),s},queueContent:function(i,r){r||(r={});var s={type:this.get("mediaType")};return i.get("playlistType")?s.playlistID=i.get("ratingKey"):s.uri=n.uri(i,e(r).pick("unwatched")),r.firstItem&&(s.key=r.firstItem.get("key")),r.extrasPrefixCount&&(s.extrasPrefixCount=r.extrasPrefixCount),s.shuffle=r.shuffle?1:0,r.continuous&&"episode"===i.get("type")&&(s.continuous=1),this.get("playQueueID")?(s.next=r.next?1:0,this.set("hasUserAdditions",!0),this._addContentPromise=this._ajax("PUT",this.url()+"?"+t.param(s,!0))):this._addContentPromise=this._ajax("POST","/playQueues?"+t.param(s,!0)),this._addContentPromise
},addContent:function(t,i){var n=this.queueContent(t,i);return n.done(e.bind(function(){var e=null;i&&i.firstItem?e=this.get("collection").find(function(e){return e.get("key")===i.firstItem.get("key")}):this.get("collection").length&&(e=this.get("collection").at(0)),this.set("selectedItem",e)},this)),n},removeItem:function(e){if(e.get("playQueueItemID")===this.get("selectedItem").get("playQueueItemID"))return t.Deferred().resolve().promise();this.set("hasUserAdditions",!0);var i=this.url()+"/items/"+e.get("playQueueItemID");
return this._ajax("DELETE",i)},moveItem:function(e,i){if(e===this.get("selectedItem").get("playQueueItemID"))return t.Deferred().resolve().promise();var n=i||this.get("selectedItem").get("playQueueItemID");this.set("hasUserAdditions",!0);var r={after:n},s=this.url()+"/items/"+e+"/move?"+t.param(r);return this._ajax("PUT",s)},isItemQueueable:function(t){var i=e(t).result("url"),n=-1!==i.indexOf("/library/")||t.get("playlistType"),r=-1!==i.indexOf("/sync/"),s=-1!==i.indexOf("/folder"),a=t.get("type")&&("photoAlbum"===t.get("type")||"photo"===t.get("type")),o="photo"===t.viewGroup||a,l=!1;
return t.get("currentSubset")&&(l="all"!==t.get("currentSubset").id),n&&!r&&!s&&!o&&!l},yieldOwnership:function(){return this.set("owned",!1),this._addContentPromise.then(e.bind(function(){return this.get("collection").length>0?e.result(this,"url")+"?own=1&window=200":null},this))},takeOwnership:function(){var i=t.Deferred().resolve().promise();if(!this.get("owned")){this.set("owned",!0);var n=e.result(this,"url")+"?own=1";i=this._ajax("GET",n)}return i},release:function(){this.get("collection").release()
},supports:function(){return!0}});return o}),define("plex/base/models/library/PlayQueueManager",["underscore","plex/base/utils/BaseClass","plex/base/mixins/eventMixin","plex/base/utils/types/mediaTypes","plex/base/models/library/LocalPlayQueueModel","plex/base/models/library/PlayQueueModel"],function(e,t,i,n,r,s){var a=t.extend({mixins:i,initialize:function(e){this.server=e.server,this._queues={audio:null,photo:null,video:null},this.canCreateOnLocal=r.prototype.isItemQueueable,this.doesLocalSupport=r.prototype.supports
},createFor:function(e,t){t=t||e;var i;i=t.get("isPlaylist")?t.get("playlistType"):e.get("element")||n.getChildMediaType(t.get("type")).element;var a=null;return this.canCreateOnServer(e)?a=new s({mediaType:i},{server:this.server}):this.canCreateOnLocal(e)&&(a=new r({mediaType:i},{server:this.server})),this._queues[i]=a,this.trigger("change change:playQueue:"+i,a),a},getForType:function(e){return this._queues[e]},createForType:function(e,t){var i=null;return i=t.onServer?new s({mediaType:e},{server:this.server}):new r({mediaType:e}),this._queues[e]=i,this.trigger("change change:playQueue:"+e,i),i
},getFor:function(e){var t=e.get("type");if(!t||"channelDirectory"===t)return null;var i;i=e.get("isPlaylist")?e.get("playlistType"):e.get("element")||n.getChildMediaType(t).element;var r=this._queues[i];return r&&r.isItemQueueable(e)?r:null},remove:function(e){var t=this._queues[e];this._queues[e]=null,this.trigger("change remove:playQueue:"+e,t)},removeAll:function(){e.each(e.keys(this._queues),this.remove,this)},canCreateOnServer:function(e){return this.server.supports("playQueues")&&!this.server.get("synced")&&s.prototype.isItemQueueable(e)
},doesServerSupport:function(e){return this.server.supports("playQueues")&&s.prototype.supports(e)},canCreateFor:function(e,t){return this.canCreateOnServer(e)&&this.doesServerSupport(t)||this.canCreateOnLocal(e)&&this.doesLocalSupport(t)}});return a}),define("plex/base/models/library/PlaylistModel",["underscore","jquery","plex/base/utils/contentUtil","plex/base/models/BaseModel","plex/base/models/library/MetadataCollection","plex/base/utils/parser"],function(e,t,i,n,r,s){var a=n.extend({idAttribute:"ratingKey",whitelistedAttrs:["addedAt","composite","duration","key","leafCount","playlistType","ratingKey","smart","summary","title","type"],urlRoot:"/playlists",cacheKey:function(e){return e.key?this.server&&this.server.getScopedKey(e.key):void 0
},saveUrl:function(){return"/library/metadata/"+this.id},parse:function(e){var t=this.convert(e);if(t.Playlist&&(t=t.Playlist),s.parseInteger(t,["duration","leafCount","addedAt"]),s.parseBoolean(t,"smart"),!this.get("children")){var i=new r([],{server:this.server,parent:this});i.url="/playlists/"+t.ratingKey+"/items",this.set("children",i),i.once("add",function(e){this.set("art",e.get("art"))},this)}return t.isPlaylist=!0,t},moveItem:function(i,n){i=i.toString(),n&&(n=n.toString());var r=e.result(this,"url")+"/items/"+i+"/move";
n&&(r+="?"+t.param({after:n},!0));var s=e.extend(this.server.getXHROptions(r),{type:"PUT"}),a=t.ajax(s),o=this.get("children"),l=o.findWhere({playlistItemID:i});o.remove(l);var u=o.findWhere({playlistItemID:n}),c=u?o.indexOf(u)+1:0;return o.add(l,{at:c}),a},removeItem:function(i){i=i.toString();var n=e.result(this,"url")+"/items/"+i,r=e.extend(this.server.getXHROptions(n),{type:"DELETE"}),s=t.ajax(r);s.then(e.bind(function(e){this.set(this.parse(e))},this));var a=this.get("children"),o=a.findWhere({playlistItemID:i});
return a.remove(o),s},addContent:function(n){var r=this.isNew()?"POST":"PUT",s=this.url(),a={};this.isNew()?(a.type=this.get("playlistType"),a.title=this.get("title"),a.smart=this.get("smart")?1:0):s+="/items",n.get("playQueueID")?a.playQueueID=n.get("playQueueID"):a.uri=i.uri(n),s+="?"+t.param(a,!0);var o=e.extend(n.server.getXHROptions(s),{type:r}),l=t.ajax(o);return l.then(e.bind(function(e){this.set(this.parse(e))},this)),l.promise()},isLibraryItem:function(){return!0}});return a}),define("plex/base/models/library/PlaylistCollection",["plex/base/models/BaseCollection","plex/base/models/library/PlaylistModel"],function(e,t){var i=e.extend({model:t,comparator:"titleSort",url:function(){var e,t=this.filterOptions.get("currentSort");
e=t?t.id+":"+t.get("direction"):"titleSort:asc";var i="/playlists/all?type=15&sort="+e,n=this.filterOptions.get("currentType");return n&&(i+="&playlistType="+n),this.filterOptions.get("onlyDumb")&&(i+="&smart=0"),i},initialize:function(e,t){this.filterOptions=t.filterOptions},parse:function(e){return this.convert(e,"Playlist")}});return i}),define("plex/base/models/library/PlaylistsSectionModel",["underscore","plex/base/utils/t","plex/base/models/BaseModel","plex/base/models/library/section/SortCollection","plex/base/models/library/PlaylistCollection"],function(e,t,i,n,r){var s=i.extend({defaults:function(){return{pseudo:!0,title:t("Playlists"),currentType:0}
},initialize:function(){this.set("items",new r([],{filterOptions:this,server:this.server}));var e=new n([{key:"title",title:t("Name"),defaultDirection:"asc"},{key:"viewCount",title:t("Plays")},{key:"lastViewedAt",title:t("Last Played")},{key:"duration",title:t("Duration")},{key:"addedAt",title:t("Date Added")}],{section:this,server:this.server});this.set("sorts",e)}});return s}),define("plex/base/models/server/ServerCloudAccountModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({url:"/myplex/account",whitelistedAttrs:["username","mappingState","mappingError","mappingErrorMessage","signInState","publicAddress","publicPort","privateAddress","privatePort","subscriptionActive","subscriptionState"],defaults:{signedIn:!1,remoteAccessState:"",mappingState:"",mappingError:"",mappingErrorMessage:"",signInState:"",publicAddress:"",publicPort:"",privateAddress:"",privatePort:""},isNew:function(){return!this.get("signedIn")
},convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return e.defaults(n,e.result(this,"defaults")),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs),"ok"===i.signInState?i.signedIn=!0:(i.signedIn=!1,i.username=""),i.signedIn&&"mapped"===i.mappingState&&!i.mappingError?i.remoteAccessState="ok":(!i.signedIn||i.mappingError)&&(i.remoteAccessState="unreachable"),i},isWaiting:function(){var e=this.get("remoteAccessState");return"connecting"===e||"disconnecting"===e
}});return n}),define("plex/base/models/server/ServerUpdateModel",["underscore","jquery","plex/base/utils/dispatcher","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i,n,r){var s=r.extend({url:"/updater/status",whitelistedAttrs:["status","canInstall","downloadURL","state","progress","version","error","added","fixed"],defaults:{state:"none",progress:0,version:"",error:"",added:"",fixed:"",shouldInstall:!1},fetch:function(){return this.server.supports("updater")?r.prototype.fetch.apply(this,arguments):t.Deferred().reject().promise()
},convert:function(t){var i=e.isObject(t)?t:n.parseXML(t);return n.parseBoolean(i,"canInstall"),n.parseInteger(i,"status"),n.parseInteger(i.Release,"progress"),i},parse:function(t){var i=this.convert(t);return i=e.extend(i,i.Release),i=e.pick(i,this.whitelistedAttrs),0!==i.status&&(i.state="error"),i}});return s}),define("plex/base/models/server/ServerSettingModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"id",url:"/:/prefs",defaults:{type:"string",summary:"",label:"",group:""},whitelistedAttrs:["id","label","default","summary","value","type","group","advanced","option","hidden","enumValues","values"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);
return"bool"===n.type?t.parseBoolean(n,"value"):"int"===n.type&&t.parseInteger(n,"value"),t.parseBoolean(n,["advanced","hidden"]),n},parse:function(t){var i=this.convert(t);if(i=e.pick(i,this.whitelistedAttrs),i.enumValues&&!e.isArray(i.enumValues)&&(i.enumValues=e.map(i.enumValues.split("|"),function(e){var t=e.indexOf(":");return t>0?{label:e.slice(t+1),value:e.slice(0,t)}:{label:e,value:e}})),"enum"===i.type&&i.values&&!e.isArray(i.values)){var n=0;i.enumValues=e.map(i.values.split("|"),function(e){return{label:e,value:n++}
})}return i},getSaveParams:function(t){if(e.has(t,"FriendlyName")&&this.server.set("friendlyName",t.FriendlyName),e.has(t,"allowMediaDeletion")&&this.server.set("allowMediaDeletion","1"==t.allowMediaDeletion),e.isEmpty(t)){var i={};return i[this.get("id")]=this.get("value"),i}return"value"in t&&(t[this.get("id")]=t.value,delete t.value),t}});return n}),define("plex/base/models/server/ServerSettingCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/server/ServerSettingModel"],function(e,t,i){var n=t.extend({model:i,url:"/:/prefs",initialize:function(){this.server.on("socket:setting",function(e){var t=this.get(e.id);
t&&(e=t.parse(e),t.set("value",e.value),"FriendlyName"===e.id&&e.value?this.server.set("friendlyName",e.value):"allowMediaDeletion"===e.id&&this.server.set("allowMediaDeletion",e.value))},this)},parse:function(t){var i=this.convert(t,"Setting");return e.filter(i,function(e){return e.id})}});return n}),define("plex/base/models/PaginatedCollection",["plex/base/models/BaseCollection"],function(e){var t=e.extend({pageSize:10,pages:function(){return Math.max(Math.ceil(this.length/this.pageSize),1)},page:function(e,t){t||(t={});
var i,n=0;return i=t.reverse?this.length-e*this.pageSize:e*this.pageSize-this.pageSize,0>i&&(n=i,i=0),this.models.slice(i,i+this.pageSize+n)}});return t}),define("plex/base/models/server/ServerAlertModel",["plex/base/models/BaseModel"],function(e){var t=0,i=e.extend({idAttribute:"id",parse:function(e){var i=e;return i.time=new Date,i.id="evt"+t++,"preference"==i._type&&(i.value=i.value.toString()),i}});return i}),define("plex/base/models/server/ServerAlertCollection",["underscore","plex/base/models/PaginatedCollection","plex/base/models/server/ServerAlertModel"],function(e,t,i){var n=t.extend({model:i,url:"/servers",pageSize:20,limit:1e3,initialize:function(){this.startTime=new Date,this.listenTo(this.server,"socket:setting",this.onSettingChange),this.listenTo(this.server,"socket:timeline",this.onTimeline),this.listenTo(this.server,"socket:status",this.onStatus),this.listenTo(this.server,"socket:playing",this.onPlaying),this.listenTo(this.server,"socket:websocket",this.onWebSocket)
},add:function(){this.length+1>this.limit&&this.remove(this.at(0)),t.prototype.add.apply(this,arguments)},onSettingChange:function(t){this.add(e.extend({_type:"setting"},t),{parse:!0})},onTimeline:function(t){1===t.state||t.sectionID<0||this.add(e.extend({_type:"timeline"},t),{parse:!0})},onStatus:function(t){"ProgressNotification"!==t._elementType&&this.add(e.extend({_type:"status"},t),{parse:!0})},onPlaying:function(t){this.add(e.extend({_type:"playing"},t),{parse:!0})},onWebSocket:function(t){this.add(e.extend({_type:"websocket"},t),{parse:!0})
}});return n}),define("plex/base/models/server/TranscodeJobModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"syncItemId",whitelistedAttrs:["syncItemId","syncItemTitle","key","type","progress","speed","remaining","size","title","thumb"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return t.parseInteger(n,["syncItemId","speed"]),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs)}});return n
}),define("plex/base/models/server/TranscodeJobCollection",["plex/base/models/BaseCollection","plex/base/models/server/TranscodeJobModel"],function(e,t){var i=e.extend({model:t,url:"/sync/transcodeQueue",parse:function(e){return this.convert(e,"TranscodeJob")}});return i}),define("plex/base/models/server/SessionModel",["plex/base/models/library/MetadataModel"],function(e){var t=e.extend({idAttribute:"sessionKey",cacheKey:function(e){return this.server&&this.server.getScopedKey(e.sessionKey)}});return t
}),define("plex/base/models/server/SessionCollection",["plex/base/models/library/MetadataCollection","plex/base/models/server/SessionModel"],function(e,t){var i=e.extend({model:t,url:"/status/sessions"});return i}),define("plex/base/models/server/ServerModel",["underscore","jquery","backbone","plex/base/adapters/loggerAdapter","plex/base/mixins/serverMixin","plex/base/models/BaseModel","plex/base/models/config","plex/base/models/library/section/SectionModel","plex/base/models/library/section/SectionCollection","plex/base/models/library/PlayQueueManager","plex/base/models/library/PlaylistsSectionModel","plex/base/models/server/ServerCloudAccountModel","plex/base/models/server/ServerUpdateModel","plex/base/models/server/ServerSettingCollection","plex/base/models/server/ServerAlertCollection","plex/base/models/server/TranscodeJobCollection","plex/base/models/server/SessionCollection"],function(e,t,i,n,r,s,a,o,l,u,c,d,h,p,f,m,g){var v=s.extend({mixins:r,persistInCache:!0,timeout:1e4,defaults:function(){return e.extend(r.defaults.apply(this,arguments),{cloudAccount:new d({},{server:this}),update:a.get("serverUpdate")?new h({},{server:this}):null,sections:new l([],{server:this}),settings:new p([],{server:this}),alerts:new f([],{server:this}),transcodeJobs:new m([],{server:this}),sessions:new g([],{server:this}),playQueueManager:new u({server:this}),playlists:new c({},{server:this})})
},constructor:function(){return this.connections=[],this.resetPopulatePromise(t.Deferred()),s.prototype.constructor.apply(this,arguments)||null},initialize:function(e,t){t&&t.source&&this.addSource(t.source),this.listenTo(this,"change:machineIdentifier",this.onMachineIdentifierChange)},fetch:function(){return i.Model.prototype.fetch.apply(this,arguments)},merge:function(t){t.set("isMerged",!0),t.get("bundled")&&this.set("bundled",!0);var i=t.get("sources");e.each(i,function(e){this.addSource(e,{silent:!0})
},this),e.each(t.connections,function(t){n.log("Merging connection ("+t.address+") into "+this.get("friendlyName")),this.addConnection(e.pick(t,"scheme","address","port","accessToken","bundled"))},this),this.collection&&(this.collection.remove(t.cid,{silent:!0}),this.collection._byId[this.id]=this,this.collection.trigger("remove",t,this)),this.cache.remove(t)},toLiteJSON:function(){return this.pick(["friendlyName","machineIdentifier","accessToken","cloud","shared","synced","sources"])},addSource:function(t,i){i||(i={});
var n=this.get("sources");t&&!e.contains(n,t)&&(n.push(t),i.silent||this.trigger("change:sources",this,n))},removeSource:function(t,i){i||(i={});var n=this.get("sources"),r=e.indexOf(n,t);r>-1&&(n.splice(r,1),i.silent||this.trigger("change:sources",this,n))},addConnection:function(i){var n=e.findWhere(this.connections,{address:i.address,port:i.port});if(n){if(n.available||n.accessToken||!i.accessToken)return n;n.pending=!0,n.accessToken=i.accessToken,i=n}else i.pending=!0,i.isLocalAddress=this.isLocalAddress(i.address),i.isLoopbackAddress=this.isLoopbackAddress(i.address),this.connections.push(i);
return"rejected"===this.populatePromise.state()&&(this.resetPopulatePromise(t.Deferred()),this.set("authorized",null)),this.trigger("change:connections",this,this.connections),i},hasLocalConnection:function(){var e=this.get("activeConnection");return e?e.isLocalAddress:null},hasLoopbackConnection:function(){var e=this.get("activeConnection");return e?e.isLoopbackAddress:null},canBePrimary:function(e){return this.get("synced")||this.get("cloud")?!1:this.get("shared")&&!this.get("multiuser")?!1:this.get("available")&&this.get("authorized")&&!this.get("mixedContent")?this.isVersionOrNewer(e):!1
},getSectionForItem:function(e){if(e.section)return e.section;var t=new o({key:e.get("librarySectionID")},{server:e.server,onlyIfCached:!0});return t},onMachineIdentifierChange:function(){this.collection?this.listenToOnce(this.collection,"change:machineIdentifier",this.onMachineIdentifierChanged):this.onMachineIdentifierChanged()},onMachineIdentifierChanged:function(){var e=this.cacheKey(this.attributes),t=this.cache.get(e);t?t.get("connected")||!this.get("connected")?t.merge(this):(this.merge(t),this.cache.store(this)):this.cache.store(this,e)
}});return v}),define("plex/base/models/server/ServerCollection",["plex/base/models/BaseCollection","plex/base/models/server/ServerModel"],function(e,t){var i=e.extend({model:t,url:"/servers",parse:function(e){return this.convert(e,"Server")},comparator:function(e){var t=e.get("friendlyName")||"",i=e.get("shared"),n=e.get("synced"),r=i?"1":"0";return r+=n?"1":"0",r+=t.toLowerCase()},toLiteJSON:function(){return this.map(function(e){return e.toLiteJSON()})}});return i}),define("plex/base/models/server/ResourceModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"clientIdentifier",urlRoot:"/api/resources",whitelistedAttrs:["clientIdentifier","name","sourceTitle","accessToken","product","productVersion","platform","platformVersion","device","provides","owned","synced","presence","createdAt","lastSeenAt","Connection"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);
return n.Device&&(n=n.Device),t.parseBoolean(n,["owned","synced","presence"]),t.parseInteger(n,["createdAt","lastSeenAt"]),t.parseArray(n,"Connection"),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs),i.provides&&(i.provides=i.provides.split(","),e.contains(i.provides,"sync-target")&&(i.synced=!0)),i}});return n}),define("plex/base/models/server/ResourceCollection",["plex/base/models/config","plex/base/models/BaseCollection","plex/base/models/server/ResourceModel"],function(e,t,i){var n=t.extend({model:i,url:function(){var t="/api/resources";
return e.get("requestAllConnections")||(t+="?filterByPublic=1"),t},parse:function(e){return this.convert(e,"Device")}});return n}),define("plex/base/models/server/CloudServerModel",["underscore","jquery","plex/base/adapters/loggerAdapter","plex/base/models/server/ServerModel","plex/base/models/server/ResourceCollection","plex/base/models/library/PlayQueueManager"],function(e,t,i,n,r,s){var a=n.extend({defaults:function(){return{machineIdentifier:"myPlex",friendlyName:"plex.tv",cloud:!0,downForMaintenance:!1,plexPassUrl:"https://plex.tv/subscription/about",accountUrl:"https://plex.tv/users/edit",cloudSyncUrl:"https://plex.tv/cloudsync/providers",appsUrl:"https://plex.tv/downloads",helpUrl:"http://support.plex.tv/hc/en-us",resources:new r([],{server:this}),playQueueManager:new s({server:this})}
},initialize:function(){this.listenTo(this,"change:resources",this.onResourcesChange),this.forwardResourcesEvents()},forwardResourcesEvents:function(){var t=this.get("resources");t&&this.listenTo(t,"all",function(){var t=e.toArray(arguments),i=t[0];t[0]="change:resources:"+i,this.trigger.apply(this,t)})},testConnection:function(n){var r=this.get("friendlyName"),s=this.resolveUrl("/pms/:/ip",{connection:n}),a=e.extend(this.getXHROptions(s),{timeout:this.timeout}),o=t.ajax(a);i.log("Testing connection to "+r+" at "+s),o.done(e.bind(function(){i.success("Setting active connection for "+r+" ("+s+")"),this.set({connected:!0,available:!0,downForMaintenance:!1,activeConnection:n})
},this)),o.fail(e.bind(function(e){i.error(r+" is unavailable at "+s+" (Status "+e.status+")"),this.set({connected:!1,available:!1,downForMaintenance:503===e.status}),this.populatePromise.rejectWith(this,[this,e])},this))},onResourcesChange:function(){var e=this.previous("resources");e&&this.stopListening(e),this.forwardResourcesEvents()}});return a.prototype.cache=n.prototype.cache,a}),define("plex/base/models/player/PlexPlayerModel",["plex/base/models/server/ServerModel","plex/base/models/library/MetadataCollection"],function(e,t){var i=e.extend({cacheKey:null,initialize:function(){this.set("activeConnection",this.connections[0]),this.set("nowPlaying",new t([],{server:this.server}))
}});return i}),define("plex/base/models/player/PlexPlayerCollection",["plex/base/models/server/ServerCollection","plex/base/models/player/PlexPlayerModel"],function(e,t){var i=e.extend({model:t,url:"/clients"});return i}),define("plex/base/models/server/serverStorageModel",["underscore","jquery","plex/base/adapters/storageAdapter","plex/base/models/StorageModel"],function(e,t,i,n){var r=n.extend({storageKey:"connections",defaults:function(){return{users:[]}},initialize:function(){this.debouncedSave=e.debounce(this.save,100)
},getCurrentUser:function(){var n=i.get({key:"myPlexAccessToken"});return n=n.then(e.bind(function(i){var n=this.get("users"),r=e.findWhere(n,{accessToken:i});return r||(r={accessToken:i,servers:[]},n.push(r)),t.Deferred().resolve(r).promise()},this))},updateUser:function(t){var i=this.getCurrentUser();return i=i.then(e.bind(function(e){e.id=t.id,e.title=t.get("title"),e.home=t.get("home"),e.entitlements=t.get("entitlements");var i=t.get("pin");return i?e.pin=i:e.pin&&delete e.pin,this.debouncedSave()
},this))},updateLiteServer:function(i,n){n||(n={});var r=this.getCurrentUser();return r=r.then(e.bind(function(r){var s=r.servers,a=e.findWhere(s,{machineIdentifier:i.id});if(!a){if(!n.add)return t.Deferred().reject().promise();a={connections:[]},s.push(a)}return e.extend(a,i.toLiteJSON()),this.debouncedSave(),t.Deferred().resolve(a).promise()},this))},updateConnections:function(i,n){var r=this.updateLiteServer(i,{add:!0});return r=r.then(e.bind(function(i){var r=e.map(n,function(t){return e.pick(t,"scheme","address","port","bundled")
});return i.connections=r,this.debouncedSave(),t.Deferred().resolve(r).promise()},this))},removeAllServers:function(){var t=this.getCurrentUser();return t.done(e.bind(function(e){e.servers.length=0,this.debouncedSave()},this)),t},removeLiteServer:function(t){var i=this.getCurrentUser();return i.done(e.bind(function(i){var n=i.servers,r=e.indexOf(n,e.findWhere(n,{machineIdentifier:t.id}));r>-1&&(n.splice(r,1),this.debouncedSave())},this)),i},pruneLiteServers:function(t,i){var n=this.getCurrentUser();
return n.done(e.bind(function(n){for(var r=i.server.id,s=n.servers,a=e.filter(s,function(t){return e.contains(t.sources,r)}),o=a.length-1;o>-1;o--){var l=a[o],u=l.machineIdentifier;if(!i.get(u)){var c=l.sources;if(c.splice(e.indexOf(c,r),1),!c.length||1===c.length&&c[0]===u){var d=t.get(u);d&&d.trigger("destroy",d,d.collection),s.splice(e.indexOf(s,l),1)}this.debouncedSave()}}},this)),n}});return new r}),define("plex/base/models/user/SyncItemModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({whitelistedAttrs:["id","version","rootTitle","title","metadataType","clientIdentifier","Server","Status","MediaSettings","Policy","Location"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);
return t.parseInteger(n,["id","version"]),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs),i.Location&&i.Location.uri&&(i.isDirectory=/library\:\/\/([\w-]+)\/directory\//.test(i.Location.uri)),i}});return n}),define("plex/base/models/user/SyncItemCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/user/SyncItemModel"],function(e,t,i){var n=t.extend({model:i,url:function(){return this.device?"/devices/"+this.device.get("clientIdentifier")+"/sync_items":"/servers/"+this.parent.id+"/sync_lists"
},parse:function(t){var i=this.convert(t),n=[],r=function(t,i){i&&(e.isArray(i)||(i=[i]),e.each(i,function(e){e.clientIdentifier=t,n.push(e)}))};return i.SyncList&&!e.isArray(i.SyncList)&&(i.SyncList=[i.SyncList]),e.each(i.SyncList,function(e){r(e.clientIdentifier,e.SyncItems.SyncItem)}),i.SyncItems&&r(i.clientIdentifier,i.SyncItems.SyncItem),n},filterByServer:function(e){var t=this.filter(function(t){var i=t.get("Server");return i&&i.machineIdentifier===e});return this.clone(t)}});return n}),define("plex/base/models/user/DeviceModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel","plex/base/models/user/SyncItemCollection"],function(e,t,i,n){var r=i.extend({whitelistedAttrs:["id","clientIdentifier","name","product","productVersion","platform","platformVersion","device","model","provides","screenResolution","screenDensity","lastSeenAt","SyncList"],url:function(){return"/devices/"+this.id+".xml"
},initialize:function(){this.set("syncItems",new n([],{server:this.server,device:this}))},convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return t.parseInteger(n,"lastSeenAt"),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs),i.isCloudSync="cloudsync"===i.platform,i.provides=i.provides?i.provides.split(","):[],i},supports:function(t){var i=this.get("provides");return e.indexOf(i,t)>-1}});return r}),define("plex/base/models/user/DeviceCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/user/DeviceModel"],function(e,t,i){var n=t.extend({model:i,url:"/devices.xml",parse:function(e){return this.convert(e,"Device")
},filterSyncDevices:function(t){var i=!(!t||!t.channel),n=this.filter(function(e){return e.supports("sync-target")&&(!i||!e.get("isCloudSync"))}),r=e.sortBy(n,function(e){return!e.get("isCloudSync")});return this.clone(r)},filterByProducts:function(t){var i=this.filter(function(i){return e.contains(t,i.get("product"))});return this.clone(i)},products:function(){var t=this.map(function(e){return e.get("product")});return e.uniq(t)}});return n}),define("plex/base/models/user/HomeUserModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({urlRoot:"/api/home/users",whitelistedAttrs:["id","admin","protected","restricted","title","username","email","thumb"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);
return n.User&&(n=n.User),t.parseInteger(n,"id"),t.parseBoolean(n,["admin","protected","restricted"]),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs)},getSaveParams:function(t){if(e.isEmpty(t)){var n={};return this.get("restricted")?n.title=this.get("title"):this.isNew()&&(n.invitedEmail=this.get("username")),n}return i.prototype.getSaveParams.apply(this,arguments)}});return n}),define("plex/base/models/user/HomeUserCollection",["plex/base/models/BaseCollection","plex/base/models/user/HomeUserModel"],function(e,t){var i=e.extend({model:t,url:"/api/home/users",parse:function(e){return this.convert(e,"User")
}});return i}),function(e,t){"object"==typeof exports?module.exports=t(require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define("backbone.obscura",["underscore","backbone"],t):e.Backbone.Obscura=t(e._,e.Backbone)}(this,function(e,t){function i(i){return{underscore:e,backbone:t}[i]}var n=function(){function e(t){var i=e.cache[t];if(!i){var n={};i=e.cache[t]={id:t,exports:n},e.modules[t].call(n,i,n)}return i.exports}return e.cache=[],e.modules=[function(t){function n(e,t){this._superset=e,this._filtered=new a(e,t),this._sorted=new o(this._filtered,t),this._paginated=new l(this._sorted,t),u(this._paginated,this),c.call(this,this._filtered,p),c.call(this,this._sorted,m),c.call(this,this._paginated,v),this.initialize(t)
}var r=i("underscore"),s=i("backbone"),a=e(2),o=e(5),l=e(4),u=e(1),c=e(7),d={superset:function(){return this._superset},getFilteredLength:function(){return this._filtered.length},removeTransforms:function(){return this._filtered.resetFilters(),this._sorted.removeSort(),this._paginated.removePagination(),this},destroy:function(){this.stopListening(),this._filtered.destroy(),this._sorted.destroy(),this._paginated.destroy(),this.length=0,this.trigger("obscura:destroy")}},h=["filterBy","removeFilter","resetFilters","refilter","hasFilter","getFilters"],p=["filtered:add","filtered:remove","filtered:reset"],f=["setSort","reverseSort","removeSort"],m=["sorted:add","sorted:remove"],g=["setPerPage","setPage","getPerPage","getNumPages","getPage","hasNextPage","hasPrevPage","nextPage","prevPage","movePage","removePagination","firstPage","lastPage"],v=["paginated:change:perPage","paginated:change:page","paginated:change:numPages"],y=["add","create","remove","set","reset","sort","parse","sync","fetch","push","pop","shift","unshift"];
r.each(h,function(e){d[e]=function(){var t=a.prototype[e].apply(this._filtered,arguments);return t===this._filtered?this:t}}),r.each(g,function(e){d[e]=function(){var t=l.prototype[e].apply(this._paginated,arguments);return t===this._paginated?this:t}}),r.each(f,function(e){d[e]=function(){var t=o.prototype[e].apply(this._sorted,arguments);return t===this._sorted?this:t}}),r.each(y,function(e){d[e]=function(){throw new Error("Backbone.Obscura: Unsupported method: "+e+"called on read-only proxy")}
}),r.extend(n.prototype,d,s.Events),n=s.Collection.extend(n.prototype),n.FilteredCollection=a,n.SortedCollection=o,n.PaginatedCollection=l,t.exports=n},function(e){function t(e,t){function i(){t.length=e.length}function o(i){var r=n.toArray(arguments),s="change"===i||"change:"===i.slice(0,7);"reset"===i&&(t.models=e.models),n.contains(a,i)?(n.contains(["add","remove","destroy"],i)?r[2]=t:n.contains(["reset","sort"],i)&&(r[1]=t),t.trigger.apply(this,r)):s&&t.contains(r[1])&&t.trigger.apply(this,r)
}var l={};return n.each(n.functions(r.Collection.prototype),function(t){n.contains(s,t)||(l[t]=function(){return e[t].apply(e,arguments)})}),n.extend(t,r.Events,l),t.listenTo(e,"all",i),t.listenTo(e,"all",o),t.models=e.models,i(),t}var n=i("underscore"),r=i("backbone"),s=["_onModelEvent","_prepareModel","_removeReference","_reset","add","initialize","sync","remove","reset","set","push","pop","unshift","shift","sort","parse","fetch","create","model","off","on","listenTo","listenToOnce","bind","trigger","once","stopListening"],a=["add","remove","reset","sort","destroy","sync","request","error"];
e.exports=t},function(t){function n(){this._filterResultCache={}}function r(e){for(var t in this._filterResultCache)this._filterResultCache.hasOwnProperty(t)&&delete this._filterResultCache[t][e]}function s(e,t){this._filters[e]&&r.call(this,e),this._filters[e]=t,this.trigger("filtered:add",e)}function a(e){delete this._filters[e],r.call(this,e),this.trigger("filtered:remove",e)}function o(e){this._filterResultCache[e.cid]||(this._filterResultCache[e.cid]={});var t=this._filterResultCache[e.cid];
for(var i in this._filters)if(this._filters.hasOwnProperty(i)&&(t.hasOwnProperty(i)||(t[i]=this._filters[i].fn(e)),!t[i]))return!1;return!0}function l(e){e||(e={});var t=[];this._superset&&(t=this._superset.filter(g.bind(o,this))),e.reset?this._collection.reset(t):this._collection.set(t),this.length=this._collection.length}function u(){l.call(this,{reset:!0})}function c(){var e=!(!this._superset||!this._superset.comparator);l.call(this,{reset:e})}function d(e){if(this._filterResultCache[e.cid]={},o.call(this,e)){if(!this._collection.get(e.cid)){for(var t=this.superset().indexOf(e),i=null,n=t-1;n>=0;n-=1)if(this.contains(this.superset().at(n))){i=this.indexOf(this.superset().at(n))+1;
break}i=i||0,this._collection.add(e,{at:i})}}else this._collection.get(e.cid)&&this._collection.remove(e);this.length=this._collection.length}function h(e){this._filterResultCache[e.cid]={},o.call(this,e)||this._collection.get(e.cid)&&this._collection.remove(e)}function p(e){"change:"===e.slice(0,7)&&h.call(this,arguments[1])}function f(e){this.contains(e)&&this._collection.remove(e),this.length=this._collection.length}function m(e){this._superset=e,this._collection=new v.Collection(e.toArray()),y(this._collection,this),this.resetFilters(),this.listenTo(this._superset,"reset",u),this.listenTo(this._superset,"sort",c),this.listenTo(this._superset,"add change",d),this.listenTo(this._superset,"remove",f),this.listenTo(this._superset,"all",p)
}var g=i("underscore"),v=i("backbone"),y=e(1),b=e(3),x={defaultFilterName:"__default",filterBy:function(e,t){return t||(t=e,e=this.defaultFilterName),s.call(this,e,b(t)),l.call(this),this},removeFilter:function(e){return e||(e=this.defaultFilterName),a.call(this,e),l.call(this),this},resetFilters:function(){return this._filters={},n.call(this),this.trigger("filtered:reset"),l.call(this),this},superset:function(){return this._superset},refilter:function(e){return"object"==typeof e&&e.cid?d.call(this,e):(n.call(this),l.call(this)),this
},getFilters:function(){return g.keys(this._filters)},hasFilter:function(e){return g.contains(this.getFilters(),e)},destroy:function(){this.stopListening(),this._collection.reset([]),this._superset=this._collection,this.length=0,this.trigger("filtered:destroy")}};g.extend(m.prototype,x,v.Events),t.exports=m},function(e){function t(e,t){return function(i){return i.get(e)===t}}function n(e,t){return function(i){return t(i.get(e))}}function r(e,t){return o.isArray(t)||(t=null),{fn:e,keys:t}}function s(e){var i=o.keys(e),s=o.map(i,function(i){var r=e[i];
return o.isFunction(r)?n(i,r):t(i,r)}),a=function(e){for(var t=0;t<s.length;t++)if(!s[t](e))return!1;return!0};return r(a,i)}function a(e,t){return o.isFunction(e)?r(e,t):o.isObject(e)?s(e):void 0}var o=i("underscore");e.exports=a},function(t){function n(){var e=this.getPage()*this.getPerPage(),t=e+this.getPerPage();return[e,t]}function r(){var e=n.call(this);this._collection.reset(this.superset().slice(e[0],e[1]))}function s(){var e=(this._totalPages,this.superset().length),t=this.getPerPage(),i=e%t===0?e/t:Math.floor(e/t)+1,n=this._totalPages!==i;
return this._totalPages=i,n&&this.trigger("paginated:change:numPages",{numPages:i}),this.getPage()>=i?(this.setPage(i-1),!0):void 0}function a(){s.call(this)||r.call(this)}function o(e,t){for(var i=c.max([e.length,t.length]),n=0,r=0;i>n;n+=1,r+=1)if(e[n]!==t[r])if(t[n-1]===e[n])r-=1;else{if(t[n+1]!==e[n])return e[n];r+=1}}function l(){if(!s.call(this)){var e=n.call(this),t=e[0],i=e[1],r=o(this.superset().slice(t,i),this._collection.toArray()),a=o(this._collection.toArray(),this.superset().slice(t,i));
a&&this._collection.remove(a),r&&this._collection.add(r,{at:this.superset().indexOf(r)-t})}}function u(e,t){this._superset=e,this._collection=new d.Collection(e.toArray()),this._page=0,this.setPerPage(t&&t.perPage?t.perPage:null),h(this._collection,this),this.listenTo(this._superset,"add remove",l),this.listenTo(this._superset,"reset sort",a)}var c=i("underscore"),d=i("backbone"),h=e(1),p={removePagination:function(){return this.setPerPage(null),this},setPerPage:function(e){return this._perPage=e,a.call(this),this.setPage(0),this.trigger("paginated:change:perPage",{perPage:e,numPages:this.getNumPages()}),this
},setPage:function(e){var t=0,i=this.getNumPages()-1;return e=e>t?e:t,e=i>e?e:i,e=0>e?0:e,this._page=e,r.call(this),this.trigger("paginated:change:page",{page:e}),this},getPerPage:function(){return this._perPage||this.superset().length||1},getNumPages:function(){return this._totalPages},getPage:function(){return this._page},hasNextPage:function(){return this.getPage()<this.getNumPages()-1},hasPrevPage:function(){return this.getPage()>0},nextPage:function(){return this.movePage(1),this},prevPage:function(){return this.movePage(-1),this
},firstPage:function(){this.setPage(0)},lastPage:function(){this.setPage(this.getNumPages()-1)},movePage:function(e){return this.setPage(this.getPage()+e),this},superset:function(){return this._superset},destroy:function(){this.stopListening(),this._collection.reset([]),this._superset=this._collection,this._page=0,this._totalPages=0,this.length=0,this.trigger("paginated:destroy")}};c.extend(u.prototype,p,d.Events),t.exports=u},function(t){function n(e){return c.isFunction(e)?e:function(t){return t.get(e)
}}function r(e){return this._comparator?this._reverse?p(this._collection.toArray(),e,n(this._comparator)):c.sortedIndex(this._collection.toArray(),e,n(this._comparator)):this._superset.indexOf(e)}function s(e){var t=r.call(this,e);this._collection.add(e,{at:t})}function a(e){this.contains(e)&&this._collection.remove(e)}function o(e){this.contains(e)&&this._collection.indexOf(e)!==r.call(this,e)&&(this._collection.remove(e),s.call(this,e))}function l(){if(!this._comparator)return void this._collection.reset(this._superset.toArray());
var e=this._superset.sortBy(this._comparator);this._collection.reset(this._reverse?e.reverse():e)}function u(e){this._superset=e,this._reverse=!1,this._comparator=null,this._collection=new d.Collection(e.toArray()),h(this._collection,this),this.listenTo(this._superset,"add",s),this.listenTo(this._superset,"remove",a),this.listenTo(this._superset,"change",o),this.listenTo(this._superset,"reset",l)}var c=i("underscore"),d=i("backbone"),h=e(1),p=e(6),f={setSort:function(e,t){return this._reverse="desc"===t?!0:!1,this._comparator=e,l.call(this),this.trigger(e?"sorted:add":"sorted:remove"),this
},reverseSort:function(){return this._reverse=!this._reverse,l.call(this),this},removeSort:function(){return this.setSort(),this},superset:function(){return this._superset},destroy:function(){this.stopListening(),this._collection.reset([]),this._superset=this._collection,this.length=0,this.trigger("sorted:destroy")}};c.extend(u.prototype,f,d.Events),t.exports=u},function(e){function t(e){return r.isFunction(e)?e:function(t){return t[e]}}function n(e,i,n,s){n=null==n?r.identity:t(n);for(var a=n.call(s,i),o=0,l=e.length;l>o;){var u=o+l>>>1;
n.call(s,e[u])<a?l=u:o=u+1}return o}var r=i("underscore");e.exports=n},function(e){function t(e,t){n.each(t,function(t){this.listenTo(e,t,function(){var e=n.toArray(arguments);e.unshift(t),this.trigger.apply(this,e)})},this)}var n=i("underscore");e.exports=t}],e(0)}();return n}),define("plex/base/models/user/ServerShareModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({whitelistedAttrs:["id","serverId","machineIdentifier","name","owned","admin","pending","lastSeenAt","invitedAt","acceptedAt","allLibraries","numLibraries","allowSync","allowCameraUpload","Section"],urlRoot:function(){return"/api/servers/"+this.get("machineIdentifier")+"/shared_servers"
},isActive:function(){return!(!this.get("numLibraries")&&!this.get("allLibraries"))},convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);n.SharedServer&&(n=n.SharedServer),t.parseInteger(n,["id","serverId","lastSeenAt","invitedAt","acceptedAt","numLibraries"]),t.parseBoolean(n,["owned","admin","pending","allLibraries","allowSync","allowCameraUpload"]),t.parseArray(n,"Section");var r=n.Section;return e.each(r,function(e){t.parseInteger(e,"id"),t.parseBoolean(e,"shared")}),n},parse:function(t){var i=this.convert(t);
return i=e.pick(i,this.whitelistedAttrs),!i.numLibraries&&i.Section.length&&(i.numLibraries=e.where(i.Section,{shared:!0}).length),i}});return n}),define("plex/base/models/user/ServerShareCollection",["underscore","plex/base/models/BaseCollection","plex/base/models/user/ServerShareModel"],function(e,t,i){var n=t.extend({model:i,filterByOwned:function(){var e=this.filter(function(e){return e.get("owned")});return this.clone(e)},filterByShared:function(){var e=this.filter(function(e){return!e.get("owned")&&!e.get("pending")
});return this.clone(e)},getLibraryCount:function(t){var i=this.where(t);return e.reduce(i,function(e,t){return e+=t.get("numLibraries")},0)},getOwnedLibraryCount:function(){return this.getLibraryCount({owned:!0})},getSharedLibraryCount:function(){return this.getLibraryCount({owned:!1})},getActiveCount:function(){return this.reduce(function(e,t){return t.isActive()&&e++,e},0)}});return n}),define("plex/base/models/user/FriendModel",["underscore","jquery","plex/base/utils/parser","plex/base/models/BaseModel","plex/base/models/user/ServerShareCollection"],function(e,t,i,n,r){var s=n.extend({whitelistedAttrs:["id","home","protected","restricted","title","username","email","thumb","recommendationsPlaylistId","allowSync","allowCameraUpload","filterMovies","filterTelevision","filterMusic","filterPhotos"],saveAttrs:["allowSync","allowCameraUpload","filterMovies","filterTelevision","filterMusic","filterPhotos"],filterAttrs:["filterMovies","filterTelevision","filterMusic","filterPhotos"],urlRoot:function(){return this.get("home")?"/api/users":"/api/friends"
},convert:function(t){var n=e.isObject(t)?t:i.parseXML(t);return n.User&&(n=n.User),i.parseInteger(n,"id"),i.parseBoolean(n,["home","protected","restricted","allowSync","allowCameraUpload"]),i.parseQueryString(n,["filterMovies","filterTelevision","filterMusic","filterPhotos"],"|"),i.parseArray(n,"Server"),n},parse:function(t){var i=this.convert(t);return this.parseServers(i),i=e.pick(i,this.whitelistedAttrs)},parseServers:function(e){var t=this.get("serverShares"),i=e.Server;t?t.set(i,{parse:!0}):(t=new r(i,{server:this.server,parent:this,populated:!0,parse:!0}),this.set("serverShares",t))
},cloneDeep:function(){var e=this.toJSON();e.Server=e.serverShares.toJSON(),e.serverShares=null;var i={server:this.server,section:this.section,channel:this.channel,parent:this.parent,parse:!0,skipCache:!0};return new this.constructor(t.extend(!0,{},e),i)||null},getSaveParams:function(t){if(e.isEmpty(t)){var i=this.pick(this.saveAttrs);return e.map(i,function(t,i,n){e.isBoolean(t)?n[i]=t?"1":"0":e.contains(this.filterAttrs,i)&&(n[i]=this.stringifyFilter(t))},this),i}return n.prototype.getSaveParams.apply(this,arguments)
},stringifyFilter:function(t){var i=e.map(e.keys(t),function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])});return i.join("|")}});return s}),define("plex/base/models/user/FriendCollection",["backbone.obscura","plex/base/models/BaseCollection","plex/base/models/user/FriendModel"],function(e,t,i){var n=t.extend({model:i,url:"/api/users",parse:function(e){return this.convert(e,"User")},filterByHome:function(){var t=new e(this);return t.filterBy(function(e){return e.get("home")}),t},filterByUnrestricted:function(){var t=new e(this);
return t.filterBy(function(e){return!e.get("restricted")}),t},filterByServerShares:function(t){var i=new e(this);return i.filterBy(function(e){var i=e.get("serverShares");return!!i.findWhere({machineIdentifier:t})}),i}});return n}),define("plex/base/models/user/InviteModel",["underscore","jquery","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i,n){var r=n.extend({whitelistedAttrs:["id","friend","server","home","friendlyName","username","email","thumb","createdAt","Server"],urlRoot:"/api/invites/requests",url:function(){var i;
if(this.isNew())i=e.result(this,"urlRoot");else{var n=this.pick("friend","server","home");e.each(e.keys(n),function(e){n[e]=n[e]?"1":"0"}),i=this.collection?e.result(this.collection,"url"):e.result(this,"urlRoot"),i=i.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.get("id")),i+="?"+t.param(n,!0)}return i},convert:function(t){var n=e.isObject(t)?t:i.parseXML(t);i.parseInteger(n,"createdAt"),i.parseBoolean(n,["friend","server","home"]),i.parseArray(n,"Server");var r=n.Server;return e.each(r,function(e){i.parseInteger(e,"numLibraries")
}),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs)}});return r}),define("plex/base/models/user/InviteCollection",["backbone.obscura","plex/base/models/BaseCollection","plex/base/models/user/InviteModel"],function(e,t,i){var n=t.extend({model:i,url:function(){return"/api/invites/"+this.subset},initialize:function(e,t){t||(t={}),this.subset=t.subset||"requests"},parse:function(e){return this.convert(e,"Invite")},filterByHome:function(){var t=new e(this);return t.filterBy(function(e){return e.get("home")
}),t},filterByFriends:function(){var t=new e(this);return t.filterBy(function(e){return!e.get("home")}),t}});return n}),define("plex/base/models/user/SocialNetworkModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel"],function(e,t,i){var n=i.extend({idAttribute:"key",whitelistedAttrs:["key","title","linked","maxLength"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);return t.parseBoolean(n,["linked","maxLength"]),n},parse:function(t){var i=this.convert(t);return i=e.pick(i,this.whitelistedAttrs)
}});return n}),define("plex/base/models/user/SocialNetworkCollection",["plex/base/models/BaseCollection","plex/base/models/user/SocialNetworkModel"],function(e,t){var i=e.extend({model:t,url:"/pms/social/networks",parse:function(e){return this.convert(e,"Directory")}});return i}),SHA256_hexchars=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),SHA256_K=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),define("jssha256",function(){}),define("plex/base/models/user/UserModel",["underscore","jquery","plex/base/utils/parser","plex/base/adapters/loggerAdapter","plex/base/adapters/storageAdapter","plex/base/models/BaseModel","plex/base/models/settingsModel","plex/base/models/server/serverStorageModel","plex/base/models/user/DeviceCollection","plex/base/models/user/HomeUserCollection","plex/base/models/user/FriendCollection","plex/base/models/user/InviteCollection","plex/base/models/user/SocialNetworkCollection","jssha256"],function(e,t,i,n,r,s,a,o,l,u,c,d,h){var p=s.extend({url:"/users/account",defaults:function(){var t={server:this.server,parent:this};
return{signedIn:null,hasInvalidToken:!1,subscription:!1,locked:null,devices:new l([],t),homeUsers:new u([],t),friends:new c([],t),invites:new d([],t),sentInvites:new d([],e.extend({subset:"requested"},t)),socialNetworks:new h([],t)}},whitelistedAttrs:["id","pin","restricted","home","maxHomeSize","username","email","thumb","title","queueUid","queueEmail","accessToken"],initialize:function(){this.listenTo(this.server,"change:available",this.onServerAvailableChange)},convert:function(t){var n=e.isObject(t)?t:i.parseXML(t),r=n.subscription,s=n.entitlements;
return i.parseInteger(n,["id","maxHomeSize"]),i.parseBoolean(n,["restricted","home"]),i.parseArray(n,"roles"),r&&(i.parseBoolean(r,"active"),i.parseArray(r,"feature")),s&&(i.parseBoolean(s,"all"),i.parseArray(s,"entitlement")),n},parse:function(t){var i=this.convert(t),r=i.roles,s=i.subscription,a=i.entitlements,o=[];if(i.accessToken=i.authenticationToken,i=e.pick(i,this.whitelistedAttrs),i.signedIn=!0,i.hasInvalidToken=!1,s){var l=s.feature;i.subscription=s.active,i.plan=s.plan,o.push("subscription: "+i.plan),i.features=e.reduce(l,function(e,t){return e[t.id]=!0,e
},{}),o.push("features: "+e.keys(i.features).join(", "))}else o.push("features: none"),i.features=void 0,i.plan=void 0,i.subscription=void 0;return r&&r.length?(r=r[0].role,i.roles=e.reduce(r,function(e,t){return e[t.id]=!0,e},{}),o.push("roles: "+e.keys(i.roles).join(", "))):i.roles=void 0,a?(e(a.entitlement).each(function(e){a[e.id]=!0}),i.entitlements=e(a).omit("entitlement"),o.push("entitlements: "+e.keys(i.entitlements).join(", "))):o.push("entitlements: none"),n.group(i.title,o),i},switchUser:function(i,n){var s=this.parse(i),a=s.accessToken,o=this.parent.get("servers");
o.resetPopulatePromise(t.Deferred()),this.parent.get("primaryServer")===!1&&this.parent.set("primaryServer",null);var l=r.set({key:"myPlexAccessToken",value:a,session:!n.remember});l.always(e.bind(function(){this.server.set("accessToken",a),this.set(s),this.resolveServerPromise()},this))},resolveServerPromise:function(){var e=this.get("signedIn"),t=e?"resolved":"rejected";this.server.updatePopulatePromise(t),this.server.set("authorized",e)},clearAccountAttributes:function(t){t||(t={}),this.clear(),this.set(e.extend({},e.result(this,"defaults"),t)),t.hasInvalidToken&&(this.server.get("resources").reset(),this.clearAccessToken())
},clearAccessToken:function(){this.server.set("accessToken",null);var t=r.clear({session:!0});return t=t.then(function(){return window.PLEXWEB&&window.PLEXWEB.myPlexAccessToken&&delete window.PLEXWEB.myPlexAccessToken,r.remove({key:"myPlexAccessToken"})}),t=t.then(function(){return o.clear(),o.save(e.result(o,"defaults"))})},hashPIN:function(e,t){return t||(t=this.get("accessToken")),SHA256_hash(e+t)},isFullUser:function(){return!!this.get("username")},isEmployee:function(){var e=this.get("roles");
return!!(e&&"employee"in e)},isNinja:function(){var e=this.get("roles");return this.isEmployee()||!!(e&&"ninja"in e)},hasPlexPass:function(){var e=this.get("features");return!!(e&&"pass"in e)},hasEntitlement:function(t){var i=this.get("entitlements");return e(i).has("all")&&i.all===!0||e(i).has(t)},hasSync:function(){var e=this.get("features");return!!(e&&"sync"in e)},hasHome:function(){return!!this.get("pin")||this.get("homeUsers").length>1},onServerAvailableChange:function(t,i){if(null!=i){if(i===!1)return this.clearAccountAttributes({signedIn:!1}),void this.resolveServerPromise();
this.get("signedIn")&&this.set("locked",!1);var n=r.get({key:"myPlexAccessToken",session:!0}),s=e.bind(function(t){this.server.set("accessToken",t);var i=this.fetch();i.done(e.bind(function(){this.get("locked")!==!1&&this.set("locked",!!this.get("home")&&!a.get("autoLogin"))},this)),i.fail(e.bind(function(e,t){this.clearAccountAttributes({signedIn:!1,hasInvalidToken:401===t.status||422===t.status})},this)),i.always(e.bind(function(){this.resolveServerPromise()},this))},this),o=e.bind(function(){this.clearAccountAttributes({signedIn:!1}),this.resolveServerPromise()
},this);n=n.then(function(e){return e},function(){return r.get({key:"myPlexAccessToken"})}),n.done(s).fail(o)}}});return p}),define("plex/base/models/InputActivityModel",["underscore","backbone"],function(e,t){var i=18e4,n=12e4,r=t.Model.extend({AWAKE:"awake",ASLEEP:"asleep",IDLE:"idle",NONE:"none",defaults:{state:"none",enabled:!1},initialize:function(t){t||(t={}),this.idleTime=t.idleTime||i,this.sleepTime=t.sleepTime||n,e.bindAll(this,"onIdleTimeout","onSleepTimeout"),this.listenTo(this,"change:enabled",this.notice)
},notice:function(){var e,t=this.get("enabled");this.timer=clearTimeout(this.timer),t?(this.timer=setTimeout(this.onIdleTimeout,this.idleTime),e=this.AWAKE):e=this.NONE,this.set("state",e)},isInactive:function(){var e=this.get("state");return e===this.IDLE||e===this.ASLEEP},onIdleTimeout:function(){this.set("state",this.IDLE),this.timer=setTimeout(this.onSleepTimeout,this.sleepTime)},onSleepTimeout:function(){this.set("state",this.ASLEEP),this.timer=clearTimeout(this.timer)}});return r}),define("plex/base/models/appModel",["backbone","plex/base/models/AnnouncementCollection","plex/base/models/debug/LogCollection","plex/base/models/server/ServerCollection","plex/base/models/server/CloudServerModel","plex/base/models/player/PlexPlayerCollection","plex/base/models/user/UserModel","plex/base/models/InputActivityModel"],function(e,t,i,n,r,s,a,o){var l=e.Model.extend({defaults:function(){return{version:"9.9.9",updateState:"none",authorized:!1,multiserver:!1,multiplayer:!1,isCastApiAvailable:!1,isCastDeviceAvailable:!1,history:[],forwardHistory:[]}
},initialize:function(){var e=new r({machineIdentifier:"myPlex"},{parent:this});this.set({announcements:new t,inputActivity:new o,logs:new i([],{parent:this}),players:new s([],{parent:this}),servers:new n([e],{parent:this}),user:new a({},{server:e,parent:this})})}});return new l}),define("plex/base/commands/server/relayServerCommand",["jquery","underscore","plex/base/utils/dispatcher","plex/base/models/appModel"],function(e,t,i,n){function r(i){var r=i.server,a=n.get("user"),o="/devices/"+a.id+"/"+r.id+"/relay",l=t.extend(a.server.getXHROptions(o),{type:"POST"}),u=e.ajax(l).promise();
return u=u.then(function(){function t(){r.off("change:connected",i),r.populate().then(a.resolve,a.reject)}function i(e,t){t&&(clearTimeout(n),e.off("change:connected",i),a.resolve())}if(!r.get("connected")){var n,a=e.Deferred();return n=setTimeout(t,s),r.on("change:connected",i),a.promise()}})}var s=1e4;return r}),define("plex/base/commands/user/signInCommand",["jquery","plex/base/utils/t","plex/base/utils/dispatcher","plex/base/utils/formatters/stringUtil","plex/base/models/appModel"],function(e,t,i,n,r){function s(s){var a,o=r.get("user");
if(s.username&&s.password){a=o.server.getXHROptions("/users/sign_in.xml"),a.type="POST";var l="Basic "+n.encode64(n.toUtf8(s.username+":"+s.password));a.headers.Authorization=l,u=e.ajax(a)}else a=o.server.getXHROptions("/users/account.xml?auth_token="+s.accessToken),a.type="GET";var u=e.ajax(a);return u.done(function(e){o.switchUser(e,{remember:s.remember})}),u.fail(function(e){var n;n=t(401===e.status&&s.username&&s.password?"The username or password is incorrect.":"There was a problem connecting to Plex."),i.trigger("show:alert",{type:"error",message:n})
}),u.promise()}return s}),define("plex/base/commands/user/signUpCommand",["underscore","jquery","plex/base/utils/t","plex/base/utils/dispatcher","plex/base/utils/parser","plex/base/adapters/storageAdapter","plex/base/models/appModel"],function(e,t,i,n,r,s,a){function o(o){var l=a.get("user"),u=e.pick(o,"username","email","password");o.birthday&&(u.birthday_str=o.birthday.format("YYYY/MM/DD"));var c=l.server.getXHROptions("/users?format=xml");c.type="POST",c.data=u;var d=t.ajax(c);return d.done(function(e){var t=l.parse(e),i=t.accessToken;
l.server.set("accessToken",i),l.set(t),l.resolveServerPromise(),s.set({key:"myPlexAccessToken",value:i,session:!o.remember})}),d.fail(function(t){var s;if(422===t.status){var a=t.responseText,o=r.parseXML(a);r.parseArray(o,"error"),s=i(o.error.length?e.first(o.error):"This account information is invalid.")}else s=i("There was a problem connecting to Plex.");n.trigger("show:alert",{type:"error",message:s})}),d.promise()}return o}),define("plex/base/commands/user/signOutCommand",["underscore","jquery","plex/base/utils/dispatcher","plex/base/utils/xhrTracker","plex/base/adapters/loggerAdapter","plex/base/models/config","plex/base/models/appModel"],function(e,t,i,n,r,s,a){function o(o){o||(o={});
var l=a.get("user"),u=l.clearAccessToken();return u.fail(function(){r.warn("Failed to clear session and server storage")}).always(function(){var r=a.get("servers"),u=l.server;return s.get("hosted")&&!o.skipHostedRedirect?(window.location="/users/sign_out",t.Deferred().reject().promise()):(n.abortAll(),l.stopListening(),l.clear(),l.set(e.result(l,"defaults")),l.initialize(),u.resetPopulatePromise(t.Deferred()),u.connections=[],u.clear(),u.set(e.result(u,"defaults")),r.reset([u]),i.trigger("clear:cache"),u.cache.store(u),a.set({authorized:!1,primaryServer:null,history:[]}),i.trigger("request:disconnect:serverEvents"),void i.trigger("initialize:servers"))
}),u}return o}),define("plex/base/commands/user/switchUserCommand",["jquery","underscore","plex/base/utils/dispatcher","plex/base/adapters/storageAdapter","plex/base/models/appModel","plex/base/models/config","plex/base/models/server/serverStorageModel"],function(e,t,i,n,r,s,a){function o(e){var t,i=r.get("user"),n=i.get("signedIn"),s=i.id!==e.homeUser.id;return t=n?l(e):u(e),n&&s?t=t.then(function(e){return c(e)}):t.done(function(){i.set("locked",!1)}),t}function l(i){var n=i.homeUser,a=r.get("user"),o=n.id||a.id,l={pin:i.pin},u="/api/home/users/"+o+"/switch?"+e.param(l,!0),c=t.extend(n.server.getXHROptions(u),{type:"POST",xhrFields:{withCredentials:s.get("hosted")}});
return e.ajax(c).promise()}function u(t){var i=a.getCurrentUser();return i=i.then(function(i){if(!i.pin&&!t.pin)return e.Deferred().resolve().promise();var n=r.get("user"),s=n.hashPIN(t.pin,i.accessToken);return i.pin===s?e.Deferred().resolve().promise():e.Deferred().reject().promise()})}function c(t){var s=e.Deferred(),a=n.get({key:"myPlexAccessToken"});return a.always(function(){var e=!1;"resolved"===a.state()&&(e=!0),i.trigger("command","signOut",{skipHostedRedirect:!0},function(n){n.done(function(){var n=r.get("user");
n.switchUser(t,{remember:e}),n.set("locked",!1),i.trigger("home:userswitched",n),s.resolve(n)}),n.fail(function(){s.reject()})})}),s.promise()}return o}),define("plex/base/commands/user/shareCommand",["jquery","underscore","plex/base/utils/t","plex/base/utils/dispatcher","plex/base/models/appModel"],function(e,t,i,n,r){function s(s){var a=r.get("user"),o=s.item.get("url"),l=[],u={url:o,message:s.message};t.each(s.networkIDs,function(i){var n="/pms/social/networks/"+i+"/share?"+e.param(u,!0),r=t.extend(a.server.getXHROptions(n),{type:"POST"});
l.push(e.ajax(r))});var c=e.when.apply(e,l);return c.fail(function(){n.trigger("show:alert",{type:"error",message:i("There was a problem sharing this item.")})}),c.promise()}return s}),define("plex/base/commands/user/recommendCommand",["jquery","underscore","plex/base/utils/t","plex/base/utils/dispatcher","plex/base/models/appModel"],function(e,t,i,n,r){function s(s){var a=r.get("user"),o=s.item.get("url"),l=[],u={url:o,message:s.message};t.each(s.playlistIDs,function(i){var n="/pms/playlists/"+i+"/items?"+e.param(u,!0),r=t.extend(a.server.getXHROptions(n),{type:"POST"});
l.push(e.ajax(r))});var c=e.when.apply(e,l);return c.fail(function(){n.trigger("show:alert",{type:"error",message:i("There was a problem recommending this item.")})}),c.promise()}return s}),define("plex/base/commands/library/selectStreamCommand",["underscore","jquery","plex/base/utils/t","plex/base/utils/dispatcher","plex/base/utils/mediaUtil"],function(e,t,i,n,r){function s(s){var a=t.Deferred(),o=s.item,l=s.media||e.first(o.get("Media")),u=s.part||l&&e.first(l.Part),c=s.streamType,d=s.streamID;
if(!l||!u)return a.reject().promise();var h="/library/parts/"+u.id+"?"+c.key+"="+d,p=e.extend(o.server.getXHROptions(h),{type:"PUT"}),f=t.ajax(p);return f.done(function(){r.selectStream(l,c,d),o.trigger("change:streams"),a.resolve()}),f.fail(function(e){n.trigger("show:alert",{type:"error",message:i("There was a problem selecting the stream for this item.")}),a.reject(e)}),a.promise()}return s}),define("plex/base/commands/library/rateCommand",["jquery","plex/base/utils/t","plex/base/utils/dispatcher"],function(e,t,i){function n(n){var r=n.item,s=n.rating,a={key:r.get("ratingKey"),identifier:r.get("identifier"),rating:s},o="/:/rate?"+e.param(a,!0),l=e.ajax(r.server.getXHROptions(o));
return r.set("userRating",s),l.fail(function(){i.trigger("show:alert",{type:"error",message:t("There was a problem rating this item.")})}),l.promise()}return n}),define("plex/base/commands/security/getTransientTokenCommand",["underscore","jquery","plex/base/utils/parser"],function(e,t,i){function n(e){var n=t.Deferred(),r=e.server;if(!r.supports("transientToken"))return n.resolve(r.get("accessToken")).promise();var s={type:e.type||"delegation",scope:e.scope||"all"},a="/security/token?"+t.param(s,!0),o=t.ajax(r.getXHROptions(a));
return o.done(function(e){var t=i.parseXML(e);n.resolve(t.token)}),o.fail(function(e){n.reject(e)}),n.promise()}return n}),define("plex/base/commands/commands",["underscore","plex/base/utils/dispatcher","plex/base/commands/server/testServerConnectionCommand","plex/base/commands/server/testServerImageCommand","plex/base/commands/server/relayServerCommand","plex/base/commands/user/signInCommand","plex/base/commands/user/signUpCommand","plex/base/commands/user/signOutCommand","plex/base/commands/user/switchUserCommand","plex/base/commands/user/shareCommand","plex/base/commands/user/recommendCommand","plex/base/commands/library/selectStreamCommand","plex/base/commands/library/rateCommand","plex/base/commands/security/getTransientTokenCommand"],function(e,t,i,n,r,s,a,o,l,u,c,d,h,p){var f={map:{testServerConnection:i,testServerImage:n,relayServer:r,signIn:s,signUp:a,signOut:o,switchUser:l,share:u,recommend:c,selectStream:d,rate:h,getTransientToken:p},execute:function(t){var i=f.map,n=e.toArray(arguments).slice(1);
return i.hasOwnProperty(t)?i[t].apply(f,n):!1}};return t.on("command",function(t,i,n){var r=f.execute.apply(this,arguments);e.isFunction(n)&&n(r)}),f}),define("plex/chromecast/models/castSettingsModel",["backbone"],function(e){var t=e.Model.extend({defaults:{qualityIndex:-1,directPlay:!0,directStream:!0,subtitleSize:100,audioBoost:100}});return new t}),define("plex/chromecast/utils/CastReceiver",["underscore","backbone","jquery","plex/base/utils/dispatcher","plex/base/utils/BaseClass","plex/base/utils/playerUtil","plex/base/utils/playerQualities","plex/base/utils/Backlog","plex/base/utils/types/streamTypes","plex/chromecast/utils/constants/castCustomMessages","plex/base/mixins/eventMixin","plex/base/adapters/loggerAdapter","plex/base/commands/commands","plex/chromecast/models/castAppModel","plex/chromecast/models/castSettingsModel"],function(e,t,i,n,r,s,a,o,l,u,c,d,h,p,f){cast.receiver.logger.setLevelValue(cast.receiver.LoggerLevel.DEBUG);
var m=r.extend({mixins:c,wrapped:["onPlay","onPause","onSeek","onStop","onPrevious","onNext","onSkipTo","onRefreshPlayQueue","onSetQuality","onSetStream"],constructor:function(){e.bindAll(this,"getStatus","onCustomMessage","onSenderConnected","onSenderDisconnected","onShutdown","onLoad","onMetadataLoaded","onPlay","onPause","onSeek","onStop","onEnded"),this.backlog=new o,this.backlog.wrapAll(this.wrapped,function(){return!!this.controller},this);var t=document.createElement("div");t.load=function(){},this.mediaManager=new cast.receiver.MediaManager(t),this.castReceiverManager=new cast.receiver.CastReceiverManager.getInstance,this.castReceiverManager.onSenderConnected=this.onSenderConnected,this.castReceiverManager.onSenderDisconnected=this.onSenderDisconnected,this.castReceiverManager.onShutdown=this.onShutdown,this.customMessageBus=this.castReceiverManager.getCastMessageBus("urn:x-cast:plex"),this.customMessageBus.onMessage=this.onCustomMessage,this.mediaManager.customizedStatusCallback=this.getStatus,this.mediaManager.onLoad=this.onLoad,this.mediaManager.onMetadataLoaded=this.onMetadataLoaded,this.mediaManager.onLoadMetadataError=this.onLoadMetadataError,this.mediaManager.onPlay=this.onPlay,this.mediaManager.onPause=this.onPause,this.mediaManager.onSeek=this.onSeek,this.mediaManager.onStop=this.onStop,this.mediaManager.onEnded=this.onEnded,this.mediaManager.onError=this.onError,this.customMessageListeners={},this.customMessageListeners[u.PLAY]=this.onPlay,this.customMessageListeners[u.PAUSE]=this.onPause,this.customMessageListeners[u.STOP]=this.onStop,this.customMessageListeners[u.PREVIOUS]=this.onPrevious,this.customMessageListeners[u.NEXT]=this.onNext,this.customMessageListeners[u.SKIPTO]=this.onSkipTo,this.customMessageListeners[u.SHOWDETAILS]=this.onShowDetails,this.customMessageListeners[u.REFRESHPLAYQUEUE]=this.onRefreshPlayQueue,this.customMessageListeners[u.SETQUALITY]=this.onSetQuality,this.customMessageListeners[u.SETSTREAM]=this.onSetStream,this.listenTo(n,{"change:mediaElement":this.onMediaElementChange,"change:controller":this.onControllerChange,"change:error":this.onErrorChange})
},start:function(){this.castReceiverManager.start()},setPlayerController:function(e){this.controller&&this.stopListening(this.controller),this.controller=e,this.controller&&(this.listenTo(e.model,{"change:item":this.onPlayerItemChange,"change:loaded":this.onPlayerLoadedChange,"change:duration":this.onPlayerDurationChange,"change:state":this.onPlayerStateChange,seeking:this.onPlayerSeeking}),this.backlog.process())},navigateTo:function(e,i){if(e.media&&e.media.contentId){var r=e.media.customData;if(r){var s=r.server,a=r.user;
p.set("user",new t.Model(a)),r.key=e.media.contentId,r.autoplay=!!e.autoplay,s.uuid&&(s.machineIdentifier=s.uuid,delete s.uuid),s.scheme&&(s.protocol=s.scheme,delete s.scheme),this.customData=r,this.backlog.clear(),n.trigger("navigate",i,r)}}},broadcastStatus:function(e){e||(e={}),this.hasPendingLoad||this.mediaManager.broadcastStatus(e.includeMedia)},getStatus:function(e){if(e.customData=this.customData,e.volume&&null!=e.volume.level||(e.volume={level:0,muted:!1}),this.controller){var t=this.controller.model;
e.playerState=s.getCastStateByState(t.get("state")),e.currentTime=t.get("position")/1e3,e.customData.mediaIndex=t.get("mediaIndex"),e.customData.partIndex=t.get("partIndex"),e.customData.audioStreamID=t.get("audioStreamID"),e.customData.subtitleStreamID=t.get("subtitleStreamID"),e.customData.type=this.controller.type,e.customData.errorMessage=t.get("errorMessage");var i=t.get("qualityIndex");if(null!=i){var n=a.getQualityByIndex(i);e.customData.bitrate=n.bitrate}var r=t.get("transcodeServer");return r&&(e.customData.transcodeServerID=r.id),t.get("error")?this.idleReason=cast.receiver.media.IdleReason.ERROR:t.get("stopped")?this.idleReason||(this.idleReason=cast.receiver.media.IdleReason.FINISHED):this.idleReason=null,e.idleReason=this.idleReason,e
}return e.playerState=cast.receiver.media.PlayerState.IDLE,e.idleReason=this.idleReason,e},onCustomMessage:function(e){d.info("Received custom message: "+e.data);var t=JSON.parse(e.data),i=t.type;e.data=t,this.customMessageListeners.hasOwnProperty(i)?this.customMessageListeners[i].call(this,e):d.error("Invalid message type: "+i)},onSenderConnected:function(e){var t=this.castReceiverManager.getSenders().length;d.info("Sender connected. Total number of senders: "+t+". Data: "+e.data)},onSenderDisconnected:function(e){var t=this.castReceiverManager.getSenders().length;
d.warn("Sender disconnected. Reason: "+e.reason+". Total number of senders: "+t),t||e.reason!==cast.receiver.system.DisconnectReason.REQUESTED_BY_SENDER||window.close()},onShutdown:function(){if(this.controller){var e={async:!1,timeout:2e3};this.controller.stopPlaybackTracking(),this.controller.trackPlaybackEvent(),this.controller.stopSession({xhrOptions:e}),this.controller.timeline({state:s.states.STOPPED},e)}},onLoad:function(e){d.info("Load: "+JSON.stringify(e.data)),this.controller&&(this.idleReason=cast.receiver.media.IdleReason.INTERRUPTED),this.hasPendingLoad=!0,this.navigateTo(e.data,"player")
},onMetadataLoaded:function(){},onLoadMetadataError:function(){},onPlay:function(){this.controller.play()},onPause:function(){this.controller.pause()},onSeek:function(e){var t=1e3*e.data.currentTime;this.controller.setPosition(t),this.mediaManager.sendStatus(e.senderId,e.data.requestId,!0)},onStop:function(){this.idleReason=cast.receiver.media.IdleReason.CANCELLED,n.trigger("navigate","waiting")},onEnded:function(){},onError:function(){},onPrevious:function(){this.controller.skipPrevious({manual:!0})
},onNext:function(){this.controller.skipNext({manual:!0})},onSkipTo:function(e){this.controller.skipTo(e.data.key)},onShowDetails:function(e){this.controller||this.navigateTo(e.data,"details")},onRefreshPlayQueue:function(){this.controller.refreshPlayQueue()},onSetQuality:function(e){var t=e.data.bitrate,i=a.getNearestQualityIndex(t);f.set("qualityIndex",i),this.controller.model.set("qualityIndex",i)},onSetStream:function(t){var i=t.data.stream,n=l.getStreamTypeByString(i.type),r=h.execute("selectStream",{item:this.controller.model.get("item"),media:this.controller.model.get("media"),part:this.controller.model.get("part"),streamType:n,streamID:i.id});
r.then(e.bind(function(){this.controller.model.set(n.key,i.id)},this)),r.fail(function(e){d.error("Set stream error: "+e.statusText)})},onMediaElementChange:function(e){this.mediaManager.setMediaElement(e)},onControllerChange:function(e){this.setPlayerController(e)},onErrorChange:function(e){this.hasPendingLoad?(d.error("Load error: "+e),this.hasPendingLoad=!1,this.mediaManager.sendLoadError(cast.receiver.media.ErrorType.LOAD_FAILED,{errorMessage:e})):(d.error("Playback error: "+e),this.idleReason=cast.receiver.media.IdleReason.ERROR,this.customData.errorMessage=e)
},onPlayerItemChange:function(e,t){var i=t.get("key"),n=this.mediaManager.getMediaInformation();n.contentId=i,n.customData.key=i,this.broadcastStatus({includeMedia:!0})},onPlayerLoadedChange:function(e,t){if(t&&this.hasPendingLoad){d.success("Load complete"),this.hasPendingLoad=!1;var i=this.mediaManager.getMediaInformation();i.duration=e.get("duration")/1e3,this.mediaManager.sendLoadComplete()}},onPlayerDurationChange:function(e,t){var i=this.mediaManager.getMediaInformation();i.duration=t/1e3,this.broadcastStatus({includeMedia:!0})
},onPlayerStateChange:function(e,t){d.log("Player state change: "+t),this.broadcastStatus()},onPlayerSeeking:function(e){e.get("paused")&&this.broadcastStatus()}});return m}),define("plex/chromecast/initializers/castReceiverInitializer",["plex/base/utils/dispatcher","plex/chromecast/utils/CastReceiver"],function(e,t){var i={init:function(){e.trigger("navigate","waiting");var i=new t;i.start()}};return i}),define("plex/chromecast/models/CastServerModel",["plex/base/mixins/serverMixin","plex/base/models/BaseModel"],function(e,t){var i=t.extend({mixins:e});
return i}),define("tpl",["underscore","text"],function(e,t){var i={},n={version:"0.1.0",load:function(n,r,s,a){var o=function(t){t=e.template(t),t=a.isBuild?i[n]=t.source:new Function("obj","return "+t.source)(),s(t)};t.load(n,r,o,a)},write:function(e,t,n){i.hasOwnProperty(t)&&n('define("'+e+"!"+t+'", function () { return '+i[t]+";});\n")}};return n}),define("tpl!templates/chromecast/CastLoadingView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<img class="plex-logo-loading" src="img/plex-logo.svg">\n<div id="loading" class="loading loading-lg loading-inline"></div>\n';
return __p}}),define("plex/chromecast/mixins/viewMixin",["underscore","jquery"],function(e,t){var i={serializeData:function(){return this.model?this.model.toJSON():{}},render:function(){return this.template?this.$el.html(this.template(this.serializeData())):this.$el.empty(),this.bindUIElements(),this.bindToModel(),this.isRendered=!0,this},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=e.result(this,"_uiBindings");this.ui={},e.each(e.keys(t),function(e){this.ui[e]=this.$(t[e])
},this)}},onRender:function(){},close:function(){this.childViews&&(e.each(this.childViews,function(e){e.close()}),this.childViews.length=0),this.pendingDeferreds&&e.each(this.pendingDeferreds,function(e){e.reject()}),this.stopListening(),this.onClose()},onClose:function(){},addChildView:function(e,t){this.childViews||(this.childViews=[]),this.childViews.push(t),e.append(t.render().el),t.onRender()},removeChildView:function(t){this.stopListening(t),t.close(),t.$el.remove(),this.childViews=e(this.childViews).without(t)
},preloadImage:function(i){var n=t.Deferred(),r=new Image;return this.pendingDeferreds||(this.pendingDeferreds=[]),this.pendingDeferreds.push(n),r.onload=e.bind(function(){r.onload=r.onabort=r.onerror=null,n.resolve(i),this.pendingDeferreds=e(this.pendingDeferreds).without(n)},this),r.onabort=r.onerror=e.bind(function(){r.onload=r.onabort=r.onerror=null,n.reject(),this.pendingDeferreds=e(this.pendingDeferreds).without(n)},this),r.src=i,n.promise()}};return i}),define("plex/chromecast/views/CastLoadingView",["tpl!templates/chromecast/CastLoadingView.tpl","backbone","plex/chromecast/mixins/viewMixin"],function(e,t,i){var n=t.View.extend({mixins:[i],template:e});
return n}),define("tpl!templates/chromecast/CastWaitingView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<img class="chevron" src="img/chromecast/chevron-orange.svg">\n<h1>ready to cast</h1>\n<h2 class="text-muted">Choose some media in Plex and play it here.</h2>\n';return __p}}),define("tpl!templates/chromecast/WaitingBackgroundView.tpl",function(){return function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="background-container transition-out">\n  <div class="background" style="background-image: url('+(null==(__t=src)?"":__t)+')"></div>\n</div>\n';
return __p}}),define("plex/base/utils/transcoder",["underscore","jquery","plex/base/utils/mediaUtil","plex/base/adapters/loggerAdapter"],function(e,t,i,n){var r={extensions:{dash:".mpd",hls:".m3u8",http:""},logParams:function(t,i){var r=[];e.each(e.keys(i),function(e){r.push(e+": "+i[e])}),n.group("Transcoder: "+t+" options",r)},serializeParams:function(e){return t.param(e,!0)},image:function(t,i,n){if(!i)return"";var r=n.fallbackServer,s=!1;if(r)if(t.get("cloud"))s=!0;else if(t.get("synced")){var a=!t.get("activeConnection").isLocalAddress,o=r.get("activeConnection").isLocalAddress;
s=a||o}var l=s?r:t,u=l.id===t.id;t.get("cloud")&&(i=r?r.resolveUrl(i,{appendToken:!0}):t.resolveUrl(i,{appendToken:!0,connection:{address:"node.plexapp.com",port:"32400"}}));var c={url:t.resolveUrl(i,{useLoopback:u,appendToken:!0}),width:parseInt(n.width,10),height:parseInt(n.height,10)};n.minSize&&(c.minSize=1),n.format&&(c.format=n.format),n.filters&&e.each(n.filters,function(e,t){void 0!==e&&(c[t]=e)});var d="/photo/:/transcode?"+this.serializeParams(c,l);return l.resolveUrl(d,{appendToken:!0})
},music:function(t,i,n){var r=e.first(i.get("Media"));if(r){var s=e.first(r.Part);if(s){var a,o;return t.supports("universalMusicTranscoder")?(a=e.extend({path:t.resolveUrl(i.get("key"),{useLoopback:!0}),mediaIndex:0,partIndex:0},n),o="/music/:/transcode/universal/start.mp3"):(a={identifier:i.get("identifier"),url:t.resolveUrl(s.key,{useLoopback:!0}),format:"mp3",audioCodec:"libmp3lame",audioBitrate:320,audioSamples:44100},o="/music/:/transcode/generic.mp3"),this.logParams("Music",a),a=e.extend(a,t.getHeaders()),t.resolveUrl(o+"?"+this.serializeParams(a,t))
}}},video:function(t,n,r,s,a){a||(a={});var o=t.id===n.server.id,l=n.server.get("cloud")?t:n.server,u=e.extend({path:l.resolveUrl(n.get("key"),{useLoopback:o,appendToken:!o}),mediaIndex:i.getMediaIndex(n,r.id),partIndex:i.getPartIndex(r,s.key),protocol:"hls",offset:0,fastSeek:1,directPlay:0,directStream:1,subtitleSize:100,audioBoost:100},a);u.path=u.path.replace(/^http[s]?:\/\/node.plexapp.com:[\d]+\//,t.url()),this.logParams("Video",u);var c=n.get("indirectHttpHeaders");c&&(u.httpCookies=c.Cookie,u.userAgent=c["User-Agent"]),u=e.extend(u,t.getHeaders());
var d=this.extensions[u.protocol],h="/video/:/transcode/universal/start"+d;return t.resolveUrl(h+"?"+this.serializeParams(u,t))},subtitles:function(e,t){var i="/video/:/transcode/universal/session/"+t.session+"/subtitles";return e.resolveUrl(i,{appendToken:!0})}};return r}),define("plex/chromecast/views/SlideshowView",["underscore","jquery","backbone","plex/chromecast/mixins/viewMixin"],function(e,t,i,n){var r=i.View.extend({mixins:[n],className:"slideshow-container",events:{webkitTransitionEnd:"onTransitionEnd"},initialize:function(t){e.bindAll(this,"onImageLoad","onTransitionEnd"),this.playerModel=t.playerModel,this.itemTemplate=t.itemTemplate
},showImage:function(e,t){t||(t={}),this.skipTransition=t.skipTransition,this.preloadImage(e).done(this.onImageLoad)},replaceCurrentImage:function(e){this.$currentImg&&(this.$currentImg.remove(),this.$currentImg.addClass("transition-out"),this.$previousImg=this.$currentImg),this.$currentImg=e,this.$transitionImg=null},onImageLoad:function(e){this.playerModel&&this.playerModel.set("loaded",!0);var i;this.$previousImg?(this.$previousImg.find(".photo, .background").attr("style","background-image: url("+e+")"),i=this.$previousImg):i=t(this.itemTemplate({src:e})),this.$el.append(i),this.skipTransition?(i.removeClass("transition-out"),this.$transitionImg&&this.$transitionImg.remove(),this.replaceCurrentImage(i)):(i[0].offsetHeight,this.$transitionImg=i,this.$transitionImg.removeClass("transition-out"))
},onTransitionEnd:function(e){this.replaceCurrentImage(t(e.target))}});return r}),define("plex/chromecast/views/CastWaitingView",["tpl!templates/chromecast/CastWaitingView.tpl","tpl!templates/chromecast/WaitingBackgroundView.tpl","underscore","jquery","backbone","plex/base/utils/transcoder","plex/base/adapters/storageAdapter","plex/chromecast/mixins/viewMixin","plex/chromecast/models/castAppModel","plex/chromecast/models/CastServerModel","plex/base/models/library/MetadataCollection","plex/chromecast/views/SlideshowView"],function(e,t,i,n,r,s,a,o,l,u,c,d){var h=r.View.extend({mixins:[o],id:"waiting",className:"message-container",template:e,passive:!0,fanartDelay:15e3,initialize:function(){i.bindAll(this,"showFanart"),this.slideshow=new d({itemTemplate:t});
var e,n=this.getPrimaryServer();n=n.then(function(t){return e=t.get("fanart"),e||(e=new c([],{server:t,url:"/library/arts?sort=random",pageSize:50,skipCache:!0}),t.set("fanart",e)),e.populate()}),n.done(i.bind(function(){this.fanart=e,this.fanart.length&&(this.fanartInterval=setInterval(this.showFanart,this.fanartDelay),this.showFanart())},this))},getPrimaryServer:function(){var e=n.Deferred(),t=l.get("primaryServer");if(t)return e.resolve(t).promise();var i=a.get({key:"primaryServer"});return i.done(function(t){var i=new u(JSON.parse(t),{parent:l});
e.resolve(i)}),i.fail(function(){e.reject()}),e.promise()},showFanart:function(){if(this.isRendered&&this.fanart&&this.fanart.length){var e=Math.round(Math.random()*(this.fanart.length-1)),t=this.fanart.at(e),i=s.image(this.fanart.server,t.get("key"),{width:1280,height:720});this.slideshow.showImage(i)}},onRender:function(){this.$el.append(this.slideshow.render().el),this.showFanart()},onClose:function(){clearInterval(this.fanartInterval)}});return h}),define("tpl!templates/chromecast/CastMusicPlayerView.tpl",function(){return function(obj){{var __p="";
Array.prototype.join}with(obj||{})__p+='<div class="background slow-pan"></div>\n\n<div class="music-player-container title-safe-container">\n  <div class="music-current">\n    <div class="media-poster"></div>\n    <div class="music-details">\n      <div class="player-logo-container">\n        <img class="player-logo" src="img/plex-logo.svg">\n        <div class="player-paused-icon"><i class="plex-icon pause-alt"></i></div>\n      </div>\n\n      <div class="music-metadata">\n        <div class="music-artist"></div>\n        <div class="music-album text-muted"></div>\n        <div class="music-track text-muted"></div>\n      </div>\n\n      <div class="player-seek-bar-container">\n        <span class="player-position"></span>\n        <span class="player-duration"></span>\n        <div class="player-seek-bar">\n          <div class="player-slider-track">\n            <div class="player-slider-buffer"></div>\n            <div class="player-slider-progress"></div>\n          </div>\n        </div>\n        <div class="player-slider-thumb"></div>\n      </div>\n    </div>\n  </div>\n\n  <div class="music-next">\n    <div class="media-poster"></div>\n    <div class="music-details">\n      <div class="music-metadata">\n        <div class="music-artist"></div>\n        <div class="music-album text-muted"></div>\n        <div class="music-track text-muted"></div>\n      </div>\n    </div>\n  </div>\n</div>\n';
return __p}}),define("plex/base/utils/posterPlaceholders",[],function(){var e="placeholder-standard",t="placeholder-square",i="placeholder-widescreen",n="placeholder-folder",r="placeholder-friend",s={movie:e,show:e,season:e,episode:i,artist:t,album:t,track:t,photo:t,photoAlbum:t,clip:i,userPlaylistItem:i,playlist:t,playlistFolder:t,channel:t,channelDirectory:t,folder:n,friend:r,device:t,poster:e,art:i,banner:i};return s}),define("plex/base/utils/formatters/dateTimeUtil",["underscore","moment","plex/base/utils/t"],function(e,t,i){var n={formatHoursMinutes:function(e){var n=t.duration(e),r=n.hours()+24*n.days(),s=n.minutes(),a=n.seconds();
return r&&s?i("{1} hr {2} min",r,s):r?i("{1} hr",r):s?i("{1} min",s):a>0?i("{1} sec",a):""},formatMinutes:function(e){var n=t.duration(e),r=24*n.days()*60,s=60*n.hours(),a=n.minutes()+s+r,o=n.seconds();return a?i("{1} min",a):o>0?i("{1} sec",o):""},formatDaysHours:function(e){var n=t.duration(e),r=n.days(),s=n.hours(),a=i(r>1?"days":"day"),o=i(s>1||0>=s?"hours":"hour");return r&&s?r+" "+a+", "+s+" "+o:r?r+" "+a:s+" "+o},formatDays:function(e){var n=t.duration(e),r=365*n.years(),s=30*n.months(),a=r+s+n.days(),o=i(a>1||0>=a?"days":"day");
return a+" "+o},formatBroadDuration:function(e){return 54e5>=e?this.formatMinutes(e):864e5>=e?this.formatHoursMinutes(e):6048e5>=e?this.formatDaysHours(e):this.formatDays(e)},formatDate:function(e,i){return i||(i="MMMM D, YYYY"),e?t(e).format(i):""},formatTimestamp:function(e,i){return i||(i="MMMM D, YYYY"),e?t.unix(e).format(i):""},formatDuration:function(i){if(!e.isNumber(i))return"0:00";var n=t.duration(i),r=n.seconds(),s=n.minutes(),a=n.hours()+24*n.days(),o="";return o=10>r?":0"+r:":"+r,o=10>s&&a>0?"0"+s+o:s+o,a>0&&(o=a+":"+o),o
},formatMinutesRemaining:function(e){if(!e)return"";if(60>e)return 1===e?i("{1} second left",e):i("{1} seconds left",e);var t=Math.ceil(e/60);return 1===t?i("{1} minute left",t):i("{1} minutes left",t)},formatTimeAgo:function(e){return e?t.unix(e).fromNow():""}};return n}),define("plex/chromecast/utils/mediaElementPool",[],function(){var e={},t={createElement:function(t){if(e.hasOwnProperty(t))return e[t];var i=document.createElement(t);return e[t]=i,i}};return t}),define("plex/base/utils/constants/subtitlesBurnLevels",[],function(){var e={AUTO:"auto",AVOID:"avoid",ALWAYS:"always"};
return e.settings=[{value:e.AUTO,title:"Automatic"},{value:e.AVOID,title:"Avoid"},{value:e.ALWAYS,title:"Always"}],e}),define("plex/base/utils/mediaDecisionEngine",["underscore","jquery","plex/base/utils/t","plex/base/utils/mediaUtil","plex/base/utils/playerUtil","plex/base/utils/playerQualities","plex/base/utils/types/streamTypes","plex/base/utils/constants/subtitlesBurnLevels","plex/base/adapters/loggerAdapter"],function(e,t,i,n,r,s,a,o,l){var u={getMediaDecision:function(t){var i=this.augmentProfile(t),n=t.media;
if(n)return this.analyzeMedia(n,i,t);var r=t.item,s=r.get("Media");if(!s.length)return{canPlay:!0,canDirectPlay:!0};if(1===s.length)return this.analyzeMedia(e.first(s),i,t);var a=e.map(s,function(e){return this.analyzeMedia(e,i,t)},this);return this.getBestDecision(a)},augmentProfile:function(i){var n=i.profile;if(!n)throw new Error("MDE: No player profile provided for "+i.type);var r=t.extend(!0,{},n.directPlay),s=t.extend(!0,{},n.directStream),a=r.generic;return a&&delete r.generic,e.each(r,function(e,t){this.mergeGenericOptions(e,a),this.mergeMaxBitrateOption(e,i),this.mergeMaxVideoResolutionOption(e,i),"mp4"===t&&this.mergeAC3Option(e,i)
},this),this.mergeMaxBitrateOption(s,i),this.mergeMaxVideoResolutionOption(s,i),{directPlay:r,directStream:s}},mergeGenericOptions:function(t,i){if(i){var n=i.video,r=i.audio;e.defaults(t,e.omit(i,"video","audio")),n&&(t.video||(t.video={}),e.defaults(t.video,n)),r&&(t.audio||(t.audio={}),e.defaults(t.audio,r))}},mergeMaxBitrateOption:function(e,t){var i=r.getStreamByType(t.type),n=this.getMaxQualityOption(e,"bitrate",t);if(null!=n)if(e.hasOwnProperty("maxBitrate"))e.maxBitrate=n;else{var s=e[i]||{};
s.maxBitrate=n,e[i]=s}},mergeMaxVideoResolutionOption:function(e,t){if(t.type===r.types.VIDEO){var i=(r.getStreamByType(t.type),this.getMaxQualityOption(e,"videoResolution",t));null!=i&&(e.maxVideoResolution=i)}},getMaxQualityOption:function(e,t,i){var n=i.quality||{},r="max"+t.charAt(0).toUpperCase()+t.slice(1),a=n[t],o=this.getPrimaryStreamProperty(e,r,i);if("videoResolution"===t&&a&&(a=s.getResolutionFromSize(a)),a||o){var l;return l=a&&o?Math.min(a,o):a||o}},mergeAC3Option:function(t,i){if(i.type===r.types.VIDEO&&i.allowAC3){var n=t.audioCodec;
!n&&t.audio&&(n=t.audio.codec),n&&(e.isArray(n)||(n=[n]),e.contains(n,"ac3")||n.push("ac3"),t.audio?t.audio.codec=n:t.audioCodec=n)}},analyzeMedia:function(t,i,s){l.log("MDE: Starting analysis of "+this.getMediaTitle(t)),l.log("MDE: Analyzing direct play");var a={transcodeServer:s.transcodeServer,media:t,canDirectPlay:this.canDirectPlay(t,i.directPlay,s)},o=s.transcoderOptions||{};if(e.isFunction(o)&&(o=o(a)),s.type===r.types.VIDEO){l.log("MDE: Analyzing video direct stream");var u=n.getSelectedVideo(t);
u&&(a.canDirectStreamVideo=this.canDirectStream(u,i.directStream.video,s,o))}if(s.type!==r.types.PHOTO){l.log("MDE: Analyzing audio direct stream");var c=n.getSelectedAudio(t);c&&(a.canDirectStreamAudio=this.canDirectStream(c,i.directStream.audio,s,o))}var d=n.getSelectedSubtitles(a.media);return d&&!s.ignoreSubtitles&&(l.log("MDE: Analyzing subtitles"),e.extend(a,this.analyzeSubtitles(d,s))),l.log("MDE: Analyzing playability"),e.extend(a,this.canPlay(a,s)),e.extend(a,this.getEffectiveQuality(t,i.directStream,s)),l.group("MDE: Finished analysis of "+this.getMediaTitle(t),this.getDecisionLogs(a)),a
},canDirectPlay:function(t,i,s){if(s.forceDirectPlay)return l.log("MDE: Direct play forced"),!0;if(s.type===r.types.VIDEO&&!this.canDirectPlayVideo(t,s))return!1;var o=i[t.container];if(!o)return l.warn("MDE: Direct play failed; unsupported container: "+t.container),!1;var u=e.keys(o);if(u&&u.length){for(var c=0,d=u.length;d>c;c++){var h=u[c],p=o[h];if("mimeType"===h){if(!this.canPlayType(r.getElementByType(s.type),p))return l.warn("MDE: Direct play failed; canPlayType test, "+h+": "+p),!1}else if("video"===h||"audio"===h){var f=a.getStreamTypeByString(h),m=n.getStreams(t,{streamType:f.id}),g="video"===h?n.getSelectedVideo(t):n.getSelectedAudio(t);
if(!g)continue;var v="audio"===h&&g!==m[0];if(v&&!s.allowMultiTrackAudio)return l.warn("MDE: Direct play failed; multi-track audio is required"),!1;if(!this.analyzeStream(g,p,s))return!1}else if(!this.validateProfileProperty(h,p,t))return!1}return!0}return!0},canDirectPlayVideo:function(e,t){return t.allowDirectPlay?"hls"!==e.protocol||t.hasFlash||t.hasNativeHLS?"flv"!==e.container||t.hasFlash?!0:(l.warn("MDE: Direct play failed; cannot play FLV"),!1):(l.warn("MDE: Direct play failed; cannot play HLS"),!1):(l.warn("MDE: Direct play failed; option is disabled"),!1)
},canPlayType:function(e,t){if(e===r.elements.PHOTO)return!0;if(e===r.elements.MUSIC&&window.soundManager)return window.soundManager.canPlayMIME(t);var i=document.createElement(e);return!(!i.canPlayType||!i.canPlayType(t).replace(/^no$/,""))},canDirectStream:function(e,t,i,n){return n.directStream?this.analyzeStream(e,t,i):(l.warn("MDE: Direct stream failed; option is disabled"),!1)},analyzeStream:function(t,i){var n=e.keys(i);if(n&&n.length)for(var r=0,s=n.length;s>r;r++){var a=n[r],o=i[a];if(!this.validateProfileProperty(a,o,t))return!1
}return!0},validateProfileProperty:function(t,i,n){var r,a=t.match(/^max(\w)(\w*)/);if(a){if(t=a[1].toLowerCase()+a[2],r=n[t],null!=r&&"videoResolution"===t&&(r=s.getHeightFromResolution(r),i=s.getHeightFromResolution(i)),null!=r&&r>i)return l.warn("MDE: Invalid profile property; "+t+": "+r+" > "+i),!1}else if(r=n[t],r!=i&&!e.contains(i,r))return l.warn("MDE: Invalid profile property; "+t+": "+r+" != "+i),!1;return!0},analyzeSubtitles:function(e,t){var i=t.subtitlesBurnLevel||o.ALWAYS,n=e.codec;return l.warn("MDE: Direct play failed; "+n+" subtitles"),l.log("MDE: Burn level: "+i),i===o.ALWAYS?{useSoftSubtitles:!1,canDirectPlay:!1,canDirectStreamVideo:!1}:/^(pgs|vobsub)$/i.test(n)?(l.warn("MDE: Soft subtitles failed; bitmap subtitles"),{useSoftSubtitles:!1,canDirectPlay:!1,canDirectStreamVideo:!1}):/^(ass)$/i.test(n)&&i===o.AUTO?(l.warn("MDE: Soft subtitles failed; ASS subtitles"),{useSoftSubtitles:!1,canDirectPlay:!1,canDirectStreamVideo:!1}):{useSoftSubtitles:!0,canDirectPlay:!1}
},canPlay:function(e,t){return false; var i=this.validateParts(e,t)||this.validatePremium(e,t)||this.validateTranscoder(e,t);return i?{canPlay:!1,errorMessage:i}:{canPlay:!0}},validateParts:function(t){var r=n.getMissingParts(t.media);if(r.length){l.warn("MDE: Unable to play; missing parts");var s=e.first(r);return i(1==s.exists?"Please check the permissions for this file.":"Please check that the file exists and the necessary drive is mounted.")}},validatePremium:function(e,t){var n=t.item.server.get("myPlexSubscription");
return e.media.premium&&n===!1?(l.warn("MDE: Unable to play; premium content requires a Plex Pass"),i("Premium content requires your server be connected with a Plex Pass subscription.")):void 0},validateTranscoder:function(e,t){if(!e.canDirectPlay){var n=t.transcodeServer;if(t.type===r.types.VIDEO){var s=n.get("transcoderVideo"),a=e.canDirectStreamVideo||!n.get("transcoderVideoRemuxOnly");if(!s||!a)return l.warn("MDE: Unable to play; server unable to transcode video"),i("This server is not powerful enough to convert video.")
}else if(t.type===r.types.MUSIC){var o=n.get("transcoderAudio");if(!o)return l.warn("MDE: Unable to play; server unable to transcode music"),i("This server is not powerful enough to convert music.")}}},getEffectiveQuality:function(e,t,i){var a=i.quality,o={},l={};if(i.type===r.types.VIDEO){o.bitrate=e.bitrate,o.videoResolution=s.getHeightFromResolution(e.videoResolution);var u=this.getPrimaryStreamProperty(t,"maxBitrate",i);if(u){var c=n.getSelectedVideo(e),d=c?c.bitrate:e.bitrate;o.bitrate=Math.min(d,u),l.maxVideoBitrate=u
}if(a){var h=a.videoResolution;if(h){var p=s.getResolutionFromSize(a.videoResolution),f=s.getHeightFromResolution(p);o.videoResolution=Math.min(o.videoResolution,f)}l.videoQuality=a.videoQuality,l.videoResolution=a.videoResolution}}else if(i.type===r.types.MUSIC){o.bitrate=e.bitrate;var m=this.getPrimaryStreamProperty(t,"maxBitrate",i);m&&(o.bitrate=Math.min(e.bitrate,m),l.maxAudioBitrate=m)}return o.transcoderQualityOptions=l,o},getPrimaryStreamProperty:function(e,t,i){var n=r.getStreamByType(i.type),s=e[n],a=e[t];
return null==a&&s&&(a=s[t]),a},getMediaTitle:function(t){if(t.title)return t.title;var i=t.videoResolution||t.bitrate,n=e.compact([t.container,t.videoCodec,t.audioCodec]);return n.length&&(i+=" ("+n.join(", ")+")"),i},getDecisionLogs:function(t){var i=["canPlay: "+t.canPlay,"canDirectPlay: "+t.canDirectPlay],n=t.canDirectStreamVideo;null!=n&&i.push("canDirectStreamVideo: "+n);var r=t.canDirectStreamAudio;null!=r&&i.push("canDirectStreamAudio: "+r);var s=t.useSoftSubtitles;null!=s&&i.push("useSoftSubtitles: "+s);
var a=t.bitrate;null==a||e.isNaN(a)||i.push("bitrate: "+a);var o=t.videoResolution;return null==o||e.isNaN(o)||i.push("videoResolution: "+o),i},getBestDecision:function(t){var i=e.last(this.sortDecisions(t));return l.group("MDE: Selected "+this.getMediaTitle(i.media)+" to play",this.getDecisionLogs(i)),i},sortDecisions:function(t){return e.chain(t).reverse().sortBy(this.preferHigherBitrate,this).sortBy(this.preferMoreAudioChannels,this).sortBy(this.preferDirectStreamAudio,this).sortBy(this.preferHigherResolution,this).sortBy(this.preferDirectStreamVideo,this).sortBy(this.preferDirectPlay,this).sortBy(this.preferHigherResolutionIfCapable,this).sortBy(this.preferPlayable,this).value()
},preferPlayable:function(e){return void 0===e.canPlay?null:e.canPlay},preferHigherResolutionIfCapable:function(e){var t=e.transcodeServer,i=t.get("transcoderVideo"),n=t.get("transcoderVideoRemuxOnly");return i&&!n&&(e.canDirectPlay||e.canDirectStreamVideo)?this.preferHigherResolution(e):null},preferDirectPlay:function(e){return void 0===e.canDirectPlay?null:e.canDirectPlay},preferDirectStreamVideo:function(e){return void 0===e.canDirectStreamVideo?null:e.canDirectStreamVideo},preferHigherResolution:function(e){return void 0===e.videoResolution?null:e.videoResolution
},preferDirectStreamAudio:function(e){return void 0===e.canDirectStreamAudio?null:e.canDirectStreamAudio},preferMoreAudioChannels:function(e){var t=e.media.audioChannels;return void 0===t?null:t},preferHigherBitrate:function(e){return void 0===e.bitrate?null:e.bitrate}};return u}),define("plex/base/utils/playerDecisionEngine",["underscore","jquery","plex/base/utils/t","plex/base/utils/playerUtil","plex/base/utils/mediaUtil","plex/base/utils/mediaDecisionEngine","plex/base/utils/formatters/stringUtil","plex/base/adapters/loggerAdapter"],function(e,t,i,n,r,s,a,o){var l={getPlayerDecision:function(i){var n=i.item.server;
e.defaults(i,{offset:0,minVersionForDASH:n.features.dash,minVersionForStreamingMKV:n.features.streamingMKV,transcoderOptions:{}});var r={session:a.random(),offset:i.offset},s=this.resolveMedia(r,i);return s=s.then(function(){return t.when(r.url)}),s=s.then(function(e){return r.url=e,r})},resolveMedia:function(i,n){var r=e.extend({transcodeServer:this.resolveTranscodeServer(n)},n),a=s.getMediaDecision(r),l=a.media,u=t.Deferred();return e.extend(i,a),l?i.canPlay?"webkit"===l.protocol?(o.warn("PDE: Webkit videos are not supported"),i.redirect=!0,u.reject(i).promise()):"embed"===l.protocol?(o.warn("PDE: An embed is required"),i.embed=!0,i.part=e.first(l.Part),u.reject(i).promise()):this.resolvePart(i,n):(o.error("PDE: Unable to play item; "+i.errorMessage),u.reject(i).promise()):this.resolveUrls(i,n)
},resolveTranscodeServer:function(e){var t=e.item.server,i=e.fallbackServer;if(t===i||!i)return t;var r;return e.type===n.types.VIDEO?r="transcoderVideo":e.type===n.types.MUSIC&&(r="transcoderAudio"),r&&!t.get(r)&&i.get(r)?i:t},resolvePart:function(t,i){return i.part?t.part=i.part:i.offset?1===t.media.Part.length?t.part=t.media.Part[0]:(t.part=r.getPartByAbsoluteOffset(t.media,i.offset),t.offset=r.getRelativeOffset(t.media,t.part,i.offset)):t.part=e.first(t.media.Part),t.media.indirect?this.resolveIndirect(t,i):this.resolveUrls(t,i)
},resolveIndirect:function(i,n){o.log("PDE: Resolving indirect item");var r=n.item.resolveIndirect(i.media,i.part),s=e.bind(function(){return this.resolveMedia(i,n)},this),a=e.bind(function(){return o.warn("PDE: A redirect is required"),i.redirect=!0,t.Deferred().reject(i).promise()},this);return r=r.then(s,a)},resolveUrls:function(e,i){var n=t.Deferred();return this.validatePlayerType(e,i)?(this.validateSoftSubtitles(e,i)?e.subtitlesUrl=this.resolveSubtitlesUrl(e,i):e.useSoftSubtitles&&(e.useSoftSubtitles=!1),o.group("PDE: Player decision",["Player: "+e.playerType,"Protocol: "+e.protocol,"Direct Play: "+e.canDirectPlay]),e.url=e.canDirectPlay?this.resolveDirectPlayUrl(e,i):this.resolveTranscoderUrl(e,i),n.resolve(e).promise()):n.reject(e).promise()
},validatePlayerType:function(e,t){if(!e.media||t.type!==n.types.VIDEO)return e.protocol="http",e.playerType="html",!0;if(e.canDirectPlay)return e.protocol="http",e.playerType="hls"!==e.media.protocol||t.hasNativeHLS?"flv"===e.media.container?"flash":"html":"flash",!0;var r=e.transcodeServer;return t.hasNativeHLS?(e.protocol="hls",e.playerType="html",!0):t.hasStreamingMKV&&r.isVersionOrNewer(t.minVersionForStreamingMKV)?(e.protocol="http",e.playerType="html",!0):t.hasDASH?r.isVersionOrNewer(t.minVersionForDASH)?(e.protocol="dash",e.playerType="html",!0):(e.errorMessage=i("HTML5 streaming requires Plex Media Server {1} or later.",t.minVersionForDASH),!1):t.hasFlash?(e.protocol="hls",e.playerType="flash",!0):(e.errorMessage=i("This browser does not support video streaming."),!1)
},validateSoftSubtitles:function(e){return e.useSoftSubtitles&&"html"!==e.playerType?(o.warn("PDE: Only the HTML player supports soft subtitles"),!1):e.useSoftSubtitles},resolveDirectPlayUrl:function(e,t){var i=t.item,n=e.part;if(n){var r=/(googlevideo|youtube).com/.test(n.key);return"flv"===n.container&&r&&n.postURL?n.postURL:i.server.resolveUrl(n.key,{appendToken:!0})}return i.server.resolveUrl(i.get("key"),{appendToken:!0})},resolveTranscoderUrl:function(t,i){var r=i.item,s=t.media,a=t.part,l=i.transcoderOptions;
e.isFunction(l)&&(l=l(t)),l=e.extend({},t.transcoderQualityOptions,l,{protocol:t.protocol,session:t.session,offset:t.offset/1e3}),i.type===n.types.VIDEO&&(l.subtitles=i.ignoreSubtitles?"none":t.useSoftSubtitles?"http":"burn");var u=i.profileExtra;e.isFunction(u)&&(u=u(t)),l["X-Plex-Client-Profile-Extra"]=u,("hls"===l.protocol&&!i.useOffsetHLS||"dash"===l.protocol)&&(o.log("PDE: DASH and HLS should seek forward by default, offset=0"),l.offset=0),"hls"===l.protocol&&i.useOffsetHLS&&(t.useOffsetHLS=!0,l.offset&&(o.log("PDE: HLS started with an offset, copyts=0"),l.copyts=0)),e.each(e.keys(l),function(e){var t=l[e];
null==t&&delete l[e]});var c=i.type,d=i.transcoder,h=t.transcodeServer;return c===n.types.VIDEO?d.video(h,r,s,a,l):c===n.types.MUSIC?d.music(h,r,l):c===n.types.PHOTO?(l.fallbackServer=i.fallbackServer,d.image(h,r.getMediaKey(),l)):void 0},resolveSubtitlesUrl:function(e,t){var i=t.transcoder,n=t.transcodeServer;return i.subtitles(n,{session:e.session})}};return l}),define("plex/base/mixins/player/playerControllerMixin",["underscore","jquery","plex/base/utils/playerUtil","plex/base/utils/mediaUtil","plex/base/adapters/analyticsAdapter","plex/base/models/sessionStatsModel"],function(e,t,i,n,r,s){var a={playbackDuration:0,modelDefaults:function(){var t=e.omit(this.model.defaults,["item","playQueue","transcodeServer","state","stopped","paused","playing","buffering","error","volume","shuffle","repeat"]);
return e.extend(t,{item:this.currentItem,type:this.type,canSkipPrevious:!!this.previousItem,canSkipNext:!!this.nextItem})},initialize:function(){this.stoppedSessions={},this.stop=e.wrap(this.stop,e.bind(function(e){return!this.model||this.model.get("stopped")?t.Deferred().resolve().promise():e.apply(this,[].slice.call(arguments,1))},this)),this.seekBackward=e.bind(this.seek,this,-15e3,0,0),this.seekForward=e.bind(this.seek,this,3e4,0,3e3),this.stepBackward=e.bind(this.seek,this,-6e5,0,0),this.stepForward=e.bind(this.seek,this,6e5,0,3e3)
},request:function(t){return this.pendingRequests||(this.pendingRequests=[]),this.pendingRequests.push(t),t.always(e.bind(function(){var i=e.indexOf(this.pendingRequests,t);this.pendingRequests.splice(i,1)},this)),t},waitForRequests:function(){return t.when.apply(t,this.pendingRequests)},reset:function(t){return this.currentItem&&(this.timeline({state:i.states.STOPPED,continuing:!0}),this.stopTimeline(),this.stopSession()),this.currentItem=t,this.previousItem=this.getPreviousItem(t),this.nextItem=this.getNextItem(t),this.model.set(e.result(this,"modelDefaults")),t
},getPreviousItem:function(e,t){e||(e=this.model.get("item")),t||(t={});var i=this.model.get("playQueue");if(i=i&&i.get("collection"),!i||!e)return null;var n=i.get(e.id||e.cid),r=i.indexOf(n);return r>0?i.at(r-1):t.loop&&i.length>1?i.at(i.length-1):null},getNextItem:function(e,t){e||(e=this.model.get("item")),t||(t={});var i=this.model.get("playQueue");if(i=i&&i.get("collection"),!i||!e)return null;var n=i.get(e.id||e.cid),r=i.indexOf(n);return r+1<i.length?i.at(r+1):t.loop&&i.length>1?i.at(0):null
},mirror:function(){},play:function(){},pause:function(){},playPause:function(){this.model.get("state")===i.states.PAUSED?this.play():this.pause()},setPosition:function(){},canSeek:function(e){return e!==this.model.get("position")&&e<=this.model.get("duration")&&e>=0},seek:function(e,t,i,n){var r=this.model.get("position")+e,s=0+(t>=0?t:0),a=this.model.get("duration")-(i>=0?i:0);r=Math.max(s,Math.min(r,a)),this.setPosition(r,n)},setVolume:function(){},decreaseVolume:function(){var e=this.model.get("volume");
this.setVolume(Math.round(Math.max(e-10,0)))},increaseVolume:function(){var e=this.model.get("volume");this.setVolume(Math.round(Math.min(e+10,100)))},skipPrevious:function(){return this.previousItem?this.reset(this.previousItem):!1},skipNext:function(){return this.nextItem?this.reset(this.nextItem):!1},skipTo:function(e){var t=this.model.get("playQueue");if(t=t&&t.get("collection"),!t)return!1;var i=t.findWhere({key:e});return this.reset(i)},removeItem:function(e){return this.model.get("playQueue").removeItem(e)
},moveItem:function(e,t){return this.model.get("playQueue").moveItem(e,t)},stop:function(e){e&&e.silent||this.model.set("state",i.states.STOPPED),this.stopListening()},timeline:function(i){return i||(i={}),e.defaults(i,this.model.attributes),this.companion||!i.item?t.Deferred().resolve().promise():this.request(n.timeline(i))},startTimeline:function(){this.companion||this.timelineInterval||(this.timelineInterval=setInterval(e.bind(this.timeline,this),n.timelineDelay))},stopTimeline:function(){this.timelineInterval=clearInterval(this.timelineInterval),this.trackPlaybackEvent()
},ping:function(){return this.companion?t.Deferred().resolve().promise():this.request(n.ping(this.model.get("transcodeServer"),this.session))},startPing:function(){var t=this.model.get("directPlay"),r=!this.companion&&this.type!==i.types.PHOTO;!r||t||this.pingInterval||(this.pingInterval=setInterval(e.bind(this.ping,this),n.pingDelay))},stopPing:function(){this.pingInterval=clearInterval(this.pingInterval)},stopSession:function(r){var s=this.session,a=s||e.uniqueId("no-session-"),o=r&&r.xhrOptions||{};
if(this.stoppedSessions.hasOwnProperty(a))return this.stoppedSessions[a];this.subcontroller&&this.subcontroller.stop(r);var l;return l=s&&this.type!==i.types.PHOTO&&!this.model.get("directPlay")?this.request(n.stop(this.model.get("transcodeServer"),s,o)):t.Deferred().resolve().promise(),this.stoppedSessions[a]=l,l},startPlaybackTracking:function(){this.companion||this.playbackInterval||(this.playbackInterval=setInterval(e.bind(function(){this.playbackDuration++},this),n.playbackDelay))},stopPlaybackTracking:function(){this.playbackInterval=clearInterval(this.playbackInterval)
},trackPlaybackEvent:function(){if(!this.companion){s.incPlaybackCount();var e=this.model.get("item"),t=e.get("identifier");!t&&e.parent&&(t=e.parent.get("identifier")),r.trackEvent({eventCategory:"Playback",eventAction:e.get("type"),eventLabel:t,eventValue:this.playbackDuration}),this.playbackDuration=0}}};return a}),function(){var e={};!function(){function t(){n||console.log.apply(console,arguments);for(var e=Math.round(Date.now()-s),t=[],i=0;i<arguments.length;i++){var r=""+arguments[i];"[obj"!=r.slice(0,4)&&t.push(r)
}var a=e+": "+t.join(", "),o=document.getElementById("console");o&&(o.value+=a+"\n"),n&&console.log(a)}function i(e){r>=e&&t.apply(null,arguments)}var n=!!(window.console&&window.console.log&&window.console.log.call),r=0,s=(new Date).getTime();e.dlog=i,e.log=t,e.DLOG_LEVEL=r}(),function(){var t={SMOOTH_STREAMING:"smoothstreaming",DASH:"dash"};e.StreamingType=t}(),function(){var t=function(e){this.ttml_=e,this.frameRate_=30};t.prototype.xmlDecode_=function(e){return e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")
},t.prototype.parseChildElements_=function(e,t,i){var n=[];if(null==i)return n;for(var r=i.firstElementChild;null!=r;r=r.nextElementSibling)r.nodeName==e&&n.push(t.call(this,r));return n},t.prototype.parseAttributes_=function(e,t){var i={};for(var n in e)null!=t.attributes.getNamedItem(n)&&(i[n]=e[n](t.attributes[n].value));return i},t.prototype.parseTime_=function(e){var t=e.split(":"),i=3600*parseFloat(t[0])+60*parseFloat(t[1])+parseFloat(t[2])+parseFloat(t[3])/this.frameRate_;return i},t.prototype.parseTextTrack_=function(e){var t=this.xmlDecode_(e.replace(/[\r\n]+/g,"").replace(/ {2,}/g," ").replace(/<[^>]+>/g,"").replace(/<br\s*\/>/g,"\n"));
return t.trim()},t.prototype.parse_cue_=function(e){var t=this.parseAttributes_({begin:this.parseTime_.bind(this),end:this.parseTime_.bind(this)},e);return t&&(t.caption=this.parseTextTrack_(e.textContent),t.start=t.begin,delete t.begin),t},t.prototype.parse_div_=function(e){return this.parseChildElements_("p",this.parse_cue_,e)},t.prototype.parse_body_=function(e){var t=this.parseChildElements_("div",this.parse_div_,e);return t[0]},t.prototype.parse_ttml_=function(e){var t=this.parseChildElements_("body",this.parse_body_,e);
return t[0]},t.prototype.parse=function(){for(var e=new DOMParser,t=e.parseFromString(this.ttml_,"text/xml"),i=0;i<t.childNodes.length;i++)if("tt"===t.childNodes[i].nodeName)return this.parse_ttml_(t.childNodes[i])},e.Ttml=t}(),function(){var t=0,i=1,n=function(e){if(null==e)throw new Error("A url for the close captions location is required");this._url=e,this._callback=null,this._ccInfo=null};n.prototype.ccType=function(){return t},n.prototype.requestCC=function(){var e=new XMLHttpRequest;e.addEventListener("load",this.onCCLoad.bind(this)),e.addEventListener("error",this.onCCError.bind(this)),e.open("GET",this._url),e.send()
},n.prototype.load=function(t){if(null==t)throw new Error("A callback is required");this._callback=t,this.requestCC(),e.dlog(1,"Sent request to get the close captions info")},n.prototype.getCCInfo=function(){return this._ccInfo},n.prototype.onCCError=function(){var t="Error geting captions from "+this._url;return e.log(t),this._callback(t)},n.prototype.onCCLoad=function(n){e.dlog(2,"Close Captions Info received");var r=null;if(200!==n.target.status||n.target.status>299)return r="HTTP error "+n.target.status+" retrieving close captions from "+this._url,e.log(r),this._callback(r);
switch(this.ccType()){case t:this._ccInfo=new e.Ttml(n.target.responseText).parse();break;case i:throw new Error("VTT parsing not implemented yet")}return null===this._ccInfo?(r="Error parsing the close captions info",e.log(r),this._callback(r)):this._callback(r,this._ccInfo)},e.CloseCaptionsLoader=n}(),function(){function t(e){return e}function i(e){var t=/PT(([0-9]*)H)?(([0-9]*)M)?(([0-9.]*)S)?/,i=t.exec(e);return i?3600*parseFloat(i[2]||0)+60*parseFloat(i[4]||0)+parseFloat(i[6]||0):parseFloat(e)
}function n(e,t,i){var n=[];if(null==i)return n;for(var r=i.firstElementChild;null!=r;r=r.nextElementSibling)r.nodeName==e&&n.push(t(r));return n}function r(e,t,i){return n(e,t,i)[0]||null}function s(e,t,i){i=i||{};for(var n in e)null!=t.attributes.getNamedItem(n)&&(i[n]=e[n](t.attributes[n].value));return i}function a(e){var t=/([0-9]+)(\/([0-9]+))?/.exec(e);return t?t[3]?parseFloat(t[1])/(parseFloat(t[3])||1):parseFloat(t[1]):1}function o(e){var t=/([0-9]+)-([0-9]+)/.exec(e);if(!t)return null;var i=parseInt(t[1]),n=parseInt(t[2]);
return{start:i,end:n,length:n-i+1}}function l(e){return s(w,e)}function u(e){return e.textContent}function c(e){return o(e.attributes.range.value)}function d(e){var t=s(S,e);return t.initialization=r("Initialization",c,e),t}function h(e){return s(_,e)}function p(e){var t=d(e);return t.durationSeconds=t.timescale&&t.duration?t.duration/t.timescale:t.duration,t.segmentURLs=n("SegmentURL",l,e),t}function f(e){var t=s(P,e);return t.baseURLs=n("BaseURL",u,e),t.segmentBase=r("SegmentBase",d,e),t.segmentList=r("SegmentList",p,e),t.contentProtection=r("ContentProtection",k,e),t
}function m(e){var t=f(e);return s(M,e,t),t}function g(e){var t=f(e);t.representations=n("Representation",m,e),t.segmentTemplate=r("SegmentTemplate",h,e);for(var i=0;i<t.representations.length;i++)t.representations[i].segmentTemplate=t.segmentTemplate;return t}function v(e){var t=f(e);return s(C,e,t),t.adaptationSets=n("AdaptationSet",g,e),t}function y(e){var t={};return s({mediaPresentationDuration:i},e,t),t.periods=n("Period",v,e),t.baseURLs=n("BaseURL",u,e),t}function b(e,t){e.manifestURL=t,e.duration=e.mediaPresentationDuration,delete e.mediaPresentationDuration,e.adaptationSets=e.periods[0].adaptationSets,delete e.periods;
for(var i=0;i<e.adaptationSets.length;i++)e.adaptationSets[i].mimeType?(e.adaptationSets[i].mime=e.adaptationSets[i].mimeType,delete e.adaptationSets[i].mimeType):e.adaptationSets[i].mime=e.adaptationSets[i].representations[0].mimeType,e.adaptationSets[i].codecs||(e.adaptationSets[i].codecs=e.adaptationSets[i].representations[0].codecs);return e}function x(e,t){var i=new DOMParser,n=i.parseFromString(e,"text/xml");return b(y(n.firstChild),t)}var w={media:t,mediaRange:o,index:t,indexRange:o},S={timescale:parseInt,duration:parseInt,indexRange:o,presentationTimeOffset:parseInt,startNumber:parseInt},_={timescale:parseInt,duration:parseInt,initialization:t,media:t,startNumber:parseInt},k=function(e){var t=e.attributes.schemeIdUri;
if(!t||"http://youtube.com/drm/2012/10/10"!=t.textContent)return null;for(var i={},n=e.firstElementChild;null!=n;n=n.nextElementSibling)if("yt:SystemURL"==n.nodeName){var r=n.attributes.type.textContent;i[r]=n.textContent}return i},P={id:t,profiles:t,width:parseInt,height:parseInt,frameRate:a,audioSamplingRate:parseInt,mimeType:t,codecs:t},M={bandwidth:parseInt,qualityRanking:parseInt},C={id:parseInt,start:i,duration:i};e.parseDASHManifest=x}(),function(){function t(e){for(var t=new DataView(e),i=0;i<e.byteLength;){var n=t.getUint32(i+4,!1);
if(1936286840==n||1836019558==n)break;i+=t.getUint32(i,!1)}return new Uint8Array(e.slice(0,i))}function i(e,t){for(var i=new DataView(e),n=0;1936286840!=i.getUint32(n+4,!1);)if(n+=i.getUint32(n,!1),n>=e.byteLength)throw"Could not find sidx";var r=i.getUint32(n,!1)+n;if(r>e.byteLength)throw"sidx terminates after array buffer";var s=i.getUint8(n+8);n+=12;var a=i.getUint32(n+4,!1);n+=8;var o,l;0==s?(o=i.getUint32(n,!1),l=i.getUint32(n+4,!1),n+=8):(o=(i.getUint32(n,!1)<<32)+i.getUint32(n+4,!1),l=(i.getUint32(n+8,!1)<<32)+i.getUint32(n+12,!1),n+=16),l+=r+(t||0);
var u=i.getUint16(n+2,!1);n+=4;for(var c=l,d=o,h=[],p=0;u>p;p++){var f=i.getUint32(n,!1),m=2147483648&f;if(m)throw"Unhandled indirect reference";f=2147483647&f;var g=i.getUint32(n+4,!1);n+=12,h.push({size:f,offset:c,duration:g/a,time:d/a}),c+=f,d+=g}if(n!=r)throw"Error: final pos "+n+" differs from SIDX end "+r;return h}window.ArrayBuffer&&!window.ArrayBuffer.prototype.slice&&(window.ArrayBuffer.prototype.slice=function(e,t){var i=new Uint8Array(this);null==t&&(t=i.length);for(var n=new ArrayBuffer(t-e),r=new Uint8Array(n),s=0;s<r.length;s++)r[s]=i[s+e];
return n}),e.extractInit=t,e.parseSIDX=i}(),function(){function t(e){return e}function i(e){for(var t=new ArrayBuffer(e.length/2),i=new Uint8Array(t),n=0;n<e.length;n+=2)i[n/2]=parseInt(e.substr(n,2),16);return i}function n(e){for(var t=[],i=0;i<e.length;i+=2)t.push(parseInt(e.substr(i,2),16));return t}function r(e){return i(e.replace(/[{}-]/g,""))}function s(e,t,i){var n=[];if(null==i)return n;for(var r=i.firstElementChild;null!=r;r=r.nextElementSibling)r.nodeName==e&&n.push(t(r));return n}function a(e,t,i){i=i||{};
for(var n in e)null!=t.attributes.getNamedItem(n)&&(i[n]=e[n](t.attributes[n].value));return i}function o(t){var i={},r=t.split("00000001");return 3!==r.length?(t||(e.log("Warning, Audio codec private data is not specified."),t="1210"),i=n(t)):(i.SPS=n(r[1]),i.PPS=n(r[2])),i}function l(t){return"AACL"==t?"mp4a.40.2":"H264"==t||"AVC1"==t?"avc1.4d40":(e.log("Warning, unsupported FourCC encountered: "+t),"")}function u(e){var t={};return a({Bitrate:parseInt},e,t),a({CodecPrivateData:o},e,t),a({MaxWidth:parseInt},e,t),a({MaxHeight:parseInt},e,t),a({FourCC:l},e,t),t
}function c(e){var t={};return a({Bitrate:parseInt},e,t),a({CodecPrivateData:o},e,t),a({SamplingRate:parseInt},e,t),a({Channels:parseInt},e,t),a({BitsPerSample:parseInt},e,t),a({PacketSize:parseInt},e,t),a({FourCC:l},e,t),t}function d(e){var t=[];if(null==e)return t;for(var i=-1,n=e.firstElementChild;null!=n;n=n.nextElementSibling)if("c"==n.nodeName){var r={};if(-1==i&&(i=null!=n.attributes.getNamedItem("t")?parseInt(n.attributes.t.value):0),r.time=i/1e7,r.timeURL=i,null==n.attributes.getNamedItem("d"))throw"Expected attribute 'd' not found";
var s=parseInt(n.attributes.d.value);r.duration=s/1e7,r.durationURL=s,i+=s,t.push(r)}return t}function h(e){var i={};return a({Type:t},e,i),a({Url:t},e,i),"video"===i.Type?i.QualityLevels=s("QualityLevel",u,e):"audio"==i.Type&&(i.QualityLevels=s("QualityLevel",c,e)),i.Fragments=d(e),i}function p(e,t){for(var i=[],n=[],r=!1,s=!1,a=e.length-1;a>=0&&(s||"video"!==e[a].Type||(n.push(a),s=!0),r||"audio"!==e[a].Type||(n.push(a),r=!0),!s||!r);a--);for(var a=0;a<e.length;a++)if(-1!==n.indexOf(a)){var o={};
switch(o.contentProtection=null,e[a].Type){case"audio":o.mime="audio/mp4";break;case"video":o.mime="video/mp4"}if(e[a].QualityLevels){o.representations=[];for(var l=0;l<e[a].QualityLevels.length;l++){var u={};switch(u.bandwidth=e[a].QualityLevels[l].Bitrate,u.baseURLs=[],u.baseURLs[0]=e[a].Url,u.segmentBase=null,u.segs=e[a].Fragments,e[a].Type){case"audio":u.codecs=e[a].QualityLevels[l].FourCC,u.audio_codec_private_data=e[a].QualityLevels[l].CodecPrivateData,u.audio_sample_rate=e[a].QualityLevels[l].SamplingRate;
break;case"video":u.codecs=e[a].QualityLevels[l].FourCC+e[a].QualityLevels[l].CodecPrivateData.SPS[3].toString(16).toLowerCase(),u.sps=e[a].QualityLevels[l].CodecPrivateData.SPS,u.pps=e[a].QualityLevels[l].CodecPrivateData.PPS,u.width=e[a].QualityLevels[l].MaxWidth,u.height=e[a].QualityLevels[l].MaxHeight}o.representations.push(u)}o.codecs=o.representations[0].codecs}t&&(o.contentProtection=t),i.push(o)}return i}function f(e){for(var t=atob(e.trim()),i=new ArrayBuffer(t.length),n=new Uint8Array(i),r=0;r<t.length;r++)n[r]=t.charCodeAt(r);
return{ab:i,u8:n}}function m(e){for(var t=0,i=[],n=[],r=new Uint16Array(e),s=e.byteLength/2;s>t&&(0===i.length||0===n.length);){for(;s>t&&60!==r[t];)t++;if(75===r[t+1]&&73===r[t+2]&&68===r[t+3]&&62===r[t+4])for(t+=5;s>t&&60!==r[t];)i.push(r[t]),t++;else if(76===r[t+1]&&65===r[t+2]&&95===r[t+3]&&85===r[t+4]&&82===r[t+5]&&76===r[t+6]&&62===r[t+7])for(t+=8;s>t&&60!==r[t];)n.push(r[t]),t++;else t++}return{kid:String.fromCharCode.apply(null,i),url:String.fromCharCode.apply(null,n)}}function g(e){var t={};
a({SystemID:r},e,t);var i=f(e.textContent),n=m(i.ab);return t.KID=f(n.kid).u8,t.url=n.url,t.PrHeader=i.u8,t}function v(e){var t={};return t.ProtectionHeader=s("ProtectionHeader",g,e)[0],t}function y(e){var t={};a({TimeScale:parseInt},e,t),t.TimeScale||(t.TimeScale=1e7),a({Duration:parseInt},e,t),t.StreamIndexes=s("StreamIndex",h,e);var i=s("Protection",v,e);i&&i[0]&&(t.Protection=i[0]),t.duration=t.Duration/t.TimeScale;var n;return t.Protection&&(n={},n.playready=t.Protection.ProtectionHeader.url?t.Protection.ProtectionHeader.url:"http://playready.directtaps.net/pr/svc/rightsmanager.asmx"),t.adaptationSets=p(t.StreamIndexes,n),t.Protection&&(t.pr={},t.pr.systemId=t.Protection.ProtectionHeader.SystemID,t.pr.prHeader=t.Protection.ProtectionHeader.PrHeader,t.pr.ivsize=8,t.pr.kid=t.Protection.ProtectionHeader.KID),t
}function b(t,i){return t.manifestURL=i,t.type=e.StreamingType.SMOOTH_STREAMING,t}function x(e,t){for(var i,n=new DOMParser,r=n.parseFromString(e,"text/xml"),s=0;s<r.childNodes.length;s++)if("SmoothStreamingMedia"===r.childNodes[s].nodeName){i=r.childNodes[s];break}return b(y(i),t)}e.parseSSManifest=x}(),function(){function t(e,t,i){e.setUint32(t,i)}function i(e,t,i){for(var n=0;4>n;n++)e.setUint8(t+4+n,i.charCodeAt(n));return 8}function n(e,t,i,n,r){return i.set(r,n),n+r.length}function r(e,n,r,s,a,o){var l=s;
return s+=i(n,s,a),o&&(s=o(e,n,r,s)),t(n,l,s-l),s}function s(e,t,i,s,a,o){return r(e,t,i,s,a,function(e,t,i,r){return n(e,t,i,r,o)})}function a(e,t,i,n){return s(e,t,i,n,"smhd",[0,0,0,0,0,0,0,0])}function o(e,t,i,n){return s(e,t,i,n,"vmhd",[0,0,0,1,0,0,0,0,0,0,0,0])}function l(e,t,i,s){return r(e,t,i,s,"esds",function(e,t,i,r){var s=e.audio_codec_private_data[0],a=e.audio_codec_private_data[1];return r=n(e,t,i,r,[0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,s,a,6,1,2])})}function u(e,t,i,s){return r(e,t,i,s,"avcC",function(e,t,i,r){return r=n(e,t,i,r,[1,77,64,30,255,225]),t.setUint16(r,e.sps.length),r+=2,r=n(e,t,i,r,e.sps),t.setUint8(r,1),r+=1,t.setUint16(r,e.pps.length),r+=2,r=n(e,t,i,r,e.pps)
})}function c(e,t,i){for(var n=i-t+1,r=0,s=t;t+n/2>s;s++)r=e[s],e[s]=e[i-s+t],e[i-s+t]=r}function d(e){var t=new ArrayBuffer(e.length),i=new Uint8Array(t);return i.set(e),c(i,0,3),c(i,4,5),c(i,6,7),i}function h(e,t,i,s){return r(e,t,i,s,"tenc",function(e,t,i,r){r=n(e,t,i,r,[0,0,0,0,0,0,1]),t.setUint8(r,e.pr.ivsize),r++;var s=d(e.pr.kid);return r=n(e,t,i,r,s)})}function p(e,t,i,n){return r(e,t,i,n,"schi",function(e,t,i,n){return n=h(e,t,i,n)})}function f(e,t,i,n){return s(e,t,i,n,"schm",[0,0,0,0,99,101,110,99,0,1,0,0])
}function m(e,t,i,n){return"audio/mp4"!==e.mime?s(e,t,i,n,"frma",[97,118,99,49]):s(e,t,i,n,"frma",[109,112,52,97])}function g(e,t,i,n){return r(e,t,i,n,"sinf",function(e,t,i,n){return n=m(e,t,i,n),n=f(e,t,i,n),n=p(e,t,i,n)})}function v(e,t,i,s,a){return r(e,t,i,s,a,function(e,t,i,r){var s=e.audio_sample_rate>>8&255,o=255&e.audio_sample_rate;return r=n(e,t,i,r,[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,s,o,0,0]),r=l(e,t,i,r),"enca"===a&&(r=g(e,t,i,r)),r})}function y(e,t,i,s,a){return r(e,t,i,s,a,function(e,t,i,r){return r=n(e,t,i,r,[0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t.setUint16(r,e.width),r+=2,t.setUint16(r,e.height),r+=2,r=n(e,t,i,r,[0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]),r=u(e,t,i,r),"encv"===a&&(r=g(e,t,i,r)),r
})}function b(e,t,i,s){return r(e,t,i,s,"stsd",function(e,t,i,r){return r=n(e,t,i,r,[0,0,0,0,0,0,0,1]),"audio/mp4"!==e.mime?(e.pr&&(r=y(e,t,i,r,"encv")),r=y(e,t,i,r,"avc1")):(e.pr&&(r=v(e,t,i,r,"enca")),r=v(e,t,i,r,"mp4a")),r})}function x(e,t,i,s){return r(e,t,i,s,"stbl",function(e,t,i,r){return r=b(e,t,i,r),r="audio/mp4"!==e.mime?n(e,t,i,r,[0,0,0,16,115,116,116,115,0,0,0,0,0,0,0,0,0,0,0,16,115,116,115,99,0,0,0,0,0,0,0,0,0,0,0,16,115,116,99,111,0,0,0,0,0,0,0,0,0,0,0,20,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,115,116,115,115,0,0,0,0,0,0,0,0]):n(e,t,i,r,[0,0,0,16,115,116,116,115,0,0,0,0,0,0,0,0,0,0,0,16,115,116,115,99,0,0,0,0,0,0,0,0,0,0,0,16,115,116,99,111,0,0,0,0,0,0,0,0,0,0,0,20,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,0])
})}function w(e,t,i,n){return s(e,t,i,n,"url ",[0,0,0,1])}function S(e,t,i,s){return r(e,t,i,s,"dref",function(e,t,i,r){return r=n(e,t,i,r,[0,0,0,0,0,0,0,1]),r=w(e,t,i,r)})}function _(e,t,i,n){return r(e,t,i,n,"dinf",function(e,t,i,n){return n=S(e,t,i,n)})}function k(e,t,i,n){return r(e,t,i,n,"minf",function(e,t,i,n){return n=_(e,t,i,n),n=x(e,t,i,n),n="audio/mp4"!==e.mime?o(e,t,i,n):a(e,t,i,n)})}function P(e,t,i,n){return"audio/mp4"!==e.mime?s(e,t,i,n,"hdlr",[0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]):s(e,t,i,n,"hdlr",[0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])
}function M(e,t,i,n){return s(e,t,i,n,"mdhd",[0,0,0,0,204,96,118,241,204,96,118,241,0,152,150,128,0,0,0,0,85,196,0,0])}function C(e,t,i,n){return r(e,t,i,n,"mdia",function(e,t,i,n){return n=M(e,t,i,n),n=P(e,t,i,n),n=k(e,t,i,n)})}function T(e,t,i,s){return r(e,t,i,s,"tkhd",function(e,t,i,r){return r=n(e,t,i,r,[0,0,0,3,204,96,118,241,204,96,118,241,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0]),t.setUint32(r,e.width),r+=4,t.setUint32(r,e.height),r+=4,t.setUint16(r,0),r+=2
})}function A(e,t,i,n){return r(e,t,i,n,"trak",function(e,t,i,n){return n=T(e,t,i,n),n=C(e,t,i,n)})}function I(e,t,i,n){return s(e,t,i,n,"trex",[0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])}function E(e,t,i,n){return r(e,t,i,n,"mvex",function(e,t,i,n){return n=I(e,t,i,n)})}function D(e,t,i,s){return r(e,t,i,s,"pssh",function(e,t,i,r){return r=n(e,t,i,r,[0,0,0,0]),r=n(e,t,i,r,e.pr.systemId),t.setUint32(r,e.pr.prHeader.length),r+=4,r=n(e,t,i,r,e.pr.prHeader)})}function L(e,t,i,n){return s(e,t,i,n,"mvhd",[0,0,0,0,204,96,118,241,204,96,118,241,0,152,150,128,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2])
}function R(e,t,i,n){return r(e,t,i,n,"moov",function(e,t,i,n){return n=L(e,t,i,n),e.pr&&(n=D(e,t,i,n)),n=E(e,t,i,n),n=A(e,t,i,n)})}function O(e){var t=new ArrayBuffer(2e4),i=new DataView(t),n=new Uint8Array(t),r=0,s=0;r=R(e,i,n,r),s=r-1;var a={};return a.data=t.slice(0,r),a.init={},a.init.start=0,a.init.end=s,a}function j(e,t,i){for(var n=0,r=t,s=0;4>s;s++)n<<=8,n+=i.charCodeAt(s);for(;e.getUint32(r+4,!1)!=n;)if(r+=e.getUint32(r),r>=e.byteLength)throw"Could not find box: "+i;return r}function B(e,t){var i=j(e,t,"traf");
i=j(e,i+8,"tfhd"),e.setUint32(i+12,1)}function U(e,t,i,n){var r=j(e,t,i),s=e.getUint32(r);return e.setUint32(r,s+n),r}function N(e,t,i){var n=0;if(n=U(e,n,"moof",t),n=U(e,n+8,"traf",t),n=j(e,n+8,"trun"),1&e.getUint32(n+8)){var r=n+16;e.setUint32(r,i)}return n}function H(e,t,i){var n=0;if(n=U(e,n,"moof",t),n=U(e,n+8,"traf",t),n=j(e,n+8,"trun"),1&e.getUint32(n+8)){var r=n+16,s=e.getUint32(r);e.setUint32(r,s+i)}return n}function F(e,t){var i=[0,0,0,20,116,102,100,116,1,0,0,0],n=i.length+8,r=new ArrayBuffer(e.byteLength+n),s=(new Uint8Array(e),new DataView(e)),a=new Uint8Array(r),o=new DataView(r),l=0;
return B(s,8),l=H(s,n,n),a.set(new Uint8Array(e,0,l)),a.set(i,l),o.setUint32(l+12,t/4294967295&4294967295),o.setUint32(l+16,4294967295&t),a.set(new Uint8Array(e,l,e.byteLength-l),l+n),r}function V(e,t,i,n,r){if(!r)return new Uint8Array(0);for(var s=new Uint8Array(i),a=0,o=0,l=t,u=0;i>u;u++)a=e.getUint16(l+n),o=n+2+6*a,s[u]=o,l+=o;return s}function z(e,t,i,s,a,o){return r(e,t,i,s,"mdat",function(e,t,i,r){return r=n(e,t,i,r,a),r=n(e,t,i,r,o)})}function q(e,t,i,s){return r(e,t,i,s,"saio",function(e,t,i,r){r=n(e,t,i,r,[0,0,0,0,0,0,0,1]);
var s=r+4+8;return t.setUint32(r,s),r+=4})}function Q(e,t,i,s,a,o,l,u){return r(e,t,i,s,"saiz",function(e,t,i,r){return r=l?n(e,t,i,r,[0,0,0,0,0]):n(e,t,i,r,[0,0,0,0,u]),t.setUint32(r,a),r+=4,i.set(o,r),r+=o.length})}function $(e){var t=new DataView(e),i=0,n=0,r=0,s=t.getUint32(i);i=j(t,i+8,"traf"),i=j(t,i+8,"trun"),n=t.getUint32(i+12),i=j(t,i,"uuid");var a=t.getUint8(i+27),o=!1;if(2!==a&&0!==a)throw"uuid flags expected is 0x02 or 0x00 but found: "+a;2===a&&(o=!0);var l=t.getUint32(i+28);if(n!==l)throw"Samples count does not match "+n+" "+l;
var u=t.getUint32(i);r=u-32;var c=200,d=new ArrayBuffer(e.byteLength+c),h=new Uint8Array(d),p=new DataView(d);h.set(new Uint8Array(e,0,i));var f=i,m=8,g=i+32,v=i+u,y=t.getUint32(v),b=V(t,g,n,m,o);if(f=Q(null,p,h,f,n,b,o,m),f=q(null,p,h,f),o){for(var x=0,w=0;w<b.length;w++)x+=b[w];if(x!==r)throw"Samples size does not match "+x+" "+r}else if(m*n!==r)throw"Samples size does not match "+m*n+" "+r;var S=new Uint8Array(e,g,r),_=new Uint8Array(e,v+8,y-8),k=f-s,P=f;return f=z(null,p,h,f,S,_),N(p,k,P+8+r),new Uint8Array(d,0,f)
}function X(e,t,i){var n=F(e,t);return i?$(n):new Uint8Array(n)}e.abtohex=function(e){for(var t=[],i=0;i<e.byteLength;i++)t.push(e[i].toString(16));return t},e.abtob64=function(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))},e.createSSInit=O,e.process_traf=X}(),function(){function t(e){for(var t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}function i(e){return String.fromCharCode.apply(String,e)}var n=function(e){this.video=e,!e.generateKeyRequest&&e.webkitGenerateKeyRequest&&(e.generateKeyRequest=e.webkitGenerateKeyRequest),!e.addKey&&e.webkitAddKey&&(e.addKey=e.webkitAddKey),this.initDataQueue=[],this.flavor=null,this.keySystem=null,this.licenseServerURL=null,e.generateKeyRequest&&e.addKey&&(e.addEventListener("needkey",this.onNeedKey.bind(this)),e.addEventListener("keymessage",this.onKeyMessage.bind(this)),e.addEventListener("keyerror",this.onKeyError.bind(this)),e.addEventListener("webkitneedkey",this.onNeedKey.bind(this)),e.addEventListener("webkitkeymessage",this.onKeyMessage.bind(this)),e.addEventListener("webkitkeyerror",this.onKeyError.bind(this)))
};n.kMime='video/mp4; codecs="avc1.640028"',n.kFlavorToSystem={clearkey:["webkit-org.w3.clearkey","org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.youtube.playready","com.microsoft.playready"]},n.prototype.init=function(e,t){this.chooseFlavor(n.kMime,e,t),this.isClearKey="clearkey"==this.flavor},n.prototype.chooseFlavor=function(e,t,i){for(var r in t)if(!i||r==i){var s=n.kFlavorToSystem[r];if(s)for(var a in s)if(this.video.canPlayType(e,s[a]))return this.flavor=r,this.keySystem=s[a],void(this.licenseServerURL=t[r])
}throw"Could not find a compatible key system"},n.prototype.extractBMFFClearKeyID=function(e){var t=new ArrayBuffer(e.length),i=new Uint8Array(t);i.set(e);for(var n=new DataView(t),r=0;r<t.byteLength;){var s=n.getUint32(r,!1),a=n.getUint32(r+4,!1);if(1886614376!=a)throw"Box type "+a.toString(16)+' not equal to "pssh"';if(1477738184==n.getUint32(r+12,!1)&&69420633==n.getUint32(r+16,!1)&&2464609580==n.getUint32(r+20,!1)&&1558758348==n.getUint32(r+24,!1)){var o=n.getUint32(r+28,!1);if(16!=o)throw"Unexpected KID size "+o;
return new Uint8Array(t.slice(r+32,r+32+o))}if(3991899049==n.getUint32(r+12,!1)&&2044086990==n.getUint32(r+16,!1)&&2747803612==n.getUint32(r+20,!1)&&3575456237==n.getUint32(r+24,!1))return new Uint8Array(t.slice(r+36,r+52));r+=s}return e},n.prototype.onNeedKey=function(t){if(e.dlog(2,"onNeedKey()"),!this.keySystem)throw"Not initialized! Bad manifest parse?";if(16==t.initData.length)return void e.log("Dropping non-BMFF needKey event");var i=t.initData;this.isClearKey&&(i=this.extractBMFFClearKeyID(t.initData)),this.video.generateKeyRequest(this.keySystem,i),this.initDataQueue.push(i)
},n.prototype.onKeyMessage=function(t){e.dlog(2,"onKeyMessage() Sending request: "+this.licenseServerURL+" "+t.sessionId);var i=this.initDataQueue.shift(),n=new XMLHttpRequest;n.open("POST",this.licenseServerURL),n.setRequestHeader("content-type","text/xml;charset=utf-8"),n.addEventListener("load",this.onLoad.bind(this,i,t.sessionId)),n.responseType="arraybuffer",n.send(t.message)},n.prototype.onKeyError=function(t){e.dlog(2,"onKeyError("+t.keySystem+", "+t.errorCode.code+", "+t.systemCode+")")},n.prototype.onLoad=function(n,r,s){if(e.dlog(2,"onLoad("+this.licenseServerURL+"): "+r),s.target.status<200||s.target.status>299)throw"Bad XHR status: "+s.target.statusText;
{var a=i(new Uint8Array(s.target.response)).split("\r\n").pop();this.video.addKey(this.keySystem,t(a),n,r)}},e.EMEManager=n}(),function(){var t=function(e,t,i,n,r,s,a){this.url=e,this.bandwidth=t,this.width=i,this.height=n,this.sps=r,this.pps=s,this.codecs=a,this.initFragment=null,this.initRequestData=null,this.indexRequestData=null,this.isInitialized=!1,this.segs=null};e.Representation=t}(),function(){var t={ENOUGH:20},i=function(e,t,i,n,r,s){if(this.sourceBuffer_=t,this.sourceBuffer_.appendBuffer)this.appendBuffer_=this.sourceBuffer_.appendBuffer,this.sourceBuffer_.addEventListener("updateend",this.onUpdateEnd.bind(this));
else{if(!this.sourceBuffer_.append)throw new Error("Unknown SourceBuffer interface");this.appendBuffer_=this.sourceBuffer_.append}this.representations_=i,this.currentRep=0,this.segIndex=null,this.mime=n,this.resetReason=null,this.active=!0,this.type=r,this.pr_=s,this.seekingStartTime=null,this.mediaSrc_=e,this.bitrates=[];for(var a=0;a<this.representations_.length;a++)this.bitrates.push(this.representations_[a].bandwidth);this.deferredAppends_=[],this.segmentQueue=[],this.segmentSize=0,this.segmentLastEndTime=0,this.waitingForBuffer=!1,this.segmentTimeout=null
};i.prototype.getCurrentTime=function(){return window.googledash.player.getMediaElement().currentTime},i.prototype.updateBuffer=function(){var t=this.sourceBuffer_.buffered;if(t.length>0){var i=t.end(t.length-1)-this.segmentLastEndTime;e.dlog(3,"["+this.mime+"] Play head: "+this.getCurrentTime()+" Segment size: "+(this.segmentSize/1024/1024).toFixed(2)+" MB Segment duration: "+i),this.segmentQueue.push({size:this.segmentSize,duration:i,offset:this.segmentLastEndTime})}},i.prototype.reset=function(t){e.dlog(1,"SourceBuffer["+this.mime+"] reset: "+t),this.segIndex=null,this.representations_[this.currentRep].isInitialized=!1,this.resetReason=t||null,this.active=!0,this.segmentQueue=[],this.segmentSize=0,this.segmentLastEndTime=0,this.waitingForBuffer=!1,null!=this.segmentTimeout&&clearTimeout(this.segmentTimeout),"open"==this.mediaSrc_.readyState&&this.sourceBuffer_.abort()
},i.prototype.isInitialized=function(){return this.representations_[this.currentRep].isInitialized},i.prototype.initialize=function(){this.representations_[this.currentRep].isInitialized=!0},i.prototype.updating=function(){return this.sourceBuffer_.updating},i.prototype.onUpdateEnd=function(){this.updateBuffer(),this.deferredAppends_.length>0&&(e.dlog(2,"SourceBuffer["+this.mime+"] appended deferred data"),this.append(this.deferredAppends_.pop()))},i.prototype.append=function(t){var i=this.sourceBuffer_.buffered;
if(this.segmentSize=t.length,this.segmentLastEndTime=0,i.length>0&&(this.segmentLastEndTime=i.end(i.length-1)),this.sourceBuffer_.updating){if(this.deferredAppends_.length<5)return e.dlog(2,"SourceBuffer["+this.mime+"] deferring append"),void this.deferredAppends_.push(t);e.log("SourceBuffer["+this.mime+"] too many deferrals, aborting"),this.deferredAppends_=[],this.appendBuffer_.abort()}this.appendBuffer_.call(this.sourceBuffer_,t),"appendBuffer"in this.sourceBuffer_||this.updateBuffer()},i.prototype.getCurrentRep=function(){return this.representations_[this.currentRep]
},i.prototype.changeQuality=function(t){if(t===this.currentRep)return!1;e.dlog(2,"Bandwitdth change sourceBuffer["+this.mime+"]: "+this.active),e.dlog(2,"bandwidthChange["+this.mime+"]: "+this.currentRep+" "+t);var i,n=this.representations_[this.currentRep].bandwidth,r=this.representations_[t].bandwidth;e.dlog(2,"bandwidthChange["+this.mime+"]: "+n+" "+r),i=n>r?"rep_down":"rep_up",this.reset(i),this.currentRep=t},i.prototype.getRangesString=function(){for(var e=this.sourceBuffer_.buffered,t="Ranges["+this.mime+"]:",i=0;i<e.length;i++)t+=" ["+e.start(i)+","+e.end(i)+"]";
return t},i.prototype.findRangeForPlaybackTime=function(e){for(var t=this.sourceBuffer_.buffered,i=0;i<t.length;i++)if(t.start(i)<=e&&t.end(i)>=e)return{start:t.start(i),end:t.end(i)};return null},i.prototype.getBufferSize=function(t){e.dlog(4,"Time: "+t+" Ranges in onProgress: "+this.getRangesString());var i=this.findRangeForPlaybackTime(t),n=i&&i.end||0;if(null!==this.segIndex){var r=this.representations_[this.currentRep].segs[this.segIndex].time;n=r>n?r:n}if(i){var s=Math.abs(i.end-n);s>.001&&e.dlog(2,"Difference in available data: "+i.end+" "+n)
}return n-t},i.prototype.findSegmentIndexForTime=function(t){for(var i=this.representations_[this.currentRep].segs,n=0;n<i.length;n++){var r=i[n];if(r.time<=t&&r.time+r.duration>=t)return n==i.length-1&&r.time+r.duration+.5<t?null:n}return e.dlog(5,"Could not find segment for time "+t),null},i.prototype.identifyNextFragment=function(i){var n=this.findRangeForPlaybackTime(i),r=n&&n.end||i;if(r>i+t.ENOUGH)return e.dlog(3,"Enough buffering currentTime in rage: "+this.mime+" "+i+"  "+r),null;if(1==this.waitingForBuffer)return null;
if(null==this.segIndex){if(e.dlog(4,"Non existing index, finding the index for the next request["+this.mime+"]"),this.segIndex=this.findSegmentIndexForTime(r),null===this.segIndex)return this.active=!1,null;e.dlog(4,"New Index["+this.mime+"]: "+r+" "+this.segIndex)}else{null==n&&e.log("Playback head outside of buffer in append-continue state.");var s=this.representations_[this.currentRep].segs[this.segIndex].time;if(s>i+t.ENOUGH)return e.dlog(3,"Enough buffering: "+this.mime+" "+this.segIndex+" "+i+"  "+s),null
}return r},i.prototype.appendData=function(t){for(e.dlog(2,"["+this.mime+"] Time is "+this.getCurrentTime()+", asked to add a "+(t.byteLength/1024/1024).toFixed(2)+" MB segment, see if we can."),this.segmentQueue.length>0&&e.dlog(2,"["+this.mime+"] End of first segment is "+(this.segmentQueue[0].offset+this.segmentQueue[0].duration).toFixed(2));this.segmentQueue.length>0&&this.segmentQueue[0].offset+this.segmentQueue[0].duration<this.getCurrentTime()+2;)e.dlog(2,"["+this.mime+"] Removing collectable segment."),this.segmentQueue.shift();
for(var i=0,n=0;n<this.segmentQueue.length;n++)i+=this.segmentQueue[n].size;e.dlog(2,"["+this.mime+"] Time is "+this.getCurrentTime()+" and there are "+(i/1024/1024).toFixed(2)+" MB uncollectable, bringing the proposed total to "+((i+t.byteLength)/1024/1024).toFixed(2)+" MB."),(i+t.byteLength)/1024/1024>24&&this.segmentQueue.length>0?(e.dlog(2,"["+this.mime+"] Waiting for buffer to have enough room."),this.waitingForBuffer=!0,this.segmentTimeout=setTimeout(function(){this.appendData(t)}.bind(this),1e3)):(this.reallyAppendData(t),this.waitingForBuffer=!1)
},i.prototype.reallyAppendData=function(t){e.dlog(3,"["+this.mime+"] Current Time: "+this.getCurrentTime()+" Ranges in appendData1: "+this.getRangesString());var i,n=this.representations_[this.currentRep].segs[this.segIndex].time,r=n+this.representations_[this.currentRep].segs[this.segIndex].duration;e.dlog(4,"Appending Response ["+this.mime+"] : ["+n+","+r+"]"),i=this.type===e.StreamingType.SMOOTH_STREAMING?process_traf(t,this.representations_[this.currentRep].segs[this.segIndex].timeURL,this.pr_):new Uint8Array(t),this.append(i),this.segIndex++,this.segIndex>=this.representations_[this.currentRep].segs.length&&(this.active=!1,e.dlog(2,"Source["+this.mime+"] is not active: "+this.segIndex+" "+this.representations_[this.currentRep].segs.length)),e.dlog(3,"Ranges in appendData2: "+this.getRangesString())
},e.SourceBufferManager=i}(),function(){var t=function(){this.mediaSrc_=null,this.sourceBufferManagers_=[],this.videoSrcBufIndex_=0,this.emeMgr_=null,this.type=null,this.pr,this.manifest_=null,this.attachedHandlers_={}};t.prototype.getMediaSource=function(){return this.mediaSrc_},t.prototype.dispose=function(){null!=this.mediaSrc_&&(this.detachAllHandlers_(),this.resetAll(),this.mediaSrc_=null,this.sourceBufferManagers_=[])},t.prototype.getSourceBufferCount=function(){return this.sourceBufferManagers_.length
},t.prototype.getVideoSrcBufferIndex=function(){return this.videoSrcBufIndex_},t.prototype.getLevel=function(e){return this.sourceBufferManagers_[e].currentRep},t.prototype.getSegIndex=function(e){return this.sourceBufferManagers_[e].segIndex},t.prototype.getCurrentRep=function(e){return this.sourceBufferManagers_[e].getCurrentRep()},t.prototype.getBufferSize=function(e,t){return this.sourceBufferManagers_[e].getBufferSize(t)},t.prototype.getLevel=function(e){return this.sourceBufferManagers_[e].currentRep
},t.prototype.appendData=function(e,t){this.mediaSrc_&&"closed"!==this.mediaSrc_.readyState&&this.sourceBufferManagers_[e].appendData(t)},t.prototype.append=function(e,t){this.mediaSrc_&&"closed"!==this.mediaSrc_.readyState&&this.sourceBufferManagers_[e].append(t)},t.prototype.isActive=function(e){return this.sourceBufferManagers_[e].active},t.prototype.isInitialized=function(e){return this.sourceBufferManagers_[e].isInitialized()},t.prototype.initialize=function(e){this.sourceBufferManagers_[e].initialize()
},t.prototype.mime=function(e){return this.sourceBufferManagers_[e].mime},t.prototype.getBitrates=function(e){return this.sourceBufferManagers_[e].bitrates},t.prototype.identifyNextFragment=function(e,t){return this.sourceBufferManagers_[e].identifyNextFragment(t)},t.prototype.resetAll=function(e){for(var t=0;t<this.sourceBufferManagers_.length;t++)this.sourceBufferManagers_[t].reset(e)},t.prototype.reset=function(e,t){this.sourceBufferManagers_[e].reset(t)},t.prototype.changeQuality=function(e,t){return this.sourceBufferManagers_[e].changeQuality(t)
},t.prototype.endOfStream=function(){if(this.mediaSrc_&&"open"===this.mediaSrc_.readyState){for(var t=!1,i=0;i<this.sourceBufferManagers_.length;i++)if(this.sourceBufferManagers_[i].updating()){t=!0;break}t||(e.log("Ending stream"),this.mediaSrc_.endOfStream())}},t.prototype.absolutizeURL=function(e,t){if(void 0===t&&(t=""),t.match(/^[a-z]*:\/\//))return t;var i;return i="/"==t[0]?e.match(/^[a-z]*:\/\/[^\/]*/)[0]:e.replace(/\/[^\/]*$/,"/"),i+t},t.prototype.displaySourceBuffers=function(t){for(var i=0;i<this.mediaSrc_.sourceBuffers.length;i++){var n=this.mediaSrc_.sourceBuffers[i];
e.dlog(5,t+" SourceBuffer["+n.mime+"]: "+n.active)}},t.prototype.normalizeRepresentation=function(t){var i={url:this.absolutizeURL(this.manifest_.manifestURL,t.baseURLs[0]),bandwidth:t.bandwidth,width:t.width,height:t.height,sps:t.sps,pps:t.pps,audio_codec_private_data:t.audio_codec_private_data,audio_sample_rate:t.audio_sample_rate};if(this.type===e.StreamingType.SMOOTH_STREAMING)return i.segs=t.segs,i;var n=null;if(null!=t.segmentList){n=t.segmentList.initialization,i.segs=[];for(var r=0;r<t.segmentList.segmentURLs.length;r++){var s=t.segmentList.segmentURLs[r],a={start:s.mediaRange.start,end:s.mediaRange.end,index:s.indexRange&&s.indexRange.end||null,time:t.segmentList.durationSeconds*r,duration:t.segmentList.durationSeconds,subsegments:null};
i.segs.push(a)}}else if(null!=t.segmentTemplate){i.segs=[];var o=t.segmentTemplate.duration/t.segmentTemplate.timescale,a={url:i.url+t.segmentTemplate.initialization.replace("$RepresentationID$",t.id)};i.segs.push(a);for(var l=0;l*o<this.manifest_.duration;l++){var a={start:-1,end:-1,index:null,time:l*o,duration:o,subsegments:null,url:i.url+t.segmentTemplate.media.replace("$RepresentationID$",t.id).replace("$Number$",l)};i.segs.push(a)}}else{var a={start:null,end:null,index:null,time:0,duration:this.manifest_.duration,subsegments:null};
if(null!=t.segmentBase){var s=t.segmentBase;n=s.initialization,null!=s.indexRange&&(i.indexRequestData=s.indexRange)}i.segs=[a]}return this.type!==e.StreamingType.SMOOTH_STREAMING&&(i.initRequestData={start:n&&n.start||0,end:n&&n.end||i.segs[0].index||null}),i},t.prototype.onSourceOpen=function(t,i,n){e.dlog(2,"onSourceOpen()");var r,s,a,o;if(this.mediaSrc_.sourceBuffers.length)for(e.dlog(2,"onSourceOpen(): Target already has buffers, bailing."),a=0;a<this.mediaSrc_.sourceBuffers.length;a++)this.mediaSrc_.sourceBuffers[a].active=!0;
else{for(this.mediaSrc_.duration=this.manifest_.duration,this.sourceBufferManagers_=[],this.emeMgr_=new e.EMEManager(t),this.type=this.manifest_.type,this.pr=this.manifest_.pr,a=0;a<this.manifest_.adaptationSets.length;a++)if(o=this.manifest_.adaptationSets[a],!(o.mime&&o.mime.indexOf("webm")>=0)){o.contentProtection&&this.emeMgr_.init(o.contentProtection,options.flavor),r=o.representations.map(this.normalizeRepresentation.bind(this)),s=this.mediaSrc_.addSourceBuffer(o.mime+'; codecs="'+o.codecs+'"'),e.dlog(2,"Buffer added properly: "+(this.mediaSrc_.sourceBuffers[a]===s));
var l=new e.SourceBufferManager(this.mediaSrc_,s,r,o.mime,this.type,this.pr);o.mime.indexOf("video")>=0&&(this.videoSrcBufIndex_=a),this.sourceBufferManagers_.push(l),e.dlog(2,"onSourceOpen. Initialized SourceBuffer["+o.mime+"]")}n()}},t.prototype.isSupported=function(){return null==window.MediaSource&&null==window.WebKitMediaSource?!1:(null==window.MediaSource&&(window.MediaSource=window.WebKitMediaSource),!0)},t.prototype.init=function(){this.mediaSrc_=new MediaSource},t.prototype.attach=function(e,t,i,n){if(!this.mediaSrc_)throw new Error("MediaSourceManager has not been initialized, please call init()");
this.manifest_=t,this.attachHandler_("sourceopen",this.onSourceOpen.bind(this,e,i,n)),this.attachHandler_("webkitsourceopen",this.onSourceOpen.bind(this,e,i,n)),e.src=window.URL.createObjectURL(this.mediaSrc_)},t.prototype.attachHandler_=function(e,t){this.attachedHandlers_[e]||(this.attachedHandlers_[e]=[]),this.attachedHandlers_[e].push(t),this.mediaSrc_.addEventListener(e,t)},t.prototype.detachAllHandlers_=function(){var e,t=this.attachedHandlers_,i=this.mediaSrc_;for(var n in t){e=t[n];for(var r=0;r<e.length;r++)i.removeEventListener(n,e[r]);
e.length=0}},e.MediaSourceManager=t}(),function(){var t=0,i=1,n=function(e){if(null==e)throw new Error("A url for the manifest is required");this.url_=e,this.callback_=null,this.manifest_=null};n.prototype.load=function(t){if(null==t)throw new Error("A callback is required");this.callback_=t,this.requestManifest_(),e.dlog(1,"Sent request to get the manifest")},n.prototype.getManifest=function(){return this.manifest_},n.prototype.manifestType_=function(){return-1!=this.url_.lastIndexOf(".mpd")?t:i
},n.prototype.requestManifest_=function(){var e=new XMLHttpRequest;e.addEventListener("load",this.onManifestLoad_.bind(this)),e.addEventListener("error",this.onManifestError_.bind(this)),e.open("GET",this.url_),e.send()},n.prototype.onManifestError_=function(){var t="Error retrieving manifest from "+this.url_;return e.log(t),this.callback_(t)},n.prototype.onManifestLoad_=function(n){e.dlog(2,"Manifest received");var r=null;if(n.target.status<200||n.target.status>299)return r="HTTP error "+n.target.status+" retrieving manifest from "+this.url_,e.log(r),this.callback_(r);
switch(this.manifestType_()){case t:this.manifest_=e.parseDASHManifest(n.target.responseText,this.url_);break;case i:this.manifest_=e.parseSSManifest(n.target.responseText,this.url_)}return null===this.manifest_?(r="Error parsing the manifest",e.log(r),this.callback_(r)):this.callback_(r,this.manifest_)},e.ManifestLoader=n}(),function(){var t=.99,i=.98,n=5e5,r=5e5,s=function(e,t,i){this.bitrates_=e,this.levelCount_=this.bitrates_.length,this.algorithm_=t||"adaptive",this.cooldownPeriod_=2,i&&(this.level_=parseInt(i))
};s.prototype.onBandwithTracking=function(s){var a=s.target;if(null!=a.lastTime&&s.timeStamp!=a.lastTime){var o=8e3*(s.loaded-a.lastSize)/(s.timeStamp-a.lastTime);n=t*n+(1-t)*o,r=i*r+(1-i)*o}a.lastTime=s.timeStamp,a.lastSize=s.loaded,e.dlog(5,"Calculated bandwidth: "+n+" "+r)},s.prototype.adapt=function(t){if(!this.bitrates_||this.bitrates_.length<=1)return-1;var i=-1;if("fixed"===this.algorithm_)i=this.level_;else if("random"===this.algorithm_)Math.random()>.5&&(i=Math.floor(Math.random()*this.levelCount_));
else if("adaptive"===this.algorithm_)if(this.cooldownPeriod_)this.cooldownPeriod_--;else{var s=0,a=0,o=.85,l=Math.min(n,r);e.dlog(5,"Calculated Bandwidth: "+l+" globalSlowBandwidth: "+n+" globalFastBandwidth: "+r);for(var u=0;u<this.bitrates_.length;u++){var c=this.bitrates_[u];c>s&&o*l-128e3>c&&(s=c,a=u)}if(a!==t)return e.dlog(2,"Selected new rate "+s+" for bandwidth "+l+" (from "+n+", "+r+")"),this.cooldownPeriod_=8,a}return t!==i&&-1!==i?(e.dlog(2,"Selected new bitrate level: "+i),i):-1},e.AdaptiveManager=s
}(),function(){var t=function(e,t,i){this.mediaSrcMgr_=e,this.bufferIndex_=t,this.adaptiveManager_=i,this.fragmentRequest_=null};t.prototype.appendInit=function(){e.dlog(2,"Appending init ["+this.mediaSrcMgr_.mime(this.bufferIndex_)+"]: "+this.mediaSrcMgr_.getLevel(this.bufferIndex_)),this.mediaSrcMgr_.initialize(this.bufferIndex_),this.mediaSrcMgr_.append(this.bufferIndex_,this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).initFragment)},t.prototype.onXHRAbort=function(){e.log("Received abort of XHR.")
},t.prototype.onXHRError=function(t){return this.fragmentRequest_!==t.target?void e.log("Received error of untracked XHR."):(e.log("Received error of XHR."),void(this.fragmentRequest_=null))},t.prototype.onXHRLoad=function(t){this.fragmentRequest_!==t.target&&e.log("Error, HTTP response for unknown request");var i=this.fragmentRequest_;return this.fragmentRequest_=null,i.readyState==i.DONE?i.status>=300?void e.log("HTTP Request failure, status="+i.status):(i.is_index&&(e.dlog(2,"Index Response"),this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).segs=e.parseSIDX(i.response,i.startByte)),i.is_init?(e.dlog(2,"Init Response"),this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).initFragment=e.extractInit(i.response),void(this.mediaSrcMgr_.isInitialized(this.bufferIndex_)||this.appendInit())):void this.mediaSrcMgr_.appendData(this.bufferIndex_,i.response)):void 0
},t.prototype.cancelRequests=function(){null!=this.fragmentRequest_&&(this.fragmentRequest_.abort(),this.fragmentRequest_=null)},t.prototype.makeSSXHR=function(){var t=new XMLHttpRequest,i=this.mediaSrcMgr_.getSegIndex(this.bufferIndex_),n=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).url,r=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).bandwidth,s=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).segs[i].timeURL;if(n=n.replace("{bitrate}",r),n=n.replace("{start time}",s),t.open("GET",n),t.responseType="arraybuffer",t.addEventListener("load",this.onXHRLoad.bind(this)),t.addEventListener("error",this.onXHRError.bind(this)),t.addEventListener("abort",this.onXHRAbort.bind(this)),null==n)throw"Null URL";
return t.is_init=!1,t.is_index=!1,t.lastTime=null,t.lastSize=null,t.addEventListener("progress",this.adaptiveManager_.onBandwithTracking.bind(this.adaptiveManager_)),t.send(),e.dlog(2,"Sent XHR: url="+n),t},t.prototype.makeXHR=function(t){var i,n,r=new XMLHttpRequest,s=this.mediaSrcMgr_.getSegIndex(this.bufferIndex_),a=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_),o=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).url,l=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).segs[s],u=!1;null==s&&(s=0),null!=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).segs[s].url&&(o=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).segs[s].url),t?(i=0,n=a.initRequestData.end,null!=a.indexRequestData&&(n=a.indexRequestData.end,u=!0)):(i=l.offset,n=l.offset+l.size-1);
var c=null;null!=i&&null!=n&&(c="bytes="+i+"-"+n);var d=!!/youtube.com/.exec(o);if(c&&d&&(o=o.replace(/&range=[^&]*/,""),o+="&range="+c.substring(6)),r.open("GET",o),r.responseType="arraybuffer",r.startByte=i,null==c||d||r.setRequestHeader("Range",c),r.addEventListener("load",this.onXHRLoad.bind(this)),null==o)throw"Null URL";return r.is_init=t,r.is_index=u,r.lastTime=null,r.lastSize=null,r.addEventListener("progress",this.adaptiveManager_.onBandwithTracking.bind(this.adaptiveManager_)),r.send(),e.dlog(2,"Sent XHR: url="+o+", range="+c),r
},t.prototype.findRangeForPlaybackTime=function(e,t){for(var i=e.buffered,n=0;n<i.length;n++)if(i.start(n)<=t&&i.end(n)>=t)return{start:i.start(n),end:i.end(n)}},t.prototype.initFragmentRequestNeeded=function(){if(null==this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).initFragment){e.dlog(2,"Creating Init segment["+this.mediaSrcMgr_.mime(this.bufferIndex_)+"]");var t=this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_);if(this.mediaSrcMgr_.type===e.StreamingType.SMOOTH_STREAMING){var i={pps:t.pps,sps:t.sps,width:t.width,height:t.height,mime:this.mediaSrcMgr_.mime(this.bufferIndex_),pr:this.mediaSrcMgr_.pr,audio_codec_private_data:t.audio_codec_private_data,audio_sample_rate:t.audio_sample_rate},n=e.createSSInit(i);
return this.mediaSrcMgr_.getCurrentRep(this.bufferIndex_).initFragment=e.extractInit(n.data),this.appendInit(),!1}return this.fragmentRequest_=this.makeXHR(!0),!0}return this.mediaSrcMgr_.isInitialized(this.bufferIndex_)||this.appendInit(),!1},t.prototype.requestNextFragment=function(t,i){this.fragmentRequest_=this.mediaSrcMgr_.type===e.StreamingType.SMOOTH_STREAMING?this.makeSSXHR():this.makeXHR(!1),this.fragmentRequest_.expected_time=i},t.prototype.tick=function(t){if(!this.mediaSrcMgr_.isActive(this.bufferIndex_))return e.dlog(4,"Not active["+this.mediaSrcMgr_.mime(this.bufferIndex_)+"]"),!1;
if(this.fragmentRequest_)e.dlog(4,"Will not request next segment["+this.mediaSrcMgr_.mime(this.bufferIndex_)+"] request pending");else if(!this.initFragmentRequestNeeded()){var i=this.mediaSrcMgr_.identifyNextFragment(this.bufferIndex_,t);if(null!==i){var n=-1;this.mediaSrcMgr_.mime(this.bufferIndex_).indexOf("video")>=0&&(n=this.adaptiveManager_.adapt(this.mediaSrcMgr_.getLevel(this.bufferIndex_))),n>=0?(this.cancelRequests(),this.mediaSrcMgr_.changeQuality(this.bufferIndex_,n)):this.requestNextFragment(t,i)
}}return!0},e.FragmentManager=t}(),function(){function t(e){var t=new RegExp("[?&]"+e+"=([^&]*)"),i=t.exec(window.location.search);return null!=i?(i=i[1],/%/.exec(i)&&(i=decodeURIComponent(i)),i):null}function i(){for(var e={},i=["autoplay","algorithm","flavor","level","cc","url"],n=0;n<i.length;n++){var r=t(i[n]);e[i[n]]=r}if(e&&e.url)for(var s in e)e.hasOwnProperty(s)&&(this.options[s]=e[s])}var n={Audio_Type:"audio",Video_Type:"video",Image_Type:"img",MSE_Type:"mse"},r=function(t){t||(t={}),this.options=t,this.mediaElementType_=null,this.manifestLoader_=null,this.closeCaptionsLoader_=null,this.progressTimer_=null,this.mediaSrcMgr_=new e.MediaSourceManager,this.fragmentManagers_=null,this.showControls_=t.showControls,this.mediaElement_=null,this.imageElement_=null,this.mediaEvents_=new Object,t.mediaElement?this.mediaElement_=t.mediaElement:t.imageElement?this.imageElement_=t.imageElement:this.createMediaElement(),e.player=this
},s={AUTO_PAUSE_START:1,PAUSE_RESUME:5};r.prototype.getMediaElement=function(){return this.mediaElement_},r.prototype.onPause=function(){e.log("Paused, auto="+this.mediaElement_.autopause_pending),this.mediaElement_.autopaused=this.mediaElement_.autopause_pending,this.mediaElement_.autopause_time=(new Date).getTime(),this.mediaElement_.autopause_pending=!1},r.prototype.onPlay=function(){e.log("Playing"),this.mediaElement_.autopause_pending=!1,this.mediaElement_.autopaused=!1,this.mediaElement_.autopause_time=null
},r.prototype.onError=function(){e.log("Error ("+this.mediaElement_.error.code+")")},r.prototype.cancelRequests=function(){for(var e=0;e<this.fragmentManagers_.length;e++)this.fragmentManagers_[e].cancelRequests()},r.prototype.onSeeking=function(){e.log("Seeking"),this.cancelRequests(),this.mediaSrcMgr_.resetAll("seeking")},r.prototype.onSeeked=function(){e.log("Seeked")},r.prototype.onProgress=function(){var t=this.mediaSrcMgr_.getMediaSource();if(!t||"closed"===t.readyState)return void this.stopProgressTimer();
var i=this.mediaElement_.currentTime;if(this.mediaElement_.error)return void e.dlog(2,"Video Error: "+this.mediaElement_.error);for(var n=!1,r=0,a=0,o=0;o<this.fragmentManagers_.length;o++)if(this.fragmentManagers_[o].tick(i)){var l=this.mediaSrcMgr_.getBufferSize(o,i);this.mediaElement_.paused?l>=s.PAUSE_RESUME&&a++:l<s.AUTO_PAUSE_START&&(n=!0)}else r++;return r>0?void(r===this.fragmentManagers_.length&&this.mediaSrcMgr_.endOfStream()):void(this.mediaElement_.paused?this.mediaElement_.autopaused&&a===this.fragmentManagers_.length&&(e.dlog(2,"Autoresuming"),this.mediaElement_.play()):n&&(e.dlog(2,"Autopausing"),this.mediaElement_.autopause_pending=!0,this.mediaElement_.pause()))
},r.prototype.createMediaElement=function(){var t=document.getElementById("mediaElement");this.mediaElement_=document.createElement(n.Video_Type),this.imageElement_=document.createElement(n.Image_Type),t.appendChild(this.mediaElement_),t.appendChild(this.imageElement_),e.me=this.mediaElement_,e.img=this.imageElement_,this.showControls_?this.mediaElement_.hasAttribute("controls")||this.mediaElement_.setAttribute("controls","controls"):this.mediaElement_.hasAttribute("controls")&&this.mediaElement_.removeAttribute("controls")
},r.prototype.showMediaElement=function(t){var i=document.getElementById("mediaElement");this.mediaElementType_===n.MSE_Type&&(this.removeMediaEventListener("seeking"),this.removeMediaEventListener("seeked"),this.removeMediaEventListener("pause"),this.removeMediaEventListener("play"),this.removeMediaEventListener("error"),t!==n.MSE_Type&&(this.stopProgressTimer(),this.mediaSrcMgr_.dispose(),this.mediaSrcMgr_=new e.MediaSourceManager)),this.mediaElementType_!==n.Image_Type&&(this.mediaElement_.play(0),this.mediaElement_.pause());
var r=i.children;if(r&&r.length>0)for(var s=0;s<r.length;s++)"VIDEO"===r[s].nodeName&&t!==n.Image_Type?r[s].style.display="block":"IMG"===r[s].nodeName&&t===n.Image_Type?r[s].style.display="block":(r[s].style.display="none",r[s].src=null);this.mediaElementType_=t},r.prototype.addMediaEventListener=function(e,t){var i=t.bind(this);this.mediaElement_.addEventListener(e,i),this.mediaEvents_[e]=i},r.prototype.removeMediaEventListener=function(e){this.mediaElement_.removeEventListener(e,this.mediaEvents_[e]),this.mediaEvents_[e]=null
},r.prototype.initMseVideoElement=function(e){e&&this.addCaptionInfo(e),this.addMediaEventListener("seeking",this.onSeeking),this.addMediaEventListener("seeked",this.onSeeked),this.addMediaEventListener("pause",this.onPause),this.addMediaEventListener("play",this.onPlay),this.addMediaEventListener("error",this.onError),this.mediaElement_.autopause_pending=!1,this.mediaElement_.autopaused=this.options.autoplay?!0:!1,this.mediaElement_.seekingStatus="none"},r.prototype.onManifestLoad=function(t){return this.destroyed_?void e.log("Ignoring manifest load after destruction"):t?void e.log("Unable to load manifest"):void(this.options.cc?(this.closeCaptionsLoader_=new e.CloseCaptionsLoader(this.options.cc),this.closeCaptionsLoader_.load(this.onLoadcloseCaptions.bind(this))):this.onLoadcloseCaptions.call(this))
},r.prototype.addCaptionInfo=function(e){var t;t=this.mediaElement_.textTracks.length>0?this.mediaElement_.textTracks[0]:this.mediaElement_.addTextTrack("captions"),t.mode="showing";for(var i=e[0].start,n=e[0].end,r=[],s=0;s<e.length;s++){var a=new TextTrackCue(e[s].start,e[s].end,e[s].caption);if(i===e[s].start&&n===e[s].end&&r.push(a),i!==e[s].start||n!==e[s].end||s===e.length-1){for(var o=r.length-1;o>=0;o--)t.addCue(r[o]);r.length=0,i=e[s].start,n=e[s].end,s<e.length&&r.push(a)}}},r.prototype.onMediaSourceManagerInitialized=function(t){if(this.destroyed_)return void e.log("Ignoring MediaSourceManager initialization after destruction");
this.initMseVideoElement(t);for(var i=0;i<this.mediaSrcMgr_.getSourceBufferCount();i++)this.fragmentManagers_.push(new e.FragmentManager(this.mediaSrcMgr_,i,new e.AdaptiveManager(this.mediaSrcMgr_.getBitrates(i),this.options.algorithm,this.options.level)));this.startProgressTimer()},r.prototype.initializeMsePlayer=function(){var e=null;this.closeCaptionsLoader_&&(e=this.closeCaptionsLoader_.getCCInfo()),this.fragmentManagers_=[],this.mediaSrcMgr_.init(),window.msrc=this.mediaSrcMgr_.getMediaSource(),this.mediaSrcMgr_.attach(this.mediaElement_,this.manifestLoader_.getManifest(),e,this.onMediaSourceManagerInitialized.bind(this,e))
},r.prototype.stopProgressTimer=function(){null!==this.progressTimer_&&(e.dlog(2,"Deregistering progress timer"),window.clearInterval(this.progressTimer_),this.progressTimer_=null)},r.prototype.startProgressTimer=function(){null===this.progressTimer_&&(e.dlog(2,"Starting progress timer"),this.progressTimer_=setInterval(this.onProgress.bind(this),250))},r.prototype.initializeSimplePlayer=function(e,t){e!==n.Image_Type?(this.mediaElement_.src=t,this.mediaElement_.play()):this.imageElement_.src=t},r.prototype.onLoadcloseCaptions=function(t){return this.destroyed_?void e.log("Ignoring close captions load after destruction"):t?void e.log("Unable to load close captions"):void this.initializeMsePlayer()
},r.prototype.onManifestLoad=function(t){return this.destroyed_?void e.log("Ignoring manifest load after destruction"):t?void e.log("Unable to load manifest"):void(this.options.cc?(this.closeCaptionsLoader_=new e.CloseCaptionsLoader(this.options.cc),this.closeCaptionsLoader_.load(this.onLoadcloseCaptions.bind(this))):this.onLoadcloseCaptions.call(this))},r.prototype.getMediaType=function(t){var i=t.length;if(5>i)return e.log("Error invalid url"),null;var r=t.substring(t.length-4,t.length);switch(r){case".webm":case".mkv":case".mp4":return n.Video_Type;
case".mp3":return n.Audio_Type;case".jpg":return n.Image_Type;case".mpd":return n.MSE_Type;default:return n.MSE_Type}},r.prototype.init=function(){if(e.log("-------- Initializing --------"),!this.mediaSrcMgr_.isSupported())return e.log("Incompatible browser: Media Source extensions not suported"),!1;if(i(),!this.options.url)return e.log("No manifest URL found, please provide one"),!1;var t=this.getMediaType(this.options.url);this.mediaElementType_=t,this.options.mediaElement||this.options.imageElement||this.showMediaElement(t),t===n.MSE_Type?(this.manifestLoader_=new e.ManifestLoader(this.options.url),this.manifestLoader_.load(this.onManifestLoad.bind(this))):this.initializeSimplePlayer(t,this.options.url)
},r.prototype.destroy=function(){return this.destroyed_?void e.log("Refusing to destroy a second time"):(this.mediaElementType_===n.MSE_Type&&(this.removeMediaEventListener("seeking"),this.removeMediaEventListener("seeked"),this.removeMediaEventListener("pause"),this.removeMediaEventListener("play"),this.removeMediaEventListener("error"),this.stopProgressTimer(),this.mediaSrcMgr_.dispose(),this.mediaSrcMgr_=new e.MediaSourceManager),this.mediaElementType_!==n.Image_Type&&(this.mediaElement_.play(0),this.mediaElement_.pause()),void(this.destroyed_=!0))
},e.BasicPlayer=r}(),window.googledash=e}(),define("googledash",function(e){return function(){var t;return t||e.googledash}}(this)),define("plex/base/adapters/player/HTMLPlayerSubcontroller",["underscore","googledash","plex/base/utils/t","plex/base/utils/BaseClass","plex/base/utils/playerUtil","plex/base/utils/mediaUtil","plex/base/utils/Backlog","plex/base/utils/browser","plex/base/utils/types/streamTypes","plex/base/adapters/loggerAdapter"],function(e,t,i,n,r,s,a,o,l,u){var c=n.extend({readyEvent:"loadedmetadata",wrapped:["play","pause","setVolume","setPosition","resume","stop"],initialize:function(){e.bindAll(this,"onReady","onWaiting","onPlaying","onProgress","onTime","onPause","onVolume","onEnded","onError"),this.backlog=new a,this.backlog.wrapAll(this.wrapped,function(){return!!this.mediaElement
},this)},setMediaSrc:function(e){this.mediaElement.setAttribute("src",e)},removeMediaSrc:function(){this.mediaElement.setAttribute("src","")},addMediaListeners:function(){var e=this.mediaElement;e.addEventListener(this.readyEvent,this.onReady),e.addEventListener("waiting",this.onWaiting),e.addEventListener("playing",this.onPlaying),e.addEventListener("progress",this.onProgress),e.addEventListener("timeupdate",this.onTime),e.addEventListener("pause",this.onPause),e.addEventListener("volumechange",this.onVolume),e.addEventListener("ended",this.onEnded),e.addEventListener("error",this.onError)
},removeMediaListeners:function(){var e=this.mediaElement;e.removeEventListener(this.readyEvent,this.onReady),e.removeEventListener("waiting",this.onWaiting),e.removeEventListener("playing",this.onPlaying),e.removeEventListener("progress",this.onProgress),e.removeEventListener("timeupdate",this.onTime),e.removeEventListener("pause",this.onPause),e.removeEventListener("volumechange",this.onVolume),e.removeEventListener("ended",this.onEnded),e.removeEventListener("error",this.onError)},load:function(e){var i=e.model,n=e.model.get("url"),r=e.mediaElement;
this.backlog.clear(),this.model=i,this.mediaElement=r,this.autoplay=null==e.autoplay?!0:e.autoplay,this.offset=i.get("position");var s=!i.get("directPlay")&&"http"===e.protocol;this.useSeekStreamSwitch=s||e.useOffsetHLS,r.stream_restart=!1,r.autoplay=this.autoplay,this.addMediaListeners(),u.group("HTML Player",["URL: "+n,"Autoplay: "+this.autoplay,"Offset: "+this.offset]),"dash"===e.protocol?(this.dashPlayer=new t.BasicPlayer({url:n,mediaElement:r}),this.dashPlayer.init()):(this.setMediaSrc(n,e.mimeType),r.load())
},play:function(){this.mediaElement.play()},pause:function(){this.mediaElement.pause(),this.mediaElement.autoplay=!1},setVolume:function(e){this.mediaElement.volume=e/100},setPosition:function(e){this.mediaElement.readyState>0&&(this.mediaElement.currentTime=e/1e3)},resume:function(){u.log("resuming at "+this.offset),this.setPosition(this.offset),this.offset=0},stop:function(){var e=this.dashPlayer;if(this.removeMediaListeners(),this.model.set("ready",!1),e){this.dashPlayer=null;try{e.destroy()}catch(t){}}else this.setPosition(0),this.pause();
this.removeMediaSrc(),this.mediaElement=null},preferElementDuration:function(){if(!e.isFinite(this.mediaElement.duration))return!1;if(this.model.get("type")===r.types.MUSIC){var t=e.first(s.getStreams(this.model.get("media"),{streamType:l.getStreamTypeByString("audio").id,selected:!0}));if(t&&"vbr"===t.bitrateMode)return!1}return!0},onReady:function(){if(!this.model.get("ready")){if(this.model.set({ready:!0,loaded:!0}),this.preferElementDuration()){var e=1e3*this.mediaElement.duration;this.useSeekStreamSwitch&&(e+=this.offset),this.model.set("duration",Math.round(e))
}var t=this.model.get("volume");null!=t&&this.setVolume(t),this.backlog.process()}},onWaiting:function(){this.model.set("state",r.states.BUFFERING)},onPlaying:function(){this.model.set("state",r.states.PLAYING)},onProgress:function(){for(var e=this.mediaElement.buffered,t=null,i=null,n=0,r=e.length;r>n;n++){var s=e.start(n),a=e.end(n);(null===t||t>s)&&(t=s),(null===i||a>i)&&(i=a)}this.model.set({startBuffer:Math.round(1e3*t),endBuffer:Math.round(1e3*i)})},onTime:function(){var e=this.offset&&!this.useSeekStreamSwitch,t=this.mediaElement.stream_restart;
if(e||t)return void(e&&this.resume());var i=1e3*this.mediaElement.currentTime;this.useSeekStreamSwitch&&(i+=this.offset),!this.mediaElement.paused&&this.model.get("buffering")&&this.model.set("state",r.states.PLAYING),this.model.set("position",Math.round(i))},onPause:function(){var e=this.model.get("partIndex")+1<this.model.get("partCount");this.mediaElement.ended&&e||(this.mediaElement.resume_pending||this.mediaElement.autopause_pending||this.mediaElement.autopaused||this.mediaElement.stream_restart?this.model.set("state",r.states.BUFFERING):this.model.set("state",r.states.PAUSED))
},onVolume:function(){this.model.set("volume",Math.round(100*this.mediaElement.volume))},onEnded:function(){this.model.set("ended",!0)},onError:function(e){var t=e.target.error;t&&u.warn("Video error code: "+t.code),this.model.set({state:r.states.ERROR,errorMessage:i("There was a problem playing this item.")})}});return c}),define("plex/base/adapters/player/LocalPlayerController",["underscore","jquery","plex/base/utils/t","plex/base/utils/BaseClass","plex/base/utils/mediaUtil","plex/base/utils/playerUtil","plex/base/utils/Backlog","plex/base/adapters/playerProfileAdapter","plex/base/mixins/eventMixin","plex/base/mixins/player/playerControllerMixin","plex/base/adapters/player/HTMLPlayerSubcontroller"],function(e,t,i,n,r,s,a,o,l,u,c){var d=n.extend({mixins:[l,u],playerProfileAdapter:o,wrapped:["play","pause","setVolume","setPosition"],modelDefaults:function(){var t=u.modelDefaults.apply(this,arguments);
return e.extend(t,{state:s.states.BUFFERING})},initialize:function(t){t||(t={}),u.initialize.apply(this,arguments),e.bindAll(this,"onDecisionSuccess","onDecisionError"),t||(t={}),this.profile=this.playerProfileAdapter.prop(this.type),this.backlog=new a,this.backlog.wrapAll(this.wrapped,function(){return!!this.subcontroller},this),this.resetStream=e.debounce(this.resetStream,t.resetStreamDebounce||200),t.handleSetPositionDebounce&&(this.handleSetPosition=e.debounce(this.handleSetPosition,t.handleSetPositionDebounce))
},load:function(e){this.originalOptions=e,this.model=e.model,this.autoplay=e.autoplay,this.postplay=e.postplay,this.mediaElement=e.mediaElement;var t=this.model.get("item"),i=this.model.get("playQueue");return i=i&&i.get("collection"),this.reset(t),this.listenTo(this.model,{"change:state":this.onStateChange,"change:qualityIndex":this.onQualityIndexChange,"change:audioStreamID":this.onAudioStreamIDChange,"change:subtitleStreamID":this.onSubtitleStreamIDChange,"change:ended":this.onEndedChange}),i&&this.listenTo(i,{reset:this.onPlayQueueChange}),this.getPlayerDecision(t,e)
},populateItem:function(e){var t={reset:!0,scope:"player"};return e.isLibraryItem()&&(t.data={checkFiles:"1"}),e.populate(t)},loadMediaElement:function(t){this.subcontroller=this.getSubcontrollerByType(this.playerType),this.backlog.process();var i,n=this.profile&&this.profile.protocols,r=this.protocol;r&&n&&n[r]&&(i=n[r].mimeType),this.subcontroller.load(e.extend({},this.originalOptions,{model:this.model,protocol:r,mediaElement:this.mediaElement,autoplay:this.autoplay,mimeType:i,useOffsetHLS:t.useOffsetHLS}))
},getSubcontrollerByType:function(){return new c},embed:function(n){var r=this.model.get("item"),a=t.ajax(r.server.getXHROptions(n.key));a.done(e.bind(function(e){this.model.set("embedHtml",e)},this)),a.fail(e.bind(function(){this.model.set({state:s.states.ERROR,errorMessage:i("There was a problem embedding this video.")})},this))},redirect:function(t){var i=this.model.get("item"),n=i.get("url");if(!n&&t){var r=t.key.match(/\/webkit\?url=([^&]+)/);r&&(n=decodeURIComponent(r[1]))}window.open(n),e.defer(e.bind(function(){this.model.set("finished",!0)
},this))},play:function(){this.model.get("state")!==s.states.PLAYING&&this.subcontroller.play()},pause:function(){this.model.get("state")!==s.states.PAUSED&&this.subcontroller.pause()},setPosition:function(e,t){t||(t={}),this.canSeek(e)&&(this.model.set("finished",!1),this.model.set("position",e),this.model.trigger("seeking",this.model),this.subcontroller.useSeekStreamSwitch?this.switchStreams(t):this.handleSetPosition(e,t))},handleSetPosition:function(e,t){this.canHandleDebounce()&&(this.subcontroller.setPosition(e),t.autoplay&&this.play())
},canHandleDebounce:function(){var e=this.model&&this.model.get("state");return void 0===e?!1:e!==s.states.STOPPED},setVolume:function(e){this.model.set("volume",e),this.subcontroller.setVolume(e)},skipPrevious:function(){var e=u.skipPrevious.apply(this,arguments);return e&&this.switchStreams({autoplay:!0}),e},skipNext:function(){var e=u.skipNext.apply(this,arguments);return e&&this.switchStreams({autoplay:!0}),e},skipTo:function(){var e=u.skipTo.apply(this,arguments);return e&&this.switchStreams({autoplay:!0}),e
},switchStreams:function(e){e||(e={}),null==e.autoplay&&(e.autoplay=!this.model.get("paused")),this.mediaElement&&(this.mediaElement.stream_restart=!0),this.originalOptions.media=this.model.get("media"),this.originalOptions.part=this.model.get("part"),this.originalOptions.offset=this.model.get("position"),this.pause(),this.resetStream(e)},resetStream:function(t){if(this.canHandleDebounce()){var i=this.stopSession({reset:!0});i.done(e.bind(function(){this.autoplay=t.autoplay,this.getPlayerDecision(this.currentItem,this.originalOptions)
},this))}},stop:function(e){return u.stop.apply(this,arguments),this.stopSession(e)},refreshPlayQueue:function(){var e=this.model.get("playQueue");e&&e.fetch()},onDecisionSuccess:function(e){var t=this.model.get("item"),i=0;if(this.model.get("state")!==s.states.STOPPED){e.part&&e.part.duration&&(i=e.part.duration),this.session=e.session,this.playerType=e.playerType,this.protocol=e.protocol;var n=e.media,a=e.part,o=r.getSelectedAudio(n),l=r.getSelectedSubtitles(n);this.model.set({media:n,part:a,url:e.url,transcodeServer:e.transcodeServer,mediaIndex:n?r.getMediaIndex(t,n.id):0,partIndex:a?r.getPartIndex(n,a.key):0,partCount:r.getPartCount(e.media),audioStreamID:o?o.id:0,subtitleStreamID:l?l.id:0,state:this.autoplay?s.states.BUFFERING:s.states.PAUSED,position:e.offset,duration:i,directPlay:e.canDirectPlay}),this.loadMediaElement(e)
}},onDecisionError:function(e){if(this.model.get("state")!==s.states.STOPPED){var t=this.playerProfileAdapter.prop("capabilities");if(e.embed&&t.embed)return void this.embed(e.part);if(e.redirect&&t.redirect)return void this.redirect(e.part);var n=e.errorMessage||i("There was a problem playing this item.");this.model.set({state:s.states.ERROR,errorMessage:n})}},onQualityIndexChange:function(e,t){var i=e.previous("qualityIndex");null!=t&&null!=i&&this.switchStreams()},onAudioStreamIDChange:function(e,t){var i=e.previous("audioStreamID");
null!=t&&null!=i&&this.switchStreams()},onSubtitleStreamIDChange:function(e,t){var i=e.previous("subtitleStreamID");null!=t&&null!=i&&this.switchStreams()},onPlayQueueChange:function(){this.previousItem=this.getPreviousItem(),this.nextItem=this.getNextItem(),this.model.set({canSkipPrevious:!!this.previousItem,canSkipNext:!!this.nextItem})},onStateChange:function(e,t){var i=this.timeline();if(t===s.states.PLAYING){var n=e.get("playQueue");n&&i.done(function(){n.fetch()})}t===s.states.STOPPED||t===s.states.ERROR?this.stopTimeline():this.startTimeline(),t===s.states.PAUSED?this.startPing():this.stopPing(),t===s.states.PLAYING?this.startPlaybackTracking():this.stopPlaybackTracking()
},onEndedChange:function(e,t){if(t){var i=e.get("partIndex"),n=e.get("partCount");if(++i>=n)this.nextItem&&!this.postplay?this.skipNext():(!this.nextItem&&this.postplay?this.stop():this.pause(),this.model.set("finished",!0));else{var r=e.get("media");this.model.set({part:r.Part[i],position:0}),this.switchStreams({autoplay:!0})}}}});return d}),define("plex/base/adapters/player/MusicPlayerController",["underscore","plex/base/utils/playerUtil","plex/base/utils/playerDecisionEngine","plex/base/utils/transcoder","plex/base/adapters/player/LocalPlayerController"],function(e,t,i,n,r){var s=r.extend({type:t.types.MUSIC,modelDefaults:function(){var t=r.prototype.modelDefaults.apply(this,arguments);
return e.extend(t,{canPlayPause:!0,canStop:!0,canSeek:!0,canSetVolume:!0,showSeekBar:!0,showPlayQueue:!0})},load:function(e){if(!e.mediaElement){var i=t.getElementByType(this.type);e.mediaElement=document.createElement(i)}return r.prototype.load.call(this,e)},getPlayerDecision:function(e,t){this.backlog.clear();var r=i.getPlayerDecision({type:this.type,profile:this.profile,item:e,offset:t.offset,fallbackServer:t.fallbackServer,transcoder:n});return r.done(this.onDecisionSuccess),r.fail(this.onDecisionError),r
}});return s}),define("plex/base/models/Player/PlayerModel",["underscore","backbone","plex/base/utils/playerUtil"],function(e,t,i){var n={item:null,media:null,part:null,url:null,playQueue:null,transcodeServer:null,mediaIndex:-1,partIndex:-1,partCount:1,qualityIndex:null,videoStreamID:null,audioStreamID:null,subtitleStreamID:null,type:i.types.VIDEO},r={state:i.states.STOPPED,stopped:!0,paused:!1,playing:!1,buffering:!1,error:!1,errorMessage:null,ready:!1,loaded:!1,ended:!1,finished:!1,embedHtml:null,duration:0,position:0,volume:100,startBuffer:0,endBuffer:0,percentBuffered:0,shuffle:!1,repeat:!1,directPlay:!1},s={canPlayPause:!1,canStop:!1,canSeek:!1,canSetVolume:!1,canSetVideoStream:!1,canSetAudioStream:!1,canSetSubtitleStream:!1,canSetQuality:!1,canShuffle:!1,canRepeat:!1,canSkipPrevious:!1,canSkipNext:!1,showSeekBar:!1,showAudioStream:!1,showSubtitleStream:!1,showQuality:!1,showPlayQueue:!1,showMinimize:!1,showMaximize:!1,showEnterFullscreen:!1,showExitFullscreen:!1,forceWebkitVideoFullscreen:!1},a=t.Model.extend({itemDefaults:n,playerDefaults:r,controllerDefaults:s,defaults:e.extend({},n,r,s),initialize:function(){this.on("invalid",function(t,i){e.indexOf(i.keys,"duration")>-1&&(i.attrs.duration=Math.max(i.attrs.duration,0)),e.indexOf(i.keys,"position")>-1&&(i.attrs.position=Math.min(Math.max(i.attrs.position,0),i.attrs.duration)),e.indexOf(i.keys,"volume")>-1&&(i.attrs.volume=Math.min(Math.max(i.attrs.position,0),100)),t.set(i.attrs)
}),this.on("change:state",function(e,t){e.set({stopped:t===i.states.STOPPED,paused:t===i.states.PAUSED,playing:t===i.states.PLAYING,buffering:t===i.states.BUFFERING,error:t===i.states.ERROR}),t!==i.states.STOPPED&&e.set("ended",!1)}),this.on("change:item",function(e,t){var i=e.get("playQueue");i&&(i.set("selectedItem",t),i.fetch())}),this.on("change:position",function(e,t){var i=this.get("duration"),n=i?Math.min(Math.max(t/i*100,0),100):0;this.set("positionPercentage",n)})},validate:function(e){var t=[];
return e.duration<0&&t.push("duration"),(e.position<0||e.position>e.duration)&&t.push("position"),(e.volume<0||e.volume>100)&&t.push("volume"),t.length?{keys:t,attrs:e}:void 0}});return a}),define("plex/chromecast/views/CastBaseMediaView",["backbone","plex/base/utils/transcoder","plex/chromecast/mixins/viewMixin","plex/chromecast/models/castAppModel"],function(e,t,i,n){var r=e.View.extend({mixins:[i],loadImage:function(e,i,r){var s=r.placeholderClass,a=r.placeholder;s&&e.addClass(s),a&&e.attr("style","background-image: url("+a+")");
var o=t.image(this.model.server,i,{fallbackServer:n.get("primaryServer"),width:r.width,height:r.height,minSize:r.minSize}),l=this.preloadImage(o);return l.done(function(){s&&e.removeClass(s),e.attr("style","background-image: url("+o+")")}),l},loadMediaFlag:function(e,i){var r,s=this.model.get("mediaTagPrefix"),a=this.model.get("mediaTagVersion"),o=i.flag;if(o){var l=this.model.get("Media");l&&l.length&&(r=l[0][o])}else o=i.modelAttribute,r=this.model.get(o);if(r){r=s+o+"/"+encodeURIComponent(r)+"?t="+a;
var u=t.image(this.model.server,r,{fallbackServer:n.get("primaryServer"),width:i.width,height:i.height});e.attr("src",u)}else e.addClass("hidden")},getStarRating:function(){for(var e=this.model.get("rating")||0,t=this.model.get("userRating"),i=t?t:e,n=Math.round(i/2),r="",s=0;5>s;s++)r+=n>s?'<i class="star-icon plex-icon star-full"></i>':'<i class="star-icon plex-icon star-empty"></i>';return r}});return r}),define("plex/chromecast/views/CastBasePlayerView",["plex/chromecast/views/CastBaseMediaView"],function(e){var t=e.extend({close:function(){return e.prototype.close(this,arguments),this.controller.stop(),this.controller.waitForRequests()
}});return t}),define("plex/chromecast/views/CastMusicPlayerView",["tpl!templates/chromecast/CastMusicPlayerView.tpl","underscore","plex/base/utils/dispatcher","plex/base/utils/playerUtil","plex/base/utils/posterPlaceholders","plex/base/utils/formatters/dateTimeUtil","plex/chromecast/utils/mediaElementPool","plex/base/adapters/player/MusicPlayerController","plex/chromecast/models/castAppModel","plex/base/models/Player/PlayerModel","plex/chromecast/views/CastBasePlayerView"],function(e,t,i,n,r,s,a,o,l,u,c){var d=c.extend({id:"music",className:"container",template:e,burnFlipDelay:6e4,ui:{container:".music-player-container",background:".background",position:".player-position",duration:".player-duration",sliderTrack:".player-slider-track",sliderProgress:".player-slider-progress",next:".music-next"},initialize:function(e){this.options=e,this.playerModel=new u({item:this.model,playQueue:e.playQueue}),this.controller=new o,this.listenTo(this.playerModel,{"change:item":this.onPlayerItemChange,"change:state":this.onPlayerStateChange,"change:finished":this.onPlayerFinishedChange,"change:duration":this.onPlayerDurationChange,"change:position":this.onPlayerPositionChange}),this.listenTo(e.playQueue.get("collection"),{sync:this.onPlayQueueChange,reset:this.onPlayQueueChange})
},updateDetails:function(e,t){var i=e.get("thumb")||e.get("parentThumb")||e.get("grandparentThumb");this.loadImage(t.poster,i,{placeholderClass:r.track,width:t.poster.width(),height:t.poster.height(),minSize:!0}),t.artist.text(e.get("grandparentTitle")),t.album.text(e.get("parentTitle")),t.track.text(e.get("title"))},updateNext:function(){var e=this.controller.getNextItem();this.ui.next.toggleClass("hidden",!e),e&&(e.isLibraryItem()?e.populate().done(t.bind(this.updateDetails,this,e,this.nextEls)):this.updateDetails(e,this.nextEls))
},updateContent:function(){var e=this.model;this.loadImage(this.ui.background,e.get("art"),{width:1280,height:720}),this.updateDetails(e,this.currentEls),this.updateNext(),this.ui.position.text("0:00"),this.ui.sliderProgress.attr("style","width: 0px;")},onRender:function(){this.audioEl=a.createElement("video"),this.currentEls={poster:this.$(".music-current .media-poster"),artist:this.$(".music-current .music-artist"),album:this.$(".music-current .music-album"),track:this.$(".music-current .music-track")},this.nextEls={poster:this.$(".music-next .media-poster"),artist:this.$(".music-next .music-artist"),album:this.$(".music-next .music-album"),track:this.$(".music-next .music-track")},i.trigger("change:mediaElement",this.audioEl),this.controller.load(t.extend(this.options,{model:this.playerModel,mediaElement:this.audioEl,fallbackServer:l.get("primaryServer")})),this.updateContent();
var e=!1;this.burnFlipInterval=setInterval(t.bind(function(){e=!e,this.ui.container.toggleClass("flip",e),this.ui.background.toggleClass("flip",e)},this),this.burnFlipDelay)},onClose:function(){c.prototype.onClose.apply(this,arguments),clearInterval(this.burnFlipInterval)},onPlayerItemChange:function(e,i){this.model=i,i.isLibraryItem()?i.populate().done(t.bind(this.updateContent,this)):this.updateContent()},onPlayerStateChange:function(e,r){return r===n.states.ERROR?void t.defer(function(){i.trigger("navigate","error",{error:e.get("errorMessage")})
}):(this.trigger("change:paused",r===n.states.PAUSED),void this.ui.container.toggleClass("paused",r===n.states.PAUSED))},onPlayerFinishedChange:function(e,t){t&&i.trigger("navigate","waiting")},onPlayerDurationChange:function(e,t){this.ui.duration.text(s.formatDuration(t))},onPlayerPositionChange:function(e,t){var i=this.playerModel.get("duration");this.ui.position.text(s.formatDuration(t));var n=this.ui.sliderTrack.width(),r=t/i*n;r=Math.min(Math.max(r,0),n),this.ui.sliderProgress.attr("style","width: "+Math.round(r)+"px")
},onPlayQueueChange:function(){this.updateNext()}});return d}),define("tpl!templates/chromecast/CastPhotoPlayerView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+="";return __p}}),define("tpl!templates/chromecast/PhotoBackgroundView.tpl",function(){return function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="background-container transition-out">\n  <div class="photo" style="background-image: url('+(null==(__t=src)?"":__t)+')"></div>\n</div>\n';
return __p}}),define("plex/base/adapters/player/PhotoPlayerController",["underscore","jquery","plex/base/utils/BaseClass","plex/base/utils/capabilities","plex/base/utils/playerUtil","plex/base/mixins/eventMixin","plex/base/mixins/player/playerControllerMixin"],function(e,t,i,n,r,s,a){var o=i.extend({mixins:[s,a],type:r.types.PHOTO,slideshowDelay:5e3,skipTransition:!1,modelDefaults:function(){var t=a.modelDefaults.apply(this,arguments);return e.extend(t,{ready:!0,canPlayPause:!0,canStop:!0,showEnterFullscreen:n.hasFullscreen})
},initialize:function(t){a.initialize.apply(this,arguments),this.loop=!(!t||!t.loop),e.bindAll(this,"skipPrevious","skipNext")},load:function(e){return this.model=e.model,e.autoplay?this.play():this.pause(),this.reset(this.model.get("item")),this.listenTo(this.model,{"change:state":this.onStateChange,"change:loaded":this.onLoadedChange}),t.Deferred().resolve().promise()},reset:function(t){this.currentItem&&this.timeline({state:r.states.STOPPED,continuing:!0});var i={loop:this.loop};return this.currentItem=t,this.previousItem=this.getPreviousItem(t,i),this.nextItem=this.getNextItem(t,i),this.model.set(e.result(this,"modelDefaults")),this.timeline(),t
},play:function(){this.model.set("state",r.states.PLAYING),this.model.get("loaded")&&(this.slideshowTimeout=setTimeout(this.skipNext,this.slideshowDelay)),this.startPlaybackTracking()},pause:function(){this.model.set("state",r.states.PAUSED),this.slideshowTimeout=clearTimeout(this.slideshowTimeout),this.stopPlaybackTracking()},skipPrevious:function(e){return e||(e={}),this.model.get("loaded")?(this.skipTransition=!!e.manual,this.previousItem&&(this.slideshowTimeout=clearTimeout(this.slideshowTimeout)),a.skipPrevious.apply(this,arguments)):!1
},skipNext:function(e){return e||(e={}),this.model.get("loaded")?(this.skipTransition=!!e.manual,this.nextItem&&(this.slideshowTimeout=clearTimeout(this.slideshowTimeout)),a.skipNext.apply(this,arguments)):!1},stop:function(){a.stop.apply(this,arguments),this.slideshowTimeout=clearTimeout(this.slideshowTimeout),this.stopPlaybackTracking(),this.trackPlaybackEvent()},onStateChange:function(){this.timeline()},onLoadedChange:function(e,t){t&&e.get("playing")&&(clearTimeout(this.slideshowTimeout),this.slideshowTimeout=setTimeout(this.skipNext,this.slideshowDelay))
}});return o}),define("plex/chromecast/views/CastPhotoPlayerView",["tpl!templates/chromecast/CastPhotoPlayerView.tpl","tpl!templates/chromecast/PhotoBackgroundView.tpl","underscore","plex/base/utils/dispatcher","plex/base/utils/playerUtil","plex/base/utils/transcoder","plex/chromecast/utils/mediaElementPool","plex/base/adapters/player/PhotoPlayerController","plex/base/models/Player/PlayerModel","plex/chromecast/views/CastBasePlayerView","plex/chromecast/views/SlideshowView"],function(e,t,i,n,r,s,a,o,l,u,c){var d=u.extend({id:"photo",className:"container",template:e,initialize:function(e){this.options=e,this.playerModel=new l({item:this.model,playQueue:e.playQueue}),this.controller=new o({loop:!0}),this.listenTo(this.playerModel,{"change:item":this.onPlayerItemChange,"change:state":this.onPlayerStateChange}),this.slideshow=new c({playerModel:this.playerModel,itemTemplate:t})
},loadImage:function(){var e=s.image(this.model.server,this.model.getMediaKey(),{width:1280,height:720});this.photoEl.src=e,this.slideshow.showImage(e,{skipTransition:this.controller.skipTransition})},onRender:function(){this.$el.append(this.slideshow.render().el),this.photoEl=a.createElement("img"),this.photoEl.load=function(){},n.trigger("change:mediaElement",this.photoEl),this.controller.load(i.extend(this.options,{model:this.playerModel})),this.loadImage()},onPlayerItemChange:function(e,t){this.model=t,this.loadImage()
},onPlayerStateChange:function(e,t){return t===r.states.ERROR?void i.defer(function(){n.trigger("navigate","error",{error:e.get("errorMessage")})}):void this.trigger("change:paused",t===r.states.PAUSED)}});return d}),define("tpl!templates/chromecast/CastVideoPlayerView.tpl",function(){return function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="video-controls transition-out">\n  <div class="background video-background"></div>\n\n  <span class="player-icon"><i class="plex-icon pause-alt"></i></span>\n\n  <div class="video-controls-overlay">\n    <div class="video-player-details">\n      <h2 class="video-player-header">\n        <span class="player-year">\n          '+(null==(__t=year)?"":__t)+'\n        </span>\n\n        <img class="player-logo" src="img/plex-logo.svg">\n\n        <span class="player-pause-icon"><i class="plex-icon pause-alt"></i></span>\n        <span class="loading player-loading"></span>\n\n        <span class="player-title ',secondaryTitle||(__p+="extended"),__p+='">\n          '+(null==(__t=title)?"":__t)+'\n        </span>\n        <span class="player-secondary-title ',secondaryTitle||(__p+="hidden"),__p+='">\n          '+(null==(__t=secondaryTitle)?"":__t)+'\n        </span>\n      </h2>\n    </div>\n\n    <div class="player-metadata-right">\n      <img class="player-content-rating">\n\n      <div class="player-rating">\n        <span class="rating disabled">\n          '+(null==(__t=rating)?"":__t)+'\n        </span>\n      </div>\n    </div>\n\n    <div class="player-metadata player-metadata-tags text-muted '+(null==(__t=genreDisplay)?"":__t)+'">\n      '+(null==(__t=genre)?"":__t)+'\n    </div>\n\n    <div class="player-metadata">\n      '+(null==(__t=runtime)?"":__t)+'\n    </div>\n\n    <div class="player-metadata text-muted">\n      '+(null==(__t=episodeIndex)?"":__t)+'\n    </div>\n\n    <div class="player-metadata">\n      '+(null==(__t=episodeTitle)?"":__t)+'\n    </div>\n\n    <div class="player-seek-bar-container">\n      <span class="player-position">0:00</span>\n      <span class="player-duration">0:00</span>\n      <div class="player-seek-bar">\n        <div class="player-slider-track">\n          <div class="player-slider-buffer"></div>\n          <div class="player-slider-progress"></div>\n        </div>\n      </div>\n      <div class="player-slider-thumb"></div>\n    </div>\n\n    <div class="video-player-poster media-poster"></div>\n  </div>\n\n  <div class="post-play"></div>\n</div>\n';
return __p}}),define("plex/base/utils/formatters/tagUtil",["underscore","plex/base/utils/formatters/stringUtil","plex/base/utils/types/mediaTypes"],function(e,t,i){var n={truncateTagList:function(i){var n=i.tags,r=i.separator||", ",s="";if(n&&n.length){var a=i.maxTags||n.length;a>n.length&&(a=n.length);for(var o=0;a>o;o++){var l=n[o],u=e.escape(t.truncate(l.tag,i.maxLen));"undefined"!=typeof l.tag&&""!==l.tag&&(s+=u,a>o+1&&(s+=r))}}return s},truncateLinkedTagList:function(n){var r=n.model.section,s=i.getMediaTypeByString(n.model.get("type")),a=n.tags,o=r&&r.get("allowAdvancedFilters"),l="",u=function(i){var a=e.escape(t.truncate(i.tag,n.maxLen));
if(!o||!i.id)return a;var l=["#!/server/"+encodeURIComponent(r.server.id),"/section/"+encodeURIComponent(r.id),"/filter","/"+encodeURIComponent(s.id),"/"+encodeURIComponent(n.key),"/"+encodeURIComponent(i.id),"/"+encodeURIComponent(i.tag)];return'<a class="pivot-link" href="'+l.join("")+'">'+a+"</a>"};if(a&&a.length){var c=n.maxTags||a.length;c>a.length&&(c=a.length);for(var d=0;c>d;d++){var h=a[d];"undefined"!=typeof h.tag&&""!==h.tag&&(l+=u(h),c>d+1&&(l+=", "))}}return l}};return n}),define("plex/base/utils/types/extraTypes",["underscore","plex/base/utils/BaseClass"],function(e,t){var i=t.extend({types:[{id:1,typeString:"trailer",title:"Trailer"},{id:2,typeString:"deletedScene",title:"Deleted Scene"},{id:3,typeString:"interview",title:"Interview"},{id:4,typeString:"musicVideo",title:"Music Video"},{id:5,typeString:"behindTheScenes",title:"Behind the Scenes"},{id:6,typeString:"scene",title:"Scene"},{id:7,typeString:"liveMusicVideo",title:"Live Music Video"},{id:8,typeString:"lyricMusicVideo",title:"Lyric Music Video"}],initialize:function(){this.byID=e.reduce(this.types,function(e,t){return e[t.id]=t,e
},{}),this.byType=e.reduce(this.types,function(e,t){return e[t.typeString]=t,e},{})},getExtraType:function(e){return this.byID[e]},getExtraTypeByString:function(e){return this.byType[e]}});return new i}),define("plex/chromecast/adapters/player/CastVideoPlayerController",["underscore","plex/base/utils/t","plex/base/utils/playerUtil","plex/base/utils/playerQualities","plex/base/utils/playerDecisionEngine","plex/base/utils/transcoder","plex/base/adapters/player/LocalPlayerController","plex/chromecast/models/castSettingsModel"],function(e,t,i,n,r,s,a,o){var l=a.extend({type:i.types.VIDEO,getPlayerDecision:function(a,l){this.backlog.clear();
var u=this.populateItem(a);return u=u.then(e.bind(function(){var e=o.get("qualityIndex"),t=n.getQualityByIndex(e);this.model.set("qualityIndex",e);var i=r.getPlayerDecision({type:this.type,profile:this.profile,item:a,media:l.media,part:l.part,offset:l.offset,fallbackServer:l.fallbackServer,allowDirectPlay:o.get("directPlay"),hasFlash:!1,hasNativeHLS:!1,hasDASH:!0,hasStreamingMKV:!0,quality:t,transcoder:s,transcoderOptions:{directStream:o.get("directStream")?1:0,subtitleSize:o.get("subtitleSize"),audioBoost:o.get("audioBoost")}});
return i.done(this.onDecisionSuccess),i.fail(this.onDecisionError),i},this),e.bind(function(){this.model.set({state:i.states.ERROR,errorMessage:t("Plex Media Server is not responding.")})},this))},skipPrevious:function(){return this.model.get("finished")?(this.setPosition(0,{autoplay:!0}),this.trigger("manual"),this.model.get("item")):a.prototype.skipPrevious.apply(this,arguments)},skipNext:function(e){return e||(e={}),this.model.get("finished")&&!e.autoadvance&&this.trigger("manual"),a.prototype.skipNext.apply(this,arguments)
},play:function(){this.model.get("finished")?(this.trigger("manual"),a.prototype.skipNext.apply(this,arguments)):a.prototype.play.apply(this,arguments)}});return l}),define("tpl!templates/chromecast/CastPostPlayView.tpl",function(){return function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="post-play-background background"></div>\n\n<div class="post-play-footer">\n  <div class="item-previous">\n    <div class="item-poster">\n      <h1>Previous</h1>\n      <div class="media-poster"></div>\n    </div>\n    <div class="item-summary">\n      <h1 class="media-title">'+(null==(__t=previous.title)?"":__t)+'</h1>\n      <h2 class="media-subtitle">'+(null==(__t=previous.subtitle)?"":__t)+'</h2>\n    </div>\n  </div>\n\n  <div class="item-next">\n    <div class="item-poster">\n      <h1>Playing Next</h1>\n      <div class="media-poster '+(null==(__t=next.type)?"":__t)+'">\n        <div class="countdown"></div>\n      </div>\n    </div>\n\n    <div class="item-summary '+(null==(__t=next.type)?"":__t)+'">\n      <h1 class="next-title media-title">'+(null==(__t=next.title)?"":__t)+'</h1>\n      <h2 class="next-subtitle media-subtitle-1">'+(null==(__t=next.subtitle)?"":__t)+'</h2>\n      <h3 class="next-index media-subtitle-2">'+(null==(__t=next.index)?"":__t)+"</h3>\n      <p>"+(null==(__t=next.summary)?"":__t)+"</p>\n    </div>\n  </div>\n</div>\n";
return __p}}),define("plex/base/mixins/player/postPlayMixin",["underscore","backbone","plex/base/utils/mediaUtil"],function(e,t,i){var n={ui:{background:".post-play-background",previousPoster:".item-previous .media-poster",nextPoster:".item-next .media-poster",nextTitle:".next-title",nextSubtitle:".next-subtitle",nextIndex:".next-index",countdown:".countdown"},createCountdown:function(e){this.totalSeconds=e,this.secondsLeft=this.totalSeconds,this.progressModel=new t.Model({text:this.secondsLeft}),this.updateCountdown()
},serializeData:function(){var e=this.nextItem.get("title"),t=this.nextItem.get("grandparentTitle"),i={previous:{title:this.previousItem.get("title")||this.previousItem.get("grandparentTitle"),subtitle:this.episodeIndexFor(this.previousItem)||this.previousItem.get("year")},next:{title:t||e,summary:this.nextItem.get("summary")}};return t?(i.next.subtitle=e,i.next.index=this.episodeIndexFor(this.nextItem)):i.next.subtitle=this.nextItem.get("year"),i},episodeIndexFor:function(e){var t="";return"episode"===e.get("type")&&(t=i.getSeasonEpisodeIndex({seasonIndex:e.get("parentIndex"),episodePrefix:" \xb7 E{1}",episodeIndex:e.get("index"),date:e.get("originallyAvailableAt"),noLeadingZero:!0})),t
},updateCountdown:function(){var t=(new Date).getTime(),i=t-(this.startTime||t);this.startTime=t,this.secondsLeft-=i/1e3,this.secondsLeft>0?(this.progressModel.set("fraction",1-this.secondsLeft/this.totalSeconds),this.progressModel.set("text",Math.ceil(this.secondsLeft)),this.countdownAnimator=window.requestAnimationFrame(e.bind(this.updateCountdown,this))):this.trigger("next")},onClose:function(){window.cancelAnimationFrame(this.countdownAnimator)}};return n}),define("tpl!templates/chromecast/CircleProgressBarView.tpl",function(){return function(obj){{var __p="";
Array.prototype.join}with(obj||{})__p+='<canvas class="circle-progress-bar"></canvas>\n<div class="circle-progress-text"></div>';return __p}}),define("plex/base/mixins/views/circleProgressBarMixin",["plex/base/utils/capabilities"],function(e){var t={className:"circle-progress",ui:{canvas:".circle-progress-bar"},bindings:{".circle-progress-text":{modelAttribute:"text"}},initialize:function(){e.hasCanvas&&this.listenTo(this.model,"change:fraction",this.onFractionChange)},onRender:function(){e.hasCanvas&&(this.progressCanvas=this.ui.canvas[0])
},onFractionChange:function(){if(this.$el.width()>0&&(this.progressCanvas.width=this.$el.width(),this.progressCanvas.height=this.$el.height(),this.progressContext=this.progressCanvas.getContext("2d")),this.progressContext){var e=this.model.get("fraction");this.progressContext.lineWidth=5,this.progressContext.strokeStyle="#cc7b19";var t=this.progressCanvas.width/2,i=this.progressCanvas.height/2,n=t-5,r=-Math.PI/2,s=r+e*Math.PI*2;this.progressContext.clearRect(0,0,this.progressCanvas.width,this.progressCanvas.height),this.progressContext.beginPath(),this.progressContext.arc(t,i,n,r,s,!1),this.progressContext.stroke(),this.progressContext.closePath()
}}};return t}),define("plex/chromecast/views/CircleProgressBarView",["tpl!templates/chromecast/CircleProgressBarView.tpl","backbone","plex/base/mixins/views/circleProgressBarMixin","plex/chromecast/mixins/viewMixin"],function(e,t,i,n){var r=t.View.extend({mixins:[n,i],template:e});return r}),define("plex/chromecast/views/CastPostPlayView",["tpl!templates/chromecast/CastPostPlayView.tpl","plex/base/mixins/player/postPlayMixin","plex/chromecast/views/CastBaseMediaView","plex/chromecast/views/CircleProgressBarView"],function(e,t,i,n){var r=i.extend({mixins:t,className:"video-post-play",template:e,initialize:function(e){e||(e={}),this.previousItem=e.model;
var t=e.collection.indexOf(this.previousItem)+1;this.nextItem=e.collection.at(t),e.countdown&&this.createCountdown(e.countdown)},onRender:function(){this.progressModel&&this.addChildView(this.ui.countdown,new n({model:this.progressModel}));var e="movie"===this.previousItem.get("type")?"art":"thumb";this.loadImage(this.ui.previousPoster,this.previousItem.get(e),{width:249,height:140}),this.loadImage(this.ui.nextPoster,this.nextItem.get(e),{width:391,height:220});var t=this.nextItem.get("art")||this.nextItem.parent.get("art");
this.loadImage(this.ui.background,t,{width:1280,height:720})}});return r}),define("plex/chromecast/views/CastVideoPlayerView",["tpl!templates/chromecast/CastVideoPlayerView.tpl","underscore","plex/base/utils/dispatcher","plex/base/utils/playerUtil","plex/base/utils/mediaUtil","plex/base/utils/posterPlaceholders","plex/base/utils/formatters/dateTimeUtil","plex/base/utils/formatters/tagUtil","plex/base/utils/types/extraTypes","plex/chromecast/utils/mediaElementPool","plex/chromecast/adapters/player/CastVideoPlayerController","plex/chromecast/models/castAppModel","plex/base/models/Player/PlayerModel","plex/chromecast/views/CastBasePlayerView","plex/chromecast/views/CastPostPlayView"],function(e,t,i,n,r,s,a,o,l,u,c,d,h,p,f){var m=p.extend({id:"video",className:"container",template:e,seekControlsDelay:2e3,pauseControlsDelay:5e3,postPlayDuration:15,awakeTime:72e5,maximumDurationForAutoadvance:12e5,minimumDurationForPostPlay:3e5,ui:{controls:".video-controls",background:".video-background",postPlay:".post-play",poster:".media-poster",contentRating:".player-content-rating",position:".player-position",duration:".player-duration",sliderTrack:".player-slider-track",sliderProgress:".player-slider-progress"},initialize:function(e){t.bindAll(this,"hideSeekControls"),this.options=e,this.playerModel=new h({item:this.model,playQueue:e.playQueue}),this.controller=new c,this.startSleepProtection(),this.listenTo(this.playerModel,{"change:item":this.onPlayerItemChange,"change:state":this.onPlayerStateChange,seeking:this.onPlayerSeeking,"change:finished":this.onPlayerFinishedChange,"change:duration":this.onPlayerDurationChange,"change:position":this.onPlayerPositionChange}),this.listenTo(this.controller,{manual:this.startSleepProtection})
},serializeData:function(){var e=this.model.attributes,t={title:"",year:"",rating:"",episodeTitle:"",episodeIndex:"",secondaryTitle:"",runtime:"",genre:"",genreDisplay:""};if(t.title=e.grandparentTitle||e.title,t.year=e.year,e.grandparentTitle&&(t.secondaryTitle=e.title),e.rating&&(t.rating=this.getStarRating(e.rating)),"episode"===e.type){var i=r.getSeasonEpisodeIndex({seasonPrefix:"Season {1}",seasonIndex:e.parentIndex,episodePrefix:", Episode {1}",episodeIndex:e.index,date:e.originallyAvailableAt,noLeadingZero:!0});
t.episodeTitle=e.title,t.episodeIndex=i}else e.duration&&(t.runtime=a.formatHoursMinutes(e.duration)),e.Genre.length?t.genre=o.truncateTagList({tags:e.Genre,maxLen:50,maxTags:2}):t.genreDisplay="hidden";return t},loadImages:function(){var e=this.model.get("grandparentThumb")||this.model.get("thumb");this.loadImage(this.ui.background,this.model.get("art"),{width:1280,height:720}),this.loadMediaFlag(this.ui.contentRating,{modelAttribute:"contentRating",width:70,height:30});var i=this.loadImage(this.ui.poster,e,{placeholderClass:s.movie,width:200,height:300,minSize:!0});
i.always(t.bind(function(){this.ui.controls.removeClass("transition-out")},this))},hideSeekControls:function(){this.seeking=!1;var e=this.playerModel.get("state");(e===n.states.PLAYING||e===n.states.STOPPED)&&this.ui.controls.addClass("transition-out")},hideControls:function(e){this.hideControlsTimeout=setTimeout(t.bind(function(){this.ui.controls.addClass("transition-out")},this),e)},addPostPlayView:function(){var e={model:this.model,collection:this.playerModel.get("playQueue").get("collection")},i=this.model.get("duration")<this.maximumDurationForAutoadvance;
(!this.isPotentiallyAsleep||this.isDefinitelyAwake||i)&&(e.countdown=this.postPlayDuration),this.postPlayView=new f(e),this.addChildView(this.ui.postPlay,this.postPlayView),this.listenTo(this.postPlayView,"next",t.bind(function(){this.controller.skipNext({autoadvance:!0})},this))},removePostPlayView:function(){this.postPlayView&&(this.removeChildView(this.postPlayView),this.postPlayView=null)},startSleepProtection:function(){clearTimeout(this.sleepTimeout),this.isDefinitelyAwake||(this.isPotentiallyAsleep?this.isDefinitelyAwake=!0:this.sleepTimeout=setTimeout(t.bind(this.onSleep,this),this.awakeTime))
},onRender:function(){this.videoEl=u.createElement("video"),this.ui.background.after(this.videoEl),i.trigger("change:mediaElement",this.videoEl),this.controller.load(t.extend(this.options,{model:this.playerModel,mediaElement:this.videoEl,fallbackServer:d.get("primaryServer"),postplay:!0})),this.$el.addClass("waiting"),this.loadImages()},onPlayerItemChange:function(e,t){this.model=t,this.render(),this.ui.background.after(this.videoEl),this.loadImages()},onPlayerStateChange:function(e,r){return r===n.states.ERROR?void t.defer(function(){i.trigger("navigate","error",{error:e.get("errorMessage")})
}):(this.removePostPlayView(),this.trigger("change:paused",r===n.states.PAUSED),this.$el.removeClass(e.previous("state")),this.$el.addClass(r),r!==n.states.BUFFERING&&this.$el.removeClass("waiting "+n.states.BUFFERING),this.ui.controls.toggleClass("paused",e.get("paused")),void(r===n.states.PLAYING||r===n.states.PAUSED?(clearTimeout(this.hideControlsTimeout),this.ui.controls.removeClass("transition-out"),this.hideControls(r===n.states.PLAYING?this.seekControlsDelay:this.pauseControlsDelay)):this.ui.controls.removeClass("transition-out")))
},onPlayerSeeking:function(e){e.get("paused")||(this.ui.controls.removeClass("transition-out"),this.$el.addClass(n.states.BUFFERING),clearTimeout(this.seekControlsTimeout),this.seekControlsTimeout=setTimeout(this.hideSeekControls,this.seekControlsDelay))},onPlayerFinishedChange:function(e,t){if(t){var n=this.model.get("duration")<this.minimumDurationForPostPlay,r=this.model.get("extraType")===l.getExtraTypeByString("trailer").id,s=this.options.playQueue&&this.options.playQueue.get("collection");s&&this.model!==s.last()?n||r?this.controller.skipNext():this.addPostPlayView():i.trigger("navigate","waiting")
}},onPlayerDurationChange:function(e,t){this.ui.duration.text(a.formatDuration(t))},onPlayerPositionChange:function(e,t){var i=this.playerModel.get("duration");this.ui.position.text(a.formatDuration(t));var n=this.ui.sliderTrack.width(),r=t/i*n;r=Math.min(Math.max(r,0),n),this.ui.sliderProgress.attr("style","width: "+Math.round(r)+"px")},onSleep:function(){this.isPotentiallyAsleep=!0},onClose:function(){p.prototype.onClose.apply(this,arguments),this.sleepTimeout=clearTimeout(this.sleepTimeout)}});
return m}),define("tpl!templates/chromecast/CastErrorView.tpl",function(){return function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<img class="chevron" src="img/chromecast/chevron-orange.svg">\n<h1>unable to cast</h1>\n<h2 class="text-muted">'+(null==(__t=message)?"":__t)+"</h2>\n";return __p}}),define("plex/chromecast/views/CastErrorView",["tpl!templates/chromecast/CastErrorView.tpl","underscore","backbone","plex/chromecast/mixins/viewMixin"],function(e,t,i,n){var r=i.View.extend({mixins:[n],id:"error",className:"message-container",template:e,passive:!0,initialize:function(e){var i=e.error||{};
if(t.isString(i))return void(this.message=i);var n="This media is currently unavailable.";if(t.isArray(i)&&i.length){var r=i[0];n=r.exists?"Please check the permissions for this file.":"Please check that this file exists and the necessary drive is mounted."}else if("abort"===i.statusText)n="The media server is not responding.";else if(i.status)switch(i.status){case 401:case 403:n="You do not have permission to access this media.";break;case 500:n="The media server responded with an error."}this.message=n
},serializeData:function(){return{message:this.message}}});return r}),define("tpl!templates/chromecast/details/CastAlbumDetailsView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="background bright"></div>\n\n<div class="details-title-container">\n  <h1 class="artist-title"></h1>\n  <h2 class="album-title"></h2>\n  <h3 class="item-year"></h3>\n</div>\n\n<div class="details-metadata-container">\n  <div class="metadata-right pull-right">\n    <div class="item-genre metadata-tags"></div>\n  </div>\n\n  <p class="metadata-labels">\n    <span class="rating-container rating-container-inline">\n      <span class="rating"></span>\n    </span>\n  </p>\n\n  <div class="summary-container"></div>\n\n  <div class="track-list-container details-list-container">\n    <ol class="list media-list track-list show-context">\n    </ol>\n  </div>\n</div>\n\n<div class="details-poster-container">\n  <a class="media-poster-container" href="#">\n    <div class="album-poster item-poster media-poster"></div>\n  </a>\n</div>';
return __p}}),define("plex/base/mixins/details/baseDetailsMixin",["underscore","plex/base/utils/mediaUtil","plex/base/utils/formatters/dateTimeUtil","plex/base/utils/formatters/tagUtil"],function(e,t,i,n){var r={tagsRenderer:n.truncateLinkedTagList,tagsRendererOptions:{},defaultBindings:{".item-title":{modelAttribute:"title"},".item-year":{modelAttribute:"year"},".item-progress":{modelAttribute:"viewOffset",manual:!0,formatter:function(e,t){var i=this.model.get("duration"),n=!(!e||!i);if(n){var r=Math.round(e/i*100);
t.css("width",r+"%")}t.parent().toggleClass("hidden",!n)}},".item-duration":{modelAttribute:"duration",autohide:!0,formatter:function(e){return e?i.formatHoursMinutes(e):0}},".item-unwatched-label":{modelAttribute:"viewCount",modelListeners:["viewCount","viewOffset"],manual:!0,autohide:function(e){if(this.shared&&!this.multiuser)return!1;var t=this.model.get("viewOffset");return!e&&!t}},".item-unavailable-btn":{modelAttribute:"Media",manual:!0,autohide:function(e){var i=t.getMissingParts(e);return!!i.length
}},".item-available-at":{modelAttribute:"originallyAvailableAt",autohide:!0,formatter:function(e){return e?i.formatDate(e):""}},".item-tagline":{modelAttribute:"tagline",autohide:!0},".item-genre":{modelAttribute:"Genre",autohide:!0,isHtml:!0,formatter:function(t){if(!t||!t.length)return"";var i=this.tagsRenderer(e.extend({},this.tagsRendererOptions,{model:this.model,key:"genre",tags:t,maxLen:50,maxTags:2}));return i}},".item-director":{modelAttribute:"Director",manual:!0,autohide:!0,formatter:function(t,i){if(!t||!t.length)return"";
var n=this.tagsRenderer(e.extend({},this.tagsRendererOptions,{model:this.model,key:"director",tags:t,maxLen:50,maxTags:3}));return i.find(".metadata-tag-list").html(n),n}},".item-writer":{modelAttribute:"Writer",manual:!0,autohide:!0,formatter:function(t,i){if(!t||!t.length)return"";var n=this.tagsRenderer(e.extend({},this.tagsRendererOptions,{model:this.model,key:"writer",tags:t,maxLen:50,maxTags:3}));return i.find(".metadata-tag-list").html(n),n}},".item-cast":{modelAttribute:"Role",manual:!0,autohide:!0,formatter:function(t,i){if(!t||!t.length)return"";
var n=this.tagsRenderer(e.extend({},this.tagsRendererOptions,{model:this.model,key:"actor",tags:t,maxLen:50,maxTags:5}));return i.find(".metadata-tag-list").html(n),n}},".item-summary":{modelAttribute:"summary",autohide:!0},".item-content-rating":{modelAttribute:"contentRating",autohide:!0},".media-count-badge":{modelAttribute:"Media",formatter:function(e){return e.length},autohide:function(e){return e>1}},".unwatched-count-badge":{modelAttribute:"unviewedLeafCount",autohide:function(e){return this.shared&&!this.multiuser?!1:!!e
}},".content-rating-flag-container":{modelAttribute:"contentRating",manual:!0,autohide:!0},".studio-flag-container":{modelAttribute:"studio",manual:!0,autohide:!0}}};return r}),define("plex/base/mixins/details/albumDetailsMixin",["underscore","plex/base/mixins/details/baseDetailsMixin"],function(e,t){var i={bindings:e.extend({".artist-title":{modelAttribute:"parentTitle"},".album-title":{modelAttribute:"title"}},e.pick(t.defaultBindings,[".item-year",".item-genre"]))};return i}),define("plex/base/utils/formatters/metadataUtil",["underscore","plex/base/utils/t","plex/base/utils/playerQualities"],function(e,t,i){var n={formatBitrate:function(e,t){var i=["bps","kbps","Mbps","Gbps","Tbps"],n=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);
return(e/Math.pow(1024,n)).toFixed(t)+" "+i[n+1]},formatVideoQuality:function(e){var n=e.bitrate,r=e.videoResolution;if(!n&&!r)return t("Unknown");var s=[];if(n){var a=1e3>n||n%1e3===0?0:1;s.push(this.formatBitrate(n,a))}if(r&&(!n||n>=1e3)){var o=i.getResolutionFromSize(r);s.push(this.formatResolution(o))}return s.join(" ")},formatBytes:function(e){var t=["B","KB","MB","GB","TB"],i=parseInt(Math.floor(Math.log(e)/Math.log(1024)),10);return(e/Math.pow(1024,i)).toFixed(2)+" "+t[i]},formatVideoLevel:function(e){return e=parseInt(e,10),(e/10).toFixed(1)
},formatResolution:function(t){if(!t)return"";if("8k"===t)return"8K";if("4k"===t)return"4K";var i=parseInt(t,10);return e.isNaN(i)?t.toUpperCase():t+"p"},formatAudioCodec:function(e){return e?"dca"===e?"DTS":e.toUpperCase():""},formatAudioChannels:function(e){return e=parseInt(e,10),e?2>e?t("Mono"):3>e?t("Stereo"):(e-1).toString()+".1":""},formatStreamLanguage:function(e,i){if(!i)return t("None");var n=i.language||t("Unknown");return"subtitles"===e?i.codec&&(n+=" ("+i.codec.toUpperCase(),i.forced&&(n+=" "+t("Forced")),n+=")"):"audio"===e&&i.codec&&(n+=" ("+this.formatAudioCodec(i.codec),i.channels&&(n+=" "+this.formatAudioChannels(i.channels)),n+=")"),n
}};return n});var Handlebars=function(){var e=function(){function e(e){this.string=e}var t;return e.prototype.toString=function(){return""+this.string},t=e}(),t=function(e){function t(e){return o[e]||"&amp;"}function i(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}function n(e){return e instanceof a?e.toString():e||0===e?(e=""+e,u.test(e)?e.replace(l,t):e):""}function r(e){return e||0===e?h(e)&&0===e.length?!0:!1:!0}var s={},a=e,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,u=/[&<>"'`]/;
s.extend=i;var c=Object.prototype.toString;s.toString=c;var d=function(e){return"function"==typeof e};d(/x/)&&(d=function(e){return"function"==typeof e&&"[object Function]"===c.call(e)});var d;s.isFunction=d;var h=Array.isArray||function(e){return e&&"object"==typeof e?"[object Array]"===c.call(e):!1};return s.isArray=h,s.escapeExpression=n,s.isEmpty=r,s}(e),i=function(){function e(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<i.length;t++)this[i[t]]=e[i[t]]}var t,i=["description","fileName","lineNumber","message","name","number","stack"];
return e.prototype=new Error,t=e}(),n=function(e,t){function i(e,t){this.helpers=e||{},this.partials=t||{},n(this)}function n(e){e.registerHelper("helperMissing",function(e){if(2===arguments.length)return void 0;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,i){var n=i.inverse||function(){},r=i.fn;return h(t)&&(t=t.call(this)),t===!0?r(this):t===!1||null==t?n(this):d(t)?t.length>0?e.helpers.each(t,i):n(this):r(t)}),e.registerHelper("each",function(e,t){var i,n=t.fn,r=t.inverse,s=0,a="";
if(h(e)&&(e=e.call(this)),t.data&&(i=g(t.data)),e&&"object"==typeof e)if(d(e))for(var o=e.length;o>s;s++)i&&(i.index=s,i.first=0===s,i.last=s===e.length-1),a+=n(e[s],{data:i});else for(var l in e)e.hasOwnProperty(l)&&(i&&(i.key=l),a+=n(e[l],{data:i}),s++);return 0===s&&(a=r(this)),a}),e.registerHelper("if",function(e,t){return h(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||a.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn,hash:i.hash})
}),e.registerHelper("with",function(e,t){return h(e)&&(e=e.call(this)),a.isEmpty(e)?void 0:t.fn(e)}),e.registerHelper("log",function(t,i){var n=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;e.log(n,t)})}function r(e,t){m.log(e,t)}var s={},a=e,o=t,l="1.1.2";s.VERSION=l;var u=4;s.COMPILER_REVISION=u;var c={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};s.REVISION_CHANGES=c;var d=a.isArray,h=a.isFunction,p=a.toString,f="[object Object]";s.HandlebarsEnvironment=i,i.prototype={constructor:i,logger:m,log:r,registerHelper:function(e,t,i){if(p.call(e)===f){if(i||t)throw new o("Arg not supported with multiple helpers");
a.extend(this.helpers,e)}else i&&(t.not=i),this.helpers[e]=t},registerPartial:function(e,t){p.call(e)===f?a.extend(this.partials,e):this.partials[e]=t}};var m={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(m.level<=e){var i=m.methodMap[e];"undefined"!=typeof console&&console[i]&&console[i].call(console,t)}}};s.logger=m,s.log=r;var g=function(e){var t={};return a.extend(t,e),t};return s.createFrame=g,s}(t,i),r=function(e,t,i){function n(e){var t=e&&e[0]||1,i=h;
if(t!==i){if(i>t){var n=p[i],r=p[t];throw new Error("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+r+").")}throw new Error("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function r(e,t){if(!t)throw new Error("No environment passed to template");var i;i=t.compile?function(e,i,n,r,s,a){var l=o.apply(this,arguments);
if(l)return l;var u={helpers:r,partials:s,data:a};return s[i]=t.compile(e,{data:void 0!==a},t),s[i](n,u)}:function(e,t){var i=o.apply(this,arguments);if(i)return i;throw new d("The partial "+t+" could not be compiled when running in runtime-only mode")};var r={escapeExpression:c.escapeExpression,invokePartial:i,programs:[],program:function(e,t,i){var n=this.programs[e];return i?n=a(e,t,i):n||(n=this.programs[e]=a(e,t)),n},merge:function(e,t){var i=e||t;return e&&t&&e!==t&&(i={},c.extend(i,t),c.extend(i,e)),i
},programWithDepth:s,noop:l,compilerInfo:null};return function(i,s){s=s||{};var a,o,l=s.partial?s:t;s.partial||(a=s.helpers,o=s.partials);var u=e.call(r,l,i,a,o,s.data);return s.partial||n(r.compilerInfo),u}}function s(e,t,i){var n=Array.prototype.slice.call(arguments,3),r=function(e,r){return r=r||{},t.apply(this,[e,r.data||i].concat(n))};return r.program=e,r.depth=n.length,r}function a(e,t,i){var n=function(e,n){return n=n||{},t(e,n.data||i)};return n.program=e,n.depth=0,n}function o(e,t,i,n,r,s){var a={partial:!0,helpers:n,partials:r,data:s};
if(void 0===e)throw new d("The partial "+t+" could not be found");return e instanceof Function?e(i,a):void 0}function l(){return""}var u={},c=e,d=t,h=i.COMPILER_REVISION,p=i.REVISION_CHANGES;return u.template=r,u.programWithDepth=s,u.program=a,u.invokePartial=o,u.noop=l,u}(t,i,n),s=function(e,t,i,n,r){var s,a=e,o=t,l=i,u=n,c=r,d=function(){var e=new a.HandlebarsEnvironment;return u.extend(e,a),e.SafeString=o,e.Exception=l,e.Utils=u,e.VM=c,e.template=function(t){return c.template(t,e)},e},h=d();return h.create=d,s=h
}(n,e,i,t,r),a=function(e){function t(e,i,n){this.type="program",this.statements=e,this.strip={},n?(this.inverse=new t(n,i),this.strip.right=i.left):i&&(this.strip.left=i.right)}function i(e,t,i,n){this.type="mustache",this.hash=t,this.strip=n;var r=i[3]||i[2];this.escaped="{"!==r&&"&"!==r;var s=this.id=e[0],a=this.params=e.slice(1),o=this.eligibleHelper=s.isSimple;this.isHelper=o&&(a.length||t)}function n(e,t,i){this.type="partial",this.partialName=e,this.context=t,this.strip=i}function r(e,t,i,n){if(e.id.original!==n.path.original)throw new m(e.id.original+" doesn't match "+n.path.original);
this.type="block",this.mustache=e,this.program=t,this.inverse=i,this.strip={left:e.strip.left,right:n.strip.right},(t||i).strip.left=e.strip.right,(i||t).strip.right=n.strip.left,i&&!t&&(this.isInverse=!0)}function s(e){this.type="content",this.string=e}function a(e){this.type="hash",this.pairs=e}function o(e){this.type="ID";for(var t="",i=[],n=0,r=0,s=e.length;s>r;r++){var a=e[r].part;if(t+=(e[r].separator||"")+a,".."===a||"."===a||"this"===a){if(i.length>0)throw new m("Invalid path: "+t);".."===a?n++:this.isScoped=!0
}else i.push(a)}this.original=t,this.parts=i,this.string=i.join("."),this.depth=n,this.isSimple=1===e.length&&!this.isScoped&&0===n,this.stringModeValue=this.string}function l(e){this.type="PARTIAL_NAME",this.name=e.original}function u(e){this.type="DATA",this.id=e}function c(e){this.type="STRING",this.original=this.string=this.stringModeValue=e}function d(e){this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)}function h(e){this.type="BOOLEAN",this.bool=e,this.stringModeValue="true"===e
}function p(e){this.type="comment",this.comment=e}var f={},m=e;return f.ProgramNode=t,f.MustacheNode=i,f.PartialNode=n,f.BlockNode=r,f.ContentNode=s,f.HashNode=a,f.IdNode=o,f.PartialNameNode=l,f.DataNode=u,f.StringNode=c,f.IntegerNode=d,f.BooleanNode=h,f.CommentNode=p,f}(i),o=function(){var e,t=function(){function e(e,t){return{left:"~"===e[2],right:"~"===t[0]||"~"===t[1]}}function t(){this.yy={}}var i={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,inMustache_repetition0:28,inMustache_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,hash:35,hash_repetition_plus0:36,hashSegment:37,ID:38,EQUALS:39,DATA:40,pathSegments:41,SEP:42,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",38:"ID",39:"EQUALS",40:"DATA",42:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[35,1],[37,3],[26,1],[26,1],[26,1],[30,2],[21,1],[41,3],[41,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[36,1],[36,2]],performAction:function(t,i,n,r,s,a){var o=a.length-1;
switch(s){case 1:return new r.ProgramNode(a[o-1]);case 2:return new r.ProgramNode([]);case 3:this.$=new r.ProgramNode([],a[o-1],a[o]);break;case 4:this.$=new r.ProgramNode(a[o-2],a[o-1],a[o]);break;case 5:this.$=new r.ProgramNode(a[o-1],a[o],[]);break;case 6:this.$=new r.ProgramNode(a[o]);break;case 7:this.$=new r.ProgramNode([]);break;case 8:this.$=new r.ProgramNode([]);break;case 9:this.$=[a[o]];break;case 10:a[o-1].push(a[o]),this.$=a[o-1];break;case 11:this.$=new r.BlockNode(a[o-2],a[o-1].inverse,a[o-1],a[o]);
break;case 12:this.$=new r.BlockNode(a[o-2],a[o-1],a[o-1].inverse,a[o]);break;case 13:this.$=a[o];break;case 14:this.$=a[o];break;case 15:this.$=new r.ContentNode(a[o]);break;case 16:this.$=new r.CommentNode(a[o]);break;case 17:this.$=new r.MustacheNode(a[o-1][0],a[o-1][1],a[o-2],e(a[o-2],a[o]));break;case 18:this.$=new r.MustacheNode(a[o-1][0],a[o-1][1],a[o-2],e(a[o-2],a[o]));break;case 19:this.$={path:a[o-1],strip:e(a[o-2],a[o])};break;case 20:this.$=new r.MustacheNode(a[o-1][0],a[o-1][1],a[o-2],e(a[o-2],a[o]));
break;case 21:this.$=new r.MustacheNode(a[o-1][0],a[o-1][1],a[o-2],e(a[o-2],a[o]));break;case 22:this.$=new r.PartialNode(a[o-2],a[o-1],e(a[o-3],a[o]));break;case 23:this.$=e(a[o-1],a[o]);break;case 24:this.$=[[a[o-2]].concat(a[o-1]),a[o]];break;case 25:this.$=[[a[o]],null];break;case 26:this.$=a[o];break;case 27:this.$=new r.StringNode(a[o]);break;case 28:this.$=new r.IntegerNode(a[o]);break;case 29:this.$=new r.BooleanNode(a[o]);break;case 30:this.$=a[o];break;case 31:this.$=new r.HashNode(a[o]);
break;case 32:this.$=[a[o-2],a[o]];break;case 33:this.$=new r.PartialNameNode(a[o]);break;case 34:this.$=new r.PartialNameNode(new r.StringNode(a[o]));break;case 35:this.$=new r.PartialNameNode(new r.IntegerNode(a[o]));break;case 36:this.$=new r.DataNode(a[o]);break;case 37:this.$=new r.IdNode(a[o]);break;case 38:a[o-2].push({part:a[o],separator:a[o-1]}),this.$=a[o-2];break;case 39:this.$=[{part:a[o]}];break;case 42:this.$=[];break;case 43:a[o-1].push(a[o]);break;case 46:this.$=[a[o]];break;case 47:a[o-1].push(a[o])
}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:29,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:30,21:24,30:25,38:[1,28],40:[1,27],41:26},{17:31,21:24,30:25,38:[1,28],40:[1,27],41:26},{21:33,26:32,32:[1,34],33:[1,35],38:[1,28],41:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,38:[1,28],40:[1,27],41:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,42],24:[2,42],28:43,32:[2,42],33:[2,42],34:[2,42],38:[2,42],40:[2,42]},{18:[2,25],24:[2,25]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],38:[2,37],40:[2,37],42:[1,44]},{21:45,38:[1,28],41:26},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],40:[2,39],42:[2,39]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,40],21:50,27:49,38:[1,28],41:26},{18:[2,33],38:[2,33]},{18:[2,34],38:[2,34]},{18:[2,35],38:[2,35]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,38:[1,28],41:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,44],21:56,24:[2,44],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:55,36:61,37:62,38:[1,63],40:[1,27],41:26},{38:[1,64]},{18:[2,36],24:[2,36],32:[2,36],33:[2,36],34:[2,36],38:[2,36],40:[2,36]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,65]},{18:[2,41]},{18:[1,66]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24]},{18:[2,43],24:[2,43],32:[2,43],33:[2,43],34:[2,43],38:[2,43],40:[2,43]},{18:[2,45],24:[2,45]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],38:[2,26],40:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],38:[2,27],40:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],38:[2,28],40:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],38:[2,29],40:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],38:[2,30],40:[2,30]},{18:[2,31],24:[2,31],37:67,38:[1,68]},{18:[2,46],24:[2,46],38:[2,46]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],38:[2,39],39:[1,69],40:[2,39],42:[2,39]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],38:[2,38],40:[2,38],42:[2,38]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{18:[2,47],24:[2,47],38:[2,47]},{39:[1,69]},{21:56,30:60,31:70,32:[1,57],33:[1,58],34:[1,59],38:[1,28],40:[1,27],41:26},{18:[2,32],24:[2,32],38:[2,32]}],defaultActions:{3:[2,2],16:[2,1],50:[2,41]},parseError:function(e){throw new Error(e)
},parse:function(e){function t(){var e;return e=i.lexer.lex()||1,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,n=[0],r=[null],s=[],a=this.table,o="",l=0,u=0,c=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var d=this.lexer.yylloc;s.push(d);var h=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var p,f,m,g,v,y,b,x,w,S={};;){if(m=n[n.length-1],this.defaultActions[m]?g=this.defaultActions[m]:((null===p||"undefined"==typeof p)&&(p=t()),g=a[m]&&a[m][p]),"undefined"==typeof g||!g.length||!g[0]){var _="";
if(!c){w=[];for(y in a[m])this.terminals_[y]&&y>2&&w.push("'"+this.terminals_[y]+"'");_=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+w.join(", ")+", got '"+(this.terminals_[p]||p)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==p?"end of input":"'"+(this.terminals_[p]||p)+"'"),this.parseError(_,{text:this.lexer.match,token:this.terminals_[p]||p,line:this.lexer.yylineno,loc:d,expected:w})}}if(g[0]instanceof Array&&g.length>1)throw new Error("Parse Error: multiple actions possible at state: "+m+", token: "+p);
switch(g[0]){case 1:n.push(p),r.push(this.lexer.yytext),s.push(this.lexer.yylloc),n.push(g[1]),p=null,f?(p=f,f=null):(u=this.lexer.yyleng,o=this.lexer.yytext,l=this.lexer.yylineno,d=this.lexer.yylloc,c>0&&c--);break;case 2:if(b=this.productions_[g[1]][1],S.$=r[r.length-b],S._$={first_line:s[s.length-(b||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(b||1)].first_column,last_column:s[s.length-1].last_column},h&&(S._$.range=[s[s.length-(b||1)].range[0],s[s.length-1].range[1]]),v=this.performAction.call(S,o,u,l,this.yy,g[1],r,s),"undefined"!=typeof v)return v;
b&&(n=n.slice(0,-1*b*2),r=r.slice(0,-1*b),s=s.slice(0,-1*b)),n.push(this.productions_[g[1]][0]),r.push(S.$),s.push(S._$),x=a[n[n.length-2]][n[n.length-1]],n.push(x);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this
},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var n=this.match.split(/(?:\r\n?|\n)/g);
this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===n.length?this.yylloc.first_column:0)+n[n.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this
},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;
this._input||(this.done=!0);var e,t,i,n,r;this._more||(this.yytext="",this.match="");for(var s=this._currentRules(),a=0;a<s.length&&(i=this._input.match(this.rules[s[a]]),!i||t&&!(i[0].length>t[0].length)||(t=i,n=a,this.options.flex));a++);return t?(r=t[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,s[n],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})
},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,i,n){function r(e,i){return t.yytext=t.yytext.substr(e,t.yyleng-i)
}switch(i){case 0:if("\\\\"===t.yytext.slice(-2)?(r(0,1),this.begin("mu")):"\\"===t.yytext.slice(-1)?(r(0,1),this.begin("emu")):this.begin("mu"),t.yytext)return 14;break;case 1:return 14;case 2:return"\\"!==t.yytext.slice(-1)&&this.popState(),"\\"===t.yytext.slice(-1)&&r(0,1),14;case 3:return r(0,4),this.popState(),15;case 4:return 25;case 5:return 16;case 6:return 20;case 7:return 19;case 8:return 19;case 9:return 23;case 10:return 22;case 11:this.popState(),this.begin("com");break;case 12:return r(3,5),this.popState(),15;
case 13:return 22;case 14:return 39;case 15:return 38;case 16:return 38;case 17:return 42;case 18:break;case 19:return this.popState(),24;case 20:return this.popState(),18;case 21:return t.yytext=r(1,2).replace(/\\"/g,'"'),32;case 22:return t.yytext=r(1,2).replace(/\\'/g,"'"),32;case 23:return 40;case 24:return 34;case 25:return 34;case 26:return 33;case 27:return 38;case 28:return t.yytext=r(1,2),38;case 29:return"INVALID";case 30:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s])))/,/^(?:false(?=([~}\s])))/,/^(?:-?[0-9]+(?=([~}\s])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,30],inclusive:!0}},e
}();return i.lexer=n,t.prototype=i,i.Parser=t,new t}();return e=t}(),l=function(e,t){function i(e){return e.constructor===s.ProgramNode?e:(r.yy=s,r.parse(e))}var n={},r=e,s=t;return n.parser=r,n.parse=i,n}(o,a),u=function(e){function t(e){this.value=e}function i(){}var n,r=e.COMPILER_REVISION,s=e.REVISION_CHANGES,a=e.log;i.prototype={nameLookup:function(e,t){var n,r;return 0===e.indexOf("depth")&&(n=!0),r=/^[0-9]+$/.test(t)?e+"["+t+"]":i.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']",n?"("+e+" && "+r+")":r
},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,i,n){this.environment=e,this.options=t||{},a("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!i,this.context=i||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(e,t);
var r,s=e.opcodes;this.i=0;for(var o=s.length;this.i<o;this.i++)r=s[this.i],"DECLARE"===r.opcode?this[r.name]=r.value:this[r.opcode].apply(this,r.args),r.opcode!==this.stripNext&&(this.stripNext=!1);return this.pushSource(""),this.createFunctionContext(n)},preamble:function(){var e=[];if(this.isChild)e.push("");else{var t=this.namespace,i="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(i=i+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(i+=" data = data || {};"),e.push(i)
}e.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(e){var t=this.stackVars.concat(this.registers.list);if(t.length>0&&(this.source[1]=this.source[1]+", "+t.join(", ")),!this.isChild)for(var i in this.context.aliases)this.context.aliases.hasOwnProperty(i)&&(this.source[1]=this.source[1]+", "+i+"="+this.context.aliases[i]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");
for(var n=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],o=0,l=this.environment.depths.list.length;l>o;o++)n.push("depth"+this.environment.depths.list[o]);var u=this.mergeSource();if(!this.isChild){var c=r,d=s[c];u="this.compilerInfo = ["+c+",'"+d+"'];\n"+u}if(e)return n.push(u),Function.apply(this,n);var h="function "+(this.name||"")+"("+n.join(",")+") {\n  "+u+"}";return a("debug",h+"\n\n"),h},mergeSource:function(){for(var e,t="",i=0,n=this.source.length;n>i;i++){var r=this.source[i];
r.appendToBuffer?e=e?e+"\n    + "+r.content:r.content:(e&&(t+="buffer += "+e+";\n  ",e=void 0),t+=r+"\n  ")}return t},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();
e.splice(1,0,t),e[e.length-1]="options",this.pushSource("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.pendingContent&&(e=this.pendingContent+e),this.stripNext&&(e=e.replace(/^\s+/,"")),this.pendingContent=e},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var e=this.popStack();this.pushSource("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")
},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e
})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(){this.push("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),"string"==typeof e?this.pushString(e):this.pushStackLiteral(e)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}
},popHash:function(){var e=this.hash;this.hash=void 0,this.options.stringParams&&(this.register("hashContexts","{"+e.contexts.join(",")+"}"),this.register("hashTypes","{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){this.pushStackLiteral(null!=e?this.programExpression(e):null)
},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(e,t,!0),n=this.nameLookup("depth"+this.lastContext,t,"context");this.push(i.name+" || "+n),this.replaceStack(function(e){return e+" ? "+e+".call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+")"})},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");
var i=this.setupHelper(0,e,t),n=this.lastHelper=this.nameLookup("helpers",e,"helper"),r=this.nameLookup("depth"+this.lastContext,e,"context"),s=this.nextStack();this.pushSource("if ("+s+" = "+n+") { "+s+" = "+s+".call("+i.callParams+"); }"),this.pushSource("else { "+s+" = "+r+"; "+s+" = typeof "+s+" === functionType ? "+s+".call("+i.callParams+") : "+s+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")
},assignToHash:function(e){var t,i,n=this.popStack();this.options.stringParams&&(i=this.popStack(),t=this.popStack());var r=this.hash;t&&r.contexts.push("'"+e+"': "+t),i&&r.types.push("'"+e+"': "+i),r.values.push("'"+e+"': ("+n+")")},compiler:i,compileChildren:function(e,t){for(var i,n,r=e.children,s=0,a=r.length;a>s;s++){i=r[s],n=new this.compiler;var o=this.matchExistingProgram(i);null==o?(this.context.programs.push(""),o=this.context.programs.length,i.index=o,i.name="program"+o,this.context.programs[o]=n.compile(i,t,this.context),this.context.environments[o]=i):(i.index=o,i.name="program"+o)
}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;i>t;t++){var n=this.context.environments[t];if(n&&n.equals(e))return t}},programExpression:function(e){if(this.context.aliases.self="this",null==e)return"self.noop";for(var t,i=this.environment.children[e],n=i.depths.list,r=[i.index,i.name,"data"],s=0,a=n.length;a>s;s++)t=n[s],r.push(1===t?"depth0":"depth"+(t-1));return(0===n.length?"self.program(":"self.programWithDepth(")+r.join(", ")+")"},register:function(e,t){this.useRegister(e),this.pushSource(e+" = "+t+";")
},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new t(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),e&&this.source.push(e)},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.pushSource(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var i,n="",r=this.isInline();
if(r){var s=this.popStack(!0);if(s instanceof t)i=s.value;else{var a=this.stackSlot?this.topStackName():this.incrStack();n="("+this.push(a)+" = "+s+"),",i=this.topStack()}}else i=this.topStack();var o=e.call(this,i);return r?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+n+o+")")):(/^stack/.test(i)||(i=this.nextStack()),this.pushSource(i+" = ("+n+o+");")),i},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()
},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var i=0,n=e.length;n>i;i++){var r=e[i];r instanceof t?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var i=this.isInline(),n=(i?this.inlineStack:this.compileStack).pop();return!e&&n instanceof t?n.value:(i||this.stackSlot--,n)},topStack:function(e){var i=this.isInline()?this.inlineStack:this.compileStack,n=i[i.length-1];
return!e&&n instanceof t?n.value:n},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,i){var n=[];this.setupParams(e,n,i);var r=this.nameLookup("helpers",t,"helper");return{params:n,name:r,callParams:["depth0"].concat(n).join(", "),helperMissingParams:i&&["depth0",this.quotedString(t)].concat(n).join(", ")}},setupParams:function(e,t,i){var n,r,s,a=[],o=[],l=[];
a.push("hash:"+this.popStack()),r=this.popStack(),s=this.popStack(),(s||r)&&(s||(this.context.aliases.self="this",s="self.noop"),r||(this.context.aliases.self="this",r="self.noop"),a.push("inverse:"+r),a.push("fn:"+s));for(var u=0;e>u;u++)n=this.popStack(),t.push(n),this.options.stringParams&&(l.push(this.popStack()),o.push(this.popStack()));return this.options.stringParams&&(a.push("contexts:["+o.join(",")+"]"),a.push("types:["+l.join(",")+"]"),a.push("hashContexts:hashContexts"),a.push("hashTypes:hashTypes")),this.options.data&&a.push("data:data"),a="{"+a.join(",")+"}",i?(this.register("options",a),t.push("options")):t.push(a),t.join(", ")
}};for(var o="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),l=i.RESERVED_WORDS={},u=0,c=o.length;c>u;u++)l[o[u]]=!0;return i.isValidJavaScriptVariableName=function(e){return!i.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1
},n=i}(n),c=function(e,t,i,n){function r(){}function s(e,t){if(null==e||"string"!=typeof e&&e.constructor!==d.ProgramNode)throw new l("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var i=u(e),n=(new r).compile(i,t);return(new c).compile(n,t)}function a(e,t,i){function n(){var n=u(e),s=(new r).compile(n,t),a=(new c).compile(s,t,void 0,!0);return i.template(a)}if(null==e||"string"!=typeof e&&e.constructor!==d.ProgramNode)throw new l("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);
t=t||{},"data"in t||(t.data=!0);var s;return function(e,t){return s||(s=n()),s.call(this,e,t)}}var o={},l=e,u=t.parse,c=i,d=n;return o.Compiler=r,r.prototype={compiler:r,disassemble:function(){for(var e,t,i,n=this.opcodes,r=[],s=0,a=n.length;a>s;s++)if(e=n[s],"DECLARE"===e.opcode)r.push("DECLARE "+e.name+"="+e.value);else{t=[];for(var o=0;o<e.args.length;o++)i=e.args[o],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),t.push(i);r.push(e.opcode+" "+t.join(" "))}return r.join("\n")},equals:function(e){var t=this.opcodes.length;
if(e.opcodes.length!==t)return!1;for(var i=0;t>i;i++){var n=this.opcodes[i],r=e.opcodes[i];if(n.opcode!==r.opcode||n.args.length!==r.args.length)return!1;for(var s=0;s<n.args.length;s++)if(n.args[s]!==r.args[s])return!1}if(t=this.children.length,e.children.length!==t)return!1;for(i=0;t>i;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=t;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];
return this.accept(e)},accept:function(e){var t,i=e.strip||{};return i.left&&this.opcode("strip"),t=this[e.type](e),i.right&&this.opcode("strip"),t},program:function(e){for(var t=e.statements,i=0,n=t.length;n>i;i++)this.accept(t[i]);return this.isSimple=1===n,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,i=(new this.compiler).compile(e,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var r=0,s=i.depths.list.length;s>r;r++)t=i.depths.list[r],2>t||this.addDepth(t-1);
return n},block:function(e){var t=e.mustache,i=e.program,n=e.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var r=this.classifyMustache(t);"helper"===r?this.helperMustache(t,i,n):"simple"===r?(this.simpleMustache(t),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(t,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")
},hash:function(e){var t,i,n=e.pairs;this.opcode("pushHash");for(var r=0,s=n.length;s>r;r++)t=n[r],i=t[1],this.options.stringParams?(i.depth&&this.addDepth(i.depth),this.opcode("getContext",i.depth||0),this.opcode("pushStringParam",i.stringModeValue,i.type)):this.accept(i),this.opcode("assignToHash",t[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")
},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,i=this.classifyMustache(e);"simple"===i?this.simpleMustache(e):"helper"===i?this.helperMustache(e):this.ambiguousMustache(e),this.opcode(e.escaped&&!t.noEscape?"appendEscaped":"append")},ambiguousMustache:function(e,t,i){var n=e.id,r=n.parts[0],s=null!=t||null!=i;this.opcode("getContext",n.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",r,s)},simpleMustache:function(e){var t=e.id;
"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,i){var n=this.setupFullMustacheParams(e,t,i),r=e.id.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",n.length,r);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+r);this.opcode("invokeHelper",n.length,r)
}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var i=1,n=e.parts.length;n>i;i++)this.opcode("lookup",e.parts[i])},DATA:function(e){if(this.options.data=!0,e.id.isScoped||e.id.depth)throw new l("Scoped data references are not supported: "+e.original);this.opcode("lookupData");for(var t=e.id.parts,i=0,n=t.length;n>i;i++)this.opcode("lookup",t[i])},STRING:function(e){this.opcode("pushString",e.string)
},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifyMustache:function(e){var t=e.isHelper,i=e.eligibleHelper,n=this.options;
if(i&&!t){var r=e.id.parts[0];n.knownHelpers[r]?t=!0:n.knownHelpersOnly&&(i=!1)}return t?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t,i=e.length;i--;)t=e[i],this.options.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.stringModeValue,t.type)):this[t.type](t)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("emptyHash"),t},setupFullMustacheParams:function(e,t,i){var n=e.params;
return this.pushParams(n),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.hash(e.hash):this.opcode("emptyHash"),n}},o.precompile=s,o.compile=a,o}(i,l,u,a),d=function(e,t,i,n,r){var s,a=e,o=t,l=i.parser,u=i.parse,c=n.Compiler,d=n.compile,h=n.precompile,p=r,f=a.create,m=function(){var e=f();return e.compile=function(t,i){return d(t,i,e)},e.precompile=h,e.AST=o,e.Compiler=c,e.JavaScriptCompiler=p,e.Parser=l,e.parse=u,e};return a=m(),a.create=m,s=a}(s,a,l,c,u);return d}();define("handlebars-lib",function(e){return function(){var t;
return t||e.Handlebars}}(this)),define("handlebars",["underscore","handlebars-lib","plex/base/utils/t","plex/base/utils/formatters/stringUtil","plex/base/utils/formatters/dateTimeUtil","plex/base/utils/formatters/metadataUtil"],function(e,t,i,n,r,s){t.registerHelper("if_eq",function(e,t,i){return e==t?i.fn(this):i.inverse(this)}),t.registerHelper("if_neq",function(e,t,i){return e!=t?i.fn(this):i.inverse(this)}),t.registerHelper("t",function(){var n=e.initial(arguments).concat({escape:!0});return new t.SafeString(i.apply(i,n))
}),t.registerHelper("csl",function(e){return e.join(", ")}),t.registerHelper("encodeUrl",function(e){return encodeURIComponent(e||"")}),t.registerHelper("tags",function(t){return e.pluck(t,"tag").join(",")}),t.registerHelper("json",function(e,t){return void 0===t&&(t=2),JSON.stringify(e,null,t)});var a=[{util:n,helpers:["truncate","truncateMiddle","formatLabel","formatBoolean","upperCase","getLastSegment","shortFilename"]},{util:s,helpers:["formatBitrate","formatVideoQuality","formatBytes","formatVideoLevel","formatResolution","formatAudioCodec","formatAudioChannels","formatStreamLanguage"]},{util:r,helpers:["formatDate","formatTimestamp","formatDuration","formatTimeAgo"]}];
return e.each(a,function(i){e.each(i.helpers,function(n){t.registerHelper(n,function(){return i.util[n].apply(i.util,e.initial(arguments))})})}),t.registerHelper("partial",function(i,n){var r=t.partials[i],s=n.hash.context?e.extend({},n.hash.context,n.hash):e.extend({},this,n.hash);return new t.SafeString(r(s))}),t}),define("hb",["underscore","handlebars-lib","text"],function(e,t,i){var n={},r=function(r,s,a,o){if(o.isBuild&&"undefined"!=typeof process&&process.versions&&process.versions.node){var l=require.nodeRequire("fs"),u=e.chain(o.templatePathPrefixs).map(function(e){return e+r+".tpl"
}).filter(function(e){return l.existsSync(e)}).map(function(e){return l.readFileSync(e,"utf8")}).first().value(),c=t.precompile(u);n[r]=c,a(c)}else i.get(s.toUrl(r+".tpl"),function(e){var i=t.compile(e);a(i)})},s=function(e,t,i){if(t in n){var r=n[t];i('define("'+e+"!"+t+'", ["handlebars"], function (Handlebars){return Handlebars.template('+r+");});\n")}},a=function(e,t){return".tpl"==e.substr(e.length-4,4)&&(e=e.substr(0,e.length-4)),t(e)};return{load:r,write:s,normalize:a}}),define("hb!templates/chromecast/details/components/SummaryView",["handlebars"],function(e){return e.template(function(e,t,i,n,r){return this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,e.helpers),r=r||{},'<p class="item-summary metadata-summary"></p>\n'
})}),define("plex/base/utils/styleSheetsUtil",["underscore"],function(e){var t={findCSSRule:function(t){for(var i=document.styleSheets,n=0;n<i.length;n++){var r=e.findWhere(i[n].cssRules,t);if(r)return r}return null},findWebkitKeyframesRule:function(e){return this.findCSSRule({name:e,type:window.CSSRule.WEBKIT_KEYFRAMES_RULE})},findCSSSelectorRule:function(e){return this.findCSSRule({selectorText:e,type:window.CSSRule.STYLE_RULE})},deleteWebkitKeyframesCSSRules:function(t){if(t&&t.type===window.CSSRule.WEBKIT_KEYFRAMES_RULE){var i=e.pluck(t.cssRules,"keyText");
e.each(i,function(e){t.deleteRule(e)})}}};return t}),define("plex/chromecast/mixins/ViewMixin",["underscore","jquery"],function(e,t){var i={serializeData:function(){return this.model?this.model.toJSON():{}},render:function(){return this.template?this.$el.html(this.template(this.serializeData())):this.$el.empty(),this.bindUIElements(),this.bindToModel(),this.isRendered=!0,this},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var t=e.result(this,"_uiBindings");this.ui={},e.each(e.keys(t),function(e){this.ui[e]=this.$(t[e])
},this)}},onRender:function(){},close:function(){this.childViews&&(e.each(this.childViews,function(e){e.close()}),this.childViews.length=0),this.pendingDeferreds&&e.each(this.pendingDeferreds,function(e){e.reject()}),this.stopListening(),this.onClose()},onClose:function(){},addChildView:function(e,t){this.childViews||(this.childViews=[]),this.childViews.push(t),e.append(t.render().el),t.onRender()},removeChildView:function(t){this.stopListening(t),t.close(),t.$el.remove(),this.childViews=e(this.childViews).without(t)
},preloadImage:function(i){var n=t.Deferred(),r=new Image;return this.pendingDeferreds||(this.pendingDeferreds=[]),this.pendingDeferreds.push(n),r.onload=e.bind(function(){r.onload=r.onabort=r.onerror=null,n.resolve(i),this.pendingDeferreds=e(this.pendingDeferreds).without(n)},this),r.onabort=r.onerror=e.bind(function(){r.onload=r.onabort=r.onerror=null,n.reject(),this.pendingDeferreds=e(this.pendingDeferreds).without(n)},this),r.src=i,n.promise()}};return i}),define("plex/chromecast/views/details/components/SummaryView",["hb!templates/chromecast/details/components/SummaryView","underscore","backbone","plex/base/utils/styleSheetsUtil","plex/chromecast/mixins/ViewMixin"],function(e,t,i,n,r){var s=i.View.extend({mixins:[r],className:"summary-wrapper",template:e,animationTimePerLine:3500,initialState:"scroll",states:{scroll:{to:"fadeOut",enter:function(){this.ui.summary.css({"-webkit-animation":"scroll-to-top","-webkit-animation-delay":this.readDelay+"ms","-webkit-animation-duration":this.animationTime+"ms","-webkit-animation-timing-function":"linear","-webkit-animation-fill-mode":"forwards"})
}},fadeOut:{to:"fadeIn",enter:function(){this.ui.summary.css({top:-1*this.scrollToHeight,"-webkit-animation":"fade-out","-webkit-animation-delay":this.readDelay+"ms","-webkit-animation-duration":"1s","-webkit-animation-timing-function":"linear","-webkit-animation-fill-mode":"forwards"})}},fadeIn:{to:"scroll",enter:function(){this.ui.summary.css({top:0,"-webkit-animation":"fade-in","-webkit-animation-delay":"0s","-webkit-animation-duration":"1s","-webkit-animation-timing-function":"linear","-webkit-animation-fill-mode":"forwards"})
}}},ui:{summary:".item-summary"},events:{"webkitAnimationEnd .item-summary":"onAnimationEnd"},bindings:{".item-summary":{modelAttribute:"summary",autohide:!0}},nextState:function(){this.currentState=this.currentState?this.states[this.currentState].to:this.initialState,this.states[this.currentState].enter.call(this)},onRender:function(){t.defer(t.bind(function(){var e=this.$el.prop("clientHeight"),t=this.ui.summary.prop("clientHeight");if(t>e){var i=parseInt(this.ui.summary.css("line-height"),10),r=e/i,s=t/i;
this.readDelay=r/2*this.animationTimePerLine,this.animationTime=(s-r)*this.animationTimePerLine,this.scrollToHeight=t-e;var a=n.findWebkitKeyframesRule("scroll-to-top");n.deleteWebkitKeyframesCSSRules(a),a.insertRule("100% { -webkit-transform: translateY(-"+this.scrollToHeight+"px); }"),this.nextState()}},this))},onAnimationEnd:function(){this.nextState()}});return s}),define("plex/chromecast/views/details/CastBaseDetailsView",["underscore","plex/base/utils/mediaUtil","plex/base/utils/posterPlaceholders","plex/base/utils/types/streamTypes","plex/base/utils/formatters/metadataUtil","plex/base/mixins/details/baseDetailsMixin","plex/chromecast/views/CastBaseMediaView","plex/chromecast/views/details/components/SummaryView"],function(e,t,i,n,r,s,a,o){var l=a.extend({mixins:s,id:"details",passive:!0,ui:{background:".background",poster:".media-poster",rating:".rating",summary:".summary-container"},render:function(){a.prototype.render.apply(this,arguments);
var t=this.model.get("children");t&&this.childView&&t.populate().done(e.bind(this.addChildrenContent,this));var i=new o({model:this.model});return this.addChildView(this.ui.summary,i),this},addChildrenContent:function(t){e.each(t.models,e.bind(function(e){var t=new this.childView({model:e});this.addChildView(this.ui.children,t)},this))},loadImages:function(){var e=this.ui.poster;this.loadImage(this.ui.background,this.model.get("art"),{width:1280,height:720}),this.loadImage(e,this.model.get("thumb"),{placeholderClass:i[this.model.get("type")],width:e.width(),height:e.height(),minSize:!0}),this.ui.rating.append(this.getStarRating())
},getStreamString:function(i){var s=e.first(this.model.get("Media")),a=n.getStreamTypeByString(i),o=e.first(t.getStreams(s,{streamType:a.id,selected:!0}));if(!o)return"Unknown";var l=o.language||"Unknown",u=[];"subtitles"===i&&(o.format&&u.push(o.format.toUpperCase()),o.forced&&u.push("Forced")),"audio"===i&&(o.codec&&u.push(r.formatAudioCodec(o.codec)),o.channels&&u.push(r.formatAudioChannels(o.channels)));var c=u.length?" ("+u.join(" ")+")":"";return l+c}});return l}),define("tpl!templates/chromecast/items/TrackView.tpl",function(){return function(obj){{var __p="";
Array.prototype.join}with(obj||{})__p+='<a class="track-list-inner-item">\n  <span class="media-index media-heading secondary"></span>\n  <span class="media-title media-heading"></span>\n  <span class="media-subtitle-1 media-heading secondary"></span>\n  <span class="media-context media-heading secondary"></span>\n</a>\n';return __p}}),define("plex/chromecast/views/items/TrackView",["tpl!templates/chromecast/items/TrackView.tpl","plex/chromecast/views/CastBaseMediaView","plex/base/utils/formatters/dateTimeUtil"],function(e,t,i){var n=t.extend({tagName:"li",className:"striped-list-item media-list-item track-list-item track",template:e,bindings:{".media-index":{modelAttribute:"index",formatter:function(e){return 1>e?"":e
}},".media-title":{modelAttribute:"title"},".media-context":{modelAttribute:"duration",autohide:!0,formatter:function(e){return i.formatDuration(e)}}}});return n}),define("plex/chromecast/views/details/CastAlbumDetailsView",["tpl!templates/chromecast/details/CastAlbumDetailsView.tpl","underscore","plex/base/mixins/details/albumDetailsMixin","plex/chromecast/views/details/CastBaseDetailsView","plex/chromecast/views/items/TrackView"],function(e,t,i,n,r){var s=n.extend({className:"album-details-row details-row",template:e,childView:r,ui:t.extend({children:".track-list"},n.prototype.ui),initialize:function(){this.bindings=t.extend({},i.bindings)
},onRender:function(){this.loadImages()}});return s}),define("tpl!templates/chromecast/details/CastArtistDetailsView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="background bright"></div>\n\n<div class="details-title-container">\n  <h1 class="item-title"></h1>\n</div>\n\n<div class="details-metadata-container">\n  <div class="artist-details-metadata-container">\n    <div class="metadata-right pull-right">\n      <div class="item-genre metadata-tags"></div>\n    </div>\n\n    <p class="metadata-labels">\n      <span class="rating-container rating-container-inline">\n        <span class="rating"></span>\n      </span>\n    </p>\n\n    <div class="summary-container"></div>\n  </div>\n\n  <div class="album-list-container details-list-container"></div>\n</div>\n\n<div class="details-poster-container">\n  <a class="media-poster-container" href="#">\n    <div class="artist-poster item-poster media-poster"></div>\n  </a>\n</div>\n';
return __p}}),define("plex/base/mixins/details/artistDetailsMixin",["underscore","plex/base/mixins/details/baseDetailsMixin"],function(e,t){var i={bindings:e.pick(t.defaultBindings,[".item-title",".item-genre"])};return i}),define("plex/chromecast/views/details/CastArtistDetailsView",["tpl!templates/chromecast/details/CastArtistDetailsView.tpl","underscore","plex/base/mixins/details/artistDetailsMixin","plex/chromecast/views/details/CastBaseDetailsView"],function(e,t,i,n){var r=n.extend({className:"artist-details-row details-row",template:e,initialize:function(){this.bindings=t.extend({},i.bindings)
},onRender:function(){this.loadImages()}});return r}),define("tpl!templates/chromecast/details/CastShowDetailsView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="background bright"></div>\n\n<div class="details-title-container">\n  <h1 class="item-title"></h1>\n  <h2 class="item-year"></h2>\n</div>\n\n<div class="details-metadata-container">\n  <div class="show-details-metadata-container">\n    <div class="metadata-right pull-right">\n      <div class="item-genre metadata-tags"></div>\n    </div>\n\n    <p class="metadata-labels">\n      <span class="item-duration metadata-duration"></span>\n\n      <span class="rating-container rating-container-inline">\n        <span class="rating"></span>\n      </span>\n\n      <span class="content-rating-flag-container content-rating-flag-container-inline">\n        <img class="content-rating-flag">\n      </span>\n    </p>\n\n    <div class="summary-container"></div>\n\n    <div class="studio-flag-container">\n      <img class="studio-flag">\n    </div>\n  </div>\n\n  <div class="season-list-container details-list-container"></div>\n</div>\n\n<div class="details-poster-container">\n  <a class="media-poster-container edit-poster-btn" href="#">\n    <div class="show-poster item-poster media-poster">\n      <span class="unwatched-count-badge badge badge-lg hidden"></span>\n    </div>\n  </a>\n</div>\n';
return __p}}),define("plex/base/mixins/details/showDetailsMixin",["underscore","plex/base/mixins/details/baseDetailsMixin"],function(e,t){var i={bindings:e.pick(t.defaultBindings,[".item-title",".item-year",".item-duration",".item-genre",".item-content-rating",".unwatched-count-badge",".content-rating-flag-container",".studio-flag-container"])};return i}),define("plex/chromecast/views/details/CastShowDetailsView",["tpl!templates/chromecast/details/CastShowDetailsView.tpl","underscore","plex/base/mixins/details/showDetailsMixin","plex/chromecast/views/details/CastBaseDetailsView"],function(e,t,i,n){var r=n.extend({className:"show-details-row details-row",template:e,ui:t.extend({contentRating:".content-rating-flag",studio:".studio-flag"},n.prototype.ui),initialize:function(){this.bindings=t.extend({},i.bindings)
},loadMediaFlags:function(){this.loadMediaFlag(this.ui.contentRating,{modelAttribute:"contentRating",width:80,height:34}),this.loadMediaFlag(this.ui.studio,{modelAttribute:"studio",width:200,height:40})},onRender:function(){this.loadImages(),this.loadMediaFlags()}});return r}),define("tpl!templates/chromecast/details/CastEpisodeDetailsView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="background bright"></div>\n\n<div class="details-title-container">\n  <h1 class="show-title"></h1>\n  <h2 class="episode-title"></h2>\n  <h3 class="episode-index"></h3>\n</div>\n\n<div class="details-metadata-container">\n  <div class="details-progress-container">\n    <div class="item-progress details-progress"></div>\n  </div>\n\n  <div class="metadata-right pull-right">\n    <div class="item-available-at metadata-tags"></div>\n\n    <div class="rating-container">\n      <span class="rating"></span>\n    </div>\n\n    <div class="content-rating-flag-container">\n      <img class="content-rating-flag">\n    </div>\n  </div>\n\n  <p class="metadata-labels">\n    <span class="item-duration metadata-duration"></span> <span class="item-unwatched-label label label-primary">Unwatched</span> <span class="item-unavailable-btn label label-danger">Unavailable</span>\n  </p>\n\n  <div class="item-director metadata-tags">\n    <span class="metadata-label">Director</span> <span class="metadata-tag-list"></span>\n  </div>\n  <div class="item-writer metadata-tags">\n    <span class="metadata-label">Writer</span> <span class="metadata-tag-list"></span>\n  </div>\n  <div class="item-cast metadata-tags">\n    <span class="metadata-label">Cast</span> <span class="metadata-tag-list"></span>\n  </div>\n\n  <div class="item-audio metadata-tags">\n    <span class="metadata-label">Audio</span>\n    <span class="metadata-tag"></span>\n  </div>\n  <div class="item-subtitles metadata-tags">\n    <span class="metadata-label">Subtitles</span>\n    <span class="metadata-tag"></span>\n  </div>\n\n  <div class="summary-container"></div>\n</div>\n\n<div class="details-poster-container">\n  <a class="media-poster-container disabled" href="#">\n    <div class="episode-poster item-poster media-poster">\n    </div>\n  </a>\n\n  <div class="video-audio-flags-container media-flags">\n    <img class="video-resolution-flag media-flag">\n    <img class="audio-codec-flag media-flag">\n    <img class="audio-channels-flag media-flag">\n  </div>\n</div>\n';
return __p}}),define("plex/base/mixins/details/episodeDetailsMixin",["underscore","plex/base/mixins/details/baseDetailsMixin","plex/base/utils/mediaUtil"],function(e,t,i){var n={bindings:e.extend({".show-title":{modelAttribute:"grandparentTitle"},".episode-title":{modelAttribute:"title"},".episode-index":{modelAttribute:"index",formatter:function(e){return i.getSeasonEpisodeIndex({seasonIndex:this.model.get("parentIndex"),episodePrefix:" \xb7 E{1}",episodeIndex:e,date:this.model.get("originallyAvailableAt"),noLeadingZero:!0})
}}},e.pick(t.defaultBindings,[".item-year",".item-progress",".item-duration",".item-unwatched-label",".item-unavailable-btn",".item-available-at",".item-director",".item-writer",".item-cast",".item-content-rating",".media-count-badge",".content-rating-flag-container"]))};return n}),define("plex/chromecast/views/details/CastEpisodeDetailsView",["tpl!templates/chromecast/details/CastEpisodeDetailsView.tpl","underscore","plex/base/mixins/details/episodeDetailsMixin","plex/chromecast/views/details/CastBaseDetailsView"],function(e,t,i,n){var r=n.extend({className:"episode-details-row details-row",template:e,ui:t.extend({contentRating:".content-rating-flag",studio:".studio-flag",videoResolution:".video-resolution-flag",audioCodec:".audio-codec-flag",audioChannels:".audio-channels-flag"},n.prototype.ui),initialize:function(){this.bindings=t.extend({},i.bindings,this.extraBindings)
},loadMediaFlags:function(){this.loadMediaFlag(this.ui.contentRating,{modelAttribute:"contentRating",width:80,height:34}),this.loadMediaFlag(this.ui.studio,{modelAttribute:"studio",width:200,height:40}),this.loadMediaFlag(this.ui.videoResolution,{flag:"videoResolution",width:125,height:25}),this.loadMediaFlag(this.ui.audioCodec,{flag:"audioCodec",width:125,height:25}),this.loadMediaFlag(this.ui.audioChannels,{flag:"audioChannels",width:125,height:25})},extraBindings:{".item-audio":{modelAttribute:"Media",manual:!0,autohide:!0,formatter:function(e,t){var i=this.getStreamString("audio");
return t.find(".metadata-tag").html(i),i}},".item-subtitles":{modelAttribute:"Media",manual:!0,autohide:!0,formatter:function(e,t){var i=this.getStreamString("subtitles");return t.find(".metadata-tag").html(i),i}}},onRender:function(){this.loadImages(),this.loadMediaFlags()}});return r}),define("tpl!templates/chromecast/details/CastMovieDetailsView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="background bright"></div>\n\n<div class="details-title-container">\n  <h1 class="item-title"></h1>\n  <h2 class="item-year"></h2>\n</div>\n\n<div class="details-metadata-container">\n  <div class="details-progress-container">\n    <div class="item-progress details-progress"></div>\n  </div>\n\n  <div class="metadata-right pull-right">\n    <div class="item-genre metadata-tags"></div>\n\n    <div class="rating-container">\n      <span class="rating">\n      </span>\n    </div>\n\n    <div class="content-rating-flag-container">\n      <img class="content-rating-flag">\n    </div>\n  </div>\n\n  <p class="metadata-labels">\n    <span class="item-duration metadata-duration"></span> <span class="item-unwatched-label label label-primary">Unwatched</span> <span class="item-unavailable-btn label label-danger">Unavailable</span>\n  </p>\n\n  <div class="item-director metadata-tags">\n    <span class="metadata-label">Director</span> <span class="metadata-tag-list"></span>\n  </div>\n  <div class="item-cast metadata-tags">\n    <span class="metadata-label">Cast</span> <span class="metadata-tag-list"></span>\n  </div>\n\n  <div class="item-audio metadata-tags">\n    <span class="metadata-label">Audio</span>\n    <span class="metadata-tag"></span>\n  </div>\n  <div class="item-subtitles metadata-tags">\n    <span class="metadata-label">Subtitles</span>\n    <span class="metadata-tag"></span>\n  </div>\n\n  <div class="summary-container"></div>\n\n  <div class="studio-flag-container">\n    <img class="studio-flag">\n  </div>\n</div>\n\n<div class="details-poster-container">\n  <a class="media-poster-container" href="#">\n    <div class="movie-poster item-poster media-poster">\n      <div class="media-poster-overlay"></div>\n\n      <span class="media-count-badge badge badge-lg hidden"></span>\n    </div>\n  </a>\n\n  <div class="video-audio-flags-container media-flags">\n    <img class="video-resolution-flag media-flag">\n    <img class="audio-codec-flag media-flag">\n    <img class="audio-channels-flag media-flag">\n  </div>\n</div>\n';
return __p}}),define("plex/base/mixins/details/movieDetailsMixin",["underscore","plex/base/mixins/details/baseDetailsMixin"],function(e,t){var i={bindings:e.pick(t.defaultBindings,[".item-title",".item-year",".item-progress",".item-duration",".item-unwatched-label",".item-unavailable-btn",".item-tagline",".item-genre",".item-director",".item-writer",".item-cast",".item-content-rating",".media-count-badge",".content-rating-flag-container",".studio-flag-container"])};return i}),define("plex/chromecast/views/details/CastMovieDetailsView",["tpl!templates/chromecast/details/CastMovieDetailsView.tpl","underscore","plex/base/mixins/details/movieDetailsMixin","plex/chromecast/views/details/CastBaseDetailsView"],function(e,t,i,n){var r=n.extend({className:"movie-details-row details-row",template:e,ui:t.extend({contentRating:".content-rating-flag",studio:".studio-flag",videoResolution:".video-resolution-flag",audioCodec:".audio-codec-flag",audioChannels:".audio-channels-flag"},n.prototype.ui),initialize:function(){this.bindings=t.extend({},i.bindings,this.extraBindings)
},loadMediaFlags:function(){this.loadMediaFlag(this.ui.contentRating,{modelAttribute:"contentRating",width:80,height:34}),this.loadMediaFlag(this.ui.studio,{modelAttribute:"studio",width:200,height:40}),this.loadMediaFlag(this.ui.videoResolution,{flag:"videoResolution",width:125,height:25}),this.loadMediaFlag(this.ui.audioCodec,{flag:"audioCodec",width:125,height:25}),this.loadMediaFlag(this.ui.audioChannels,{flag:"audioChannels",width:125,height:25})},extraBindings:{".item-audio":{modelAttribute:"Media",manual:!0,autohide:!0,formatter:function(e,t){var i=this.getStreamString("audio");
return t.find(".metadata-tag").html(i),i}},".item-subtitles":{modelAttribute:"Media",manual:!0,autohide:!0,formatter:function(e,t){var i=this.getStreamString("subtitles");return t.find(".metadata-tag").html(i),i}}},onRender:function(){this.loadImages(),this.loadMediaFlags()}});return r}),define("tpl!templates/chromecast/details/CastClipDetailsView.tpl",function(){return function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="background bright"></div>\n\n<div class="details-title-container">\n  <h1 class="item-title"></h1>\n  <h2 class="item-year"></h2>\n</div>\n\n<div class="details-metadata-container">\n  <div class="metadata-right pull-right">\n    <div class="item-genre metadata-tags"></div>\n\n    <div class="rating-container">\n      <span class="rating">\n      </span>\n    </div>\n\n    <div class="content-rating-flag-container">\n      <img class="content-rating-flag">\n    </div>\n  </div>\n\n  <p class="metadata-labels">\n    <span class="item-duration metadata-duration"></span>\n  </p>\n\n  <div class="item-director metadata-tags">\n    <span class="metadata-label">Director</span> <span class="metadata-tag-list"></span>\n  </div>\n  <div class="item-cast metadata-tags">\n    <span class="metadata-label">Cast</span> <span class="metadata-tag-list"></span>\n  </div>\n\n  <div class="item-audio metadata-tags">\n    <span class="metadata-label">Audio</span>\n    <span class="metadata-tag"></span>\n  </div>\n  <div class="item-subtitles metadata-tags">\n    <span class="metadata-label">Subtitles</span>\n    <span class="metadata-tag"></span>\n  </div>\n\n  <div class="summary-container"></div>\n\n  <div class="studio-flag-container">\n    <img class="studio-flag">\n  </div>\n</div>\n\n<div class="details-poster-container">\n  <a class="media-poster-container" href="#">\n    <div class="clip-poster item-poster media-poster">\n      <div class="media-poster-overlay"></div>\n    </div>\n  </a>\n\n  <div class="video-audio-flags-container media-flags">\n    <img class="video-resolution-flag media-flag">\n    <img class="audio-codec-flag media-flag">\n    <img class="audio-channels-flag media-flag">\n  </div>\n</div>\n';
return __p}}),define("plex/base/mixins/details/clipDetailsMixin",["underscore","plex/base/mixins/details/baseDetailsMixin"],function(e,t){var i={bindings:e.pick(t.defaultBindings,[".item-title",".item-year",".item-duration",".item-tagline",".item-genre",".item-director",".item-writer",".item-cast",".item-content-rating",".content-rating-flag-container",".studio-flag-container"])};return i}),define("plex/chromecast/views/details/CastClipDetailsView",["tpl!templates/chromecast/details/CastClipDetailsView.tpl","underscore","plex/base/mixins/details/clipDetailsMixin","plex/chromecast/views/details/CastBaseDetailsView"],function(e,t,i,n){var r=n.extend({className:"clip-details-row details-row",template:e,ui:t.extend({contentRating:".content-rating-flag",studio:".studio-flag",videoResolution:".video-resolution-flag",audioCodec:".audio-codec-flag",audioChannels:".audio-channels-flag"},n.prototype.ui),initialize:function(){this.bindings=t.extend({},i.bindings,this.extraBindings)
},loadMediaFlags:function(){this.loadMediaFlag(this.ui.contentRating,{modelAttribute:"contentRating",width:80,height:34}),this.loadMediaFlag(this.ui.studio,{modelAttribute:"studio",width:200,height:40}),this.loadMediaFlag(this.ui.videoResolution,{flag:"videoResolution",width:125,height:25}),this.loadMediaFlag(this.ui.audioCodec,{flag:"audioCodec",width:125,height:25}),this.loadMediaFlag(this.ui.audioChannels,{flag:"audioChannels",width:125,height:25})},extraBindings:{".item-audio":{modelAttribute:"Media",manual:!0,autohide:!0,formatter:function(e,t){var i=this.getStreamString("audio");
return t.find(".metadata-tag").html(i),i}},".item-subtitles":{modelAttribute:"Media",manual:!0,autohide:!0,formatter:function(e,t){var i=this.getStreamString("subtitles");return t.find(".metadata-tag").html(i),i}}},onRender:function(){this.loadImages(),this.loadMediaFlags()}});return r}),define("plex/base/models/library/HubModel",["underscore","plex/base/utils/parser","plex/base/models/BaseModel","plex/base/models/library/MetadataCollection"],function(e,t,i,n){var r=i.extend({idAttribute:"hubIdentifier",whitelistedAttrs:["key","hubIdentifier","title","type","size","more"],convert:function(i){var n=e.isObject(i)?i:t.parseXML(i);
return t.parseInteger(n,"size"),t.parseBoolean(n,"more"),n},parse:function(t){var i=this.convert(t),r=this.get("children");return r||(r=new n([],{server:this.server,section:this.section,parent:this,url:i.key}),this.set("children",r)),r.set(t,{parse:!0}),i=e.pick(i,this.whitelistedAttrs)}});return r}),define("plex/base/models/library/HubCollection",["underscore","plex/base/utils/parser","plex/base/utils/formatters/stringUtil","plex/base/models/BaseCollection","plex/base/models/library/HubModel"],function(e,t,i,n,r){var s=n.extend({model:r,subcollections:["Playlist","Directory","Video","Track","Photo"],url:function(){var t="/hubs";
if(this.section&&(t+="/sections/"+this.section.id),this.excludes&&this.excludes.length>0){var n=e.map(this.excludes,function(e){return"exclude"+i.upperCaseFirstLetter(e)+"=1"});t+="?"+n.join("&")}return t},initialize:function(e,t){this.excludes=t&&t.excludes},populate:function(){return this.populatePromise&&"pending"!==this.populatePromise.state()?this.fetch():n.prototype.populate.apply(this,arguments)},fetch:function(t){t||(t={});var i=e.clone(t);if(this.populatePromise&&"resolved"===this.populatePromise.state()){i.remove=!1;
var r=e.result(this,"url");r+=r.indexOf("?")>-1?"&":"?",r+="onlyTransient=1",i.url=r}return n.prototype.fetch.call(this,i)},parse:function(i){return e.isString(i)&&(i=t.replaceXMLElementNames(i,this.subcollections,"Metadata")),this.convert(i,"Hub")}});return s}),define("plex/chromecast/routes/CastAppController",["underscore","jquery","plex/base/utils/dispatcher","plex/base/utils/BaseClass","plex/base/utils/mediaUtil","plex/base/utils/playerQualities","plex/base/utils/types/mediaTypes","plex/base/mixins/eventMixin","plex/base/adapters/loggerAdapter","plex/base/adapters/storageAdapter","plex/chromecast/models/castAppModel","plex/chromecast/models/castSettingsModel","plex/chromecast/models/CastServerModel","plex/base/models/library/MetadataModel","plex/base/models/library/MetadataCollection","plex/base/models/library/PlayQueueModel","plex/base/models/library/LocalPlayQueueModel","plex/chromecast/views/CastLoadingView","plex/chromecast/views/CastWaitingView","plex/chromecast/views/CastMusicPlayerView","plex/chromecast/views/CastPhotoPlayerView","plex/chromecast/views/CastVideoPlayerView","plex/chromecast/views/CastErrorView","plex/chromecast/views/details/CastAlbumDetailsView","plex/chromecast/views/details/CastArtistDetailsView","plex/chromecast/views/details/CastShowDetailsView","plex/chromecast/views/details/CastEpisodeDetailsView","plex/chromecast/views/details/CastMovieDetailsView","plex/chromecast/views/details/CastClipDetailsView","plex/base/models/library/HubCollection"],function(e,t,i,n,r,s,a,o,l,u,c,d,h,p,f,m,g,v,y,b,x,w,S,_,k,P,M,C,T){var A={album:_,artist:k,show:P,episode:M,movie:C,clip:T},I=n.extend({mixins:o,initialize:function(){this.listenTo(i,"navigate",this.onNavigate)
},loading:function(){i.trigger("show:view",new v)},waiting:function(){i.trigger("show:view",new y)},player:function(t){var n=this.populateView(e.extend(t,{showLoading:!0}));n.done(e.bind(function(e){var t=r.getMissingParts(e.model.get("Media"));if(t.length)return void i.trigger("navigate","error",{error:t});var n,s=e.model.get("type");n="photo"===s?new x(e):"track"===s?new b(e):new w(e),i.trigger("show:view",n),i.trigger("change:controller",n.controller)},this))},details:function(t){var n=this.populateView(t);
n.done(e.bind(function(e){var t=e.model.get("type"),n=A[t];if(n){var r=new n(e);i.trigger("show:view",r),i.trigger("change:controller",r.controller)}else l.warn("No details view found for type: "+t)},this))},error:function(e){var t=new S(e);i.trigger("show:view",t),i.trigger("change:error",t.message)},populateView:function(n){n.showLoading&&i.trigger("navigate","loading"),l.log(n),n.offset||(n.offset=0),d.set({qualityIndex:s.getNearestQualityIndex(n.bitrate),directPlay:n.directPlay,directStream:n.directStream,subtitleSize:n.subtitleSize||100,audioBoost:n.audioBoost||100});
var r={offset:Math.round(1e3*n.offset),autoplay:n.autoplay},a=this.populateServer("server",n,r);return a=this.populatePrimaryServer(a,n,r),a=this.populateMetadata(a,n,r),n.containerKey&&(a=this.populatePlayQueue(a,n,r)),a=a.then(function(){return r.primaryServer&&(c.set("primaryServer",r.primaryServer),u.set({key:"primaryServer",value:JSON.stringify(e.omit(r.primaryServer.toJSON(),"fanart"))})),t.Deferred().resolve(r)},function(e,t){i.trigger("navigate","error",{error:t})})},populateServer:function(i,n,r){var s=n[i];
s.protocol&&(s.scheme=s.protocol,delete s.protocol),"myPlex"===s.machineIdentifier&&(s.cloud=!0),s.activeConnection=e.pick(s,["scheme","address","port"]);var a=new h(s,{parent:c});return r[i]=a,null!=a.get("transcoderVideo")&&null!=a.get("transcoderAudio")?t.Deferred().resolve().promise():a.populate()},populatePrimaryServer:function(i,n,r){return i=i.then(e.bind(function(){return n.primaryServer?this.populateServer("primaryServer",n,r):(r.server.get("cloud")||(r.primaryServer=r.server),t.Deferred().resolve().promise())
},this)),i=i.then(e.bind(function(){return r.server.get("cloud")&&(n.key=r.primaryServer?r.primaryServer.resolveUrl(n.key):r.server.resolveUrl(n.key,{connection:{address:"node.plexapp.com",port:"32400"}})),t.Deferred().resolve().promise()},this))},populateMetadata:function(i,n,r){return i=i.then(e.bind(function(){var e=n.key,i=/(.*)\/children$/.exec(e);i&&(e=i[1]);var s=new p({key:e},{server:r.server});if(r.model=s,/^\/\w+\/iTunes/.test(n.key))return t.Deferred().resolve().promise();var a={};return/^\/library\/metadata/.test(n.key)&&(a.data={checkFiles:"1"}),s.populate(a)
},this))},populatePlayQueue:function(i,n,r){return i=i.then(e.bind(function(){var e=n.containerKey,t=/playQueues\/(\d+)/.exec(e);if(t){var i=new m({mediaType:a.getChildMediaType(r.model.get("type")).element},{server:r.server});return r.playQueue=i,i.set("playQueueID",t[1]),i.fetch()}var s=new f([],{server:r.server});return s.url=n.containerKey,s.populate().then(function(){var e=new g({mediaType:a.getChildMediaType(r.model.get("type")).element},{server:r.server});return r.playQueue=e,e.addContent(s,{firstItem:r.model})
})},this)),i=i.then(e.bind(function(){var e=r.playQueue.get("collection"),i=r.model.get("ratingKey"),n=e.findWhere({ratingKey:i});return r.model=n||e.at(0),r.model.isLibraryItem()?r.model.populate({data:{checkFiles:"1"}}):t.Deferred().resolve().promise()},this))},onNavigate:function(t,i){if(!e.isFunction(this[t]))throw new Error("Invalid route: "+t);this[t].call(this,i)}});return I}),define("plex/chromecast/views/CastAppView",["underscore","backbone","plex/base/utils/dispatcher","plex/base/adapters/analyticsAdapter"],function(e,t,i,n){var r=3e5,s=12e5,a=t.View.extend({el:".app-container",initialize:function(){e.bindAll(this,"onInactivityTimeout"),this.listenTo(i,"show:view",this.onShowView)
},resetTimers:function(){this.inactivityTimeout=clearTimeout(this.inactivityTimeout),this.pausedTimeout=clearTimeout(this.pausedTimeout)},onShowView:function(e,t){t||(t={}),this.currentView&&(this.stopListening(this.currentView),this.currentView.close()),i.trigger("cycle:cache"),this.resetTimers(),i.trigger("change:controller",null),this.currentView=e,this.$el.empty(),this.$el.append(e.render().el),window.location.pathname.match("/qa/")&&this.$el.append('<div class="qa-build-label">QA Build (e079022)</div>'),e.onRender(),this.listenTo(e,"change:paused",this.onPausedChange),e.passive&&(this.inactivityTimeout=setTimeout(this.onInactivityTimeout,r)),n.trackView(e.id)
},onPausedChange:function(e){e?this.pausedTimeout=setTimeout(this.onInactivityTimeout,s):this.resetTimers()},onInactivityTimeout:function(){var e=this.currentView.close();e?e.always(function(){window.close()}):window.close()}});return a}),define("plex/chromecast/castApp",["plex/base/utils/cache/ModelCache","plex/base/utils/cache/CollectionCache","plex/chromecast/adapters/castAdapters","plex/base/initializers/appInitializer","plex/chromecast/initializers/castAnalyticsInitializer","plex/chromecast/initializers/castReceiverInitializer","plex/chromecast/routes/CastAppController","plex/chromecast/models/castAppModel","plex/chromecast/views/CastAppView"],function(e,t,i,n,r,s,a,o,l){var u={start:function(){e.prototype.maxCycles=4,e.prototype.maxSize=30,t.prototype.maxCycles=4,t.prototype.maxSize=2,i.registerAll();
new a,new l;n.init(o),r.init(),s.init()}};return u}),window.PLEXWEB=window.PLEXWEB||{},require(["config/require.conf"],function(){require(["text!config/chromecast.conf.json"],function(e){require.config(JSON.parse(e)),require(["plex/chromecast/castApp"],function(e){e.start()})})}),define("main-chromecast",function(){});
